"use strict";(self.webpackChunk_nand2tetris_web=self.webpackChunk_nand2tetris_web||[]).push([[387],{8582:function(t,e,n){n.d(e,{M:function(){return c}});var r=n(1026),i=n(7878),s=n(8365),u=n(4408),a=n(1585),o=n(4625),c=function(t){var e=t.className,n=void 0===e?"":e,c=t.out,h=t.cmp,f=t.zeroState,d=s.lA.parse(c),v=s.lA.parse(h);if((0,o.dZ)(d))return(0,i.jsxs)("details",{children:[(0,i.jsx)("summary",{children:"Failed to parse output"}),(0,i.jsx)("pre",{children:(0,u.j)((0,o.UG)(d))}),(0,i.jsx)("code",{children:(0,i.jsx)("pre",{children:c})})]});if((0,o.dZ)(v))return(0,i.jsxs)("details",{children:[(0,i.jsx)("summary",{children:"Failed to parse compare"}),(0,i.jsxs)("code",{children:[(0,i.jsx)("pre",{children:(0,u.j)((0,o.UG)(v))}),(0,i.jsx)("pre",{children:h})]})]});var p=(0,o.Ok)(v),m=(0,o.Ok)(d),Z=0,k=(0,a.w)(0,Math.min(p.length,m.length)).map((function(t){var e,n,i=null!==(e=p[t])&&void 0!==e?e:[],s=null!==(n=m[t])&&void 0!==n?n:[];return(0,a.w)(0,Math.max(i.length,s.length)).map((function(t,e){var n,r;return[null!==(n=i[e])&&void 0!==n?n:"",null!==(r=s[e])&&void 0!==r?r:""]})).map((function(t){var e=(0,r.Z)(t,2),n=e[0],i=e[1],s={cmp:null!==n&&void 0!==n?n:'"',out:null!==i&&void 0!==i?i:'"',pass:null!==(null===n||void 0===n?void 0:n.trim().match(/^\*+$/))||(null===i||void 0===i?void 0:i.trim())===(null===n||void 0===n?void 0:n.trim())};return s.pass||(Z+=1),s}))}));return(0,i.jsxs)("div",{className:"scroll-x "+n,children:[Z>0&&(0,i.jsxs)("p",{children:[Z," failure",1===Z?"":"s"]}),k.length>0?(0,i.jsx)("table",{style:{fontFamily:"var(--font-family-monospace)",marginBottom:"none"},children:(0,i.jsx)("tbody",{children:k.map((function(t,e){return(0,i.jsx)("tr",{children:t.map((function(t,e){var n=t.cmp,r=t.out,s=t.pass;return(0,i.jsx)(l,{cmp:n,out:r,pass:s},e)}))},e)}))})}):null!==f&&void 0!==f?f:(0,i.jsx)("p",{children:"Execute test script to compare output."})]})},l=function(t){var e=t.cmp,n=t.out;return t.pass?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("td",{children:e})}):(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("td",{children:[(0,i.jsx)("ins",{children:e}),(0,i.jsx)("br",{}),(0,i.jsx)("del",{children:n})]})})}},6329:function(t,e,n){n.d(e,{Af:function(){return I},Gc:function(){return M},P9:function(){return j},lj:function(){return x},qP:function(){return P},tI:function(){return B},yE:function(){return A}});var r,i=n(3243),s=n(7597),u=n(7538),a=n(3943),o=n(1092),c=n(7791),l=n(1026),h=n(9422),f=n(7169),d=n(7591),v=n(4337),p=n(726),m=n(649),Z=n(2951),k=n(1976),y=n(4649),w=n(5541),g=n(1585),b=n(6531),x=1,A=0,M=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,Z.Z)(this,t),(0,y.Z)(this,"name",void 0),(0,y.Z)(this,"width",void 0),(0,y.Z)(this,"state",void 0),(0,y.Z)(this,"next",[]),this.name=e,this.width=n,this.state=(0,g.w)(0,this.width).map((function(){return A}))}return(0,k.Z)(t,[{key:"ensureWidth",value:function(t){(0,w.hu)(t<=16,"Cannot widen past 16 to ".concat(t," bits")),this.width<t&&(this.width=t,this.state=[].concat((0,m.Z)(this.state),(0,m.Z)((0,g.w)(this.width,t).map((function(){return A})))))}},{key:"connect",value:function(t){this.next.push(t),t.busVoltage=this.busVoltage}},{key:"pull",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,w.hu)(e>=0&&e<this.width,"Bit out of bounds: ".concat(this.name,"@").concat(e)),this.state[e]=t,this.next.forEach((function(n){return n.pull(t,e)}))}},{key:"voltage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,w.hu)(t>=0&&t<this.width),this.state[t]}},{key:"busVoltage",get:function(){var t=this;return(0,g.w)(0,this.width).reduce((function(e,n){return e|t.state[n]<<n}),0)},set:function(t){var e,n=this,r=(0,p.Z)((0,g.w)(0,this.width));try{for(r.s();!(e=r.n()).done;){var i=e.value;this.state[i]=(t&1<<i)>>i}}catch(s){r.e(s)}finally{r.f()}this.next.forEach((function(t){return t.busVoltage=n.busVoltage}))}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.voltage(t)===A?x:A;this.pull(e,t)}}]),t}(),S=function(t){(0,d.Z)(n,t);var e=(0,v.Z)(n);function n(t,r){var i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,Z.Z)(this,n),i=e.call(this,t.name),(0,y.Z)((0,f.Z)(i),"bus",void 0),(0,y.Z)((0,f.Z)(i),"start",void 0),(0,y.Z)((0,f.Z)(i),"width",void 0),i.bus=t,i.start=r,i.width=s,(0,w.hu)(r>=0&&r+s<=t.width,"Mismatched InSubBus dimensions on ".concat(t.name," (").concat(s," + ").concat(r," > ").concat(t.width,")")),i.connect(t),i}return(0,k.Z)(n,[{key:"pull",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,w.hu)(e>=0&&e<this.width),this.bus.pull(t,this.start+e)}},{key:"voltage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,w.hu)(t>=0&&t<this.width),this.bus.voltage(this.start+t)}},{key:"busVoltage",get:function(){return this.bus.busVoltage>>this.start&N(this.width)},set:function(t){var e=this.bus.busVoltage&~N(this.width+this.start),n=this.bus.busVoltage&N(this.start),r=(t&N(this.width))<<this.start;this.bus.busVoltage=e|r|n}},{key:"connect",value:function(t){(0,w.hu)(this.start+this.width<=t.width,"Mismatched InSubBus connection dimensions (From ".concat(t.name," to ").concat(this.name,")")),this.bus=t}}]),n}(M),D=function(t){(0,d.Z)(n,t);var e=(0,v.Z)(n);function n(t,r){var i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,Z.Z)(this,n),i=e.call(this,t.name),(0,y.Z)((0,f.Z)(i),"bus",void 0),(0,y.Z)((0,f.Z)(i),"start",void 0),(0,y.Z)((0,f.Z)(i),"width",void 0),i.bus=t,i.start=r,i.width=s,(0,w.hu)(r>=0&&s<=t.width,"Mismatched OutSubBus dimensions"),i.connect(t),i}return(0,k.Z)(n,[{key:"busVoltage",get:function(){return this.bus.busVoltage&N(this.width)},set:function(t){this.bus.busVoltage=(t&N(this.width+this.start))>>this.start}},{key:"connect",value:function(t){(0,w.hu)(this.width<=t.width,"Mismatched OutSubBus connection dimensions"),this.bus=t}}]),n}(M),P=function(t){(0,d.Z)(n,t);var e=(0,v.Z)(n);function n(t,r){var i;return(0,Z.Z)(this,n),i=e.call(this,t,16),(0,y.Z)((0,f.Z)(i),"value",void 0),i.value=r,i}return(0,k.Z)(n,[{key:"pullHigh",value:function(){}},{key:"pullLow",value:function(){}},{key:"voltage",value:function(){return 1&this.busVoltage}},{key:"busVoltage",get:function(){return this.value},set:function(t){}}]),n}(M),O=new P("true",65535),R=new P("false",0);function E(t){var e,n=null===(e=t.match((0,h.Z)(/([a-zA-Z]+)(\[(\d+)\])?/,{pin:1,w:3})))||void 0===e?void 0:e.groups,r=n.pin,i=n.w;return{pin:r,width:i?Number(i):1}}r=Symbol.iterator;var C=function(){function t(){(0,Z.Z)(this,t),(0,y.Z)(this,"map",new Map)}return(0,k.Z)(t,[{key:"insert",value:function(t){var e=t.name;(0,w.hu)(!this.map.has(e),"Pins already has ".concat(e,"!")),this.map.set(e,t)}},{key:"emplace",value:function(t,e){if(this.has(t))return this.get(t);var n=new M(t,e);return this.insert(n),n}},{key:"has",value:function(t){return this.map.has(t)}},{key:"get",value:function(t){return this.map.get(t)}},{key:"entries",value:function(){return this.map.values()}},{key:r,value:function(){return this.map[Symbol.iterator]()}}]),t}(),T=0,I=function(){function t(e,n,r){var i=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(0,Z.Z)(this,t),(0,y.Z)(this,"name",void 0),(0,y.Z)(this,"id",T++),(0,y.Z)(this,"ins",new C),(0,y.Z)(this,"outs",new C),(0,y.Z)(this,"pins",new C),(0,y.Z)(this,"parts",new Set),(0,y.Z)(this,"clockedPins",void 0),this.name=r;var a,o=(0,p.Z)(e);try{for(o.s();!(a=o.n()).done;){var c=a.value,l=void 0!==c.pin?c:E(c),h=l.pin,f=l.width,d=void 0===f?1:f;this.ins.insert(new M(h,d))}}catch(L){o.e(L)}finally{o.f()}var v,m=(0,p.Z)(n);try{for(m.s();!(v=m.n()).done;){var k=v.value,w=void 0!==k.pin?k:E(k),g=w.pin,x=w.width,A=void 0===x?1:x;this.outs.insert(new M(g,A))}}catch(L){m.e(L)}finally{m.f()}var S,D=(0,p.Z)(s);try{for(D.s();!(S=D.n()).done;){var P=S.value,O=void 0!==P.pin?P:E(P),R=O.pin,I=O.width,j=void 0===I?1:I;this.pins.insert(new M(R,j))}}catch(L){D.e(L)}finally{D.f()}this.clockedPins=new Set(u),b.S.get().$.subscribe((function(){return i.eval()}))}return(0,k.Z)(t,[{key:"clocked",get:function(){if(this.clockedPins.size>0)return!0;var t,e=(0,p.Z)(this.parts);try{for(e.s();!(t=e.n()).done;){if(t.value.clocked)return!0}}catch(n){e.e(n)}finally{e.f()}return!1}},{key:"reset",value:function(){var t,e=(0,p.Z)(this.ins);try{for(e.s();!(t=e.n()).done;){var n=(0,l.Z)(t.value,2);n[0];n[1].busVoltage=0}}catch(s){e.e(s)}finally{e.f()}var r,i=(0,p.Z)(this.parts);try{for(i.s();!(r=i.n()).done;){r.value.reset()}}catch(s){i.e(s)}finally{i.f()}this.eval()}},{key:"in",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"in";return(0,w.hu)(this.hasIn(t),"No in pin ".concat(t)),this.ins.get(t)}},{key:"out",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"out";return(0,w.hu)(this.hasOut(t),"No in pin ".concat(t)),this.outs.get(t)}},{key:"hasIn",value:function(t){return this.ins.has(t)}},{key:"hasOut",value:function(t){return this.outs.has(t)}},{key:"pin",value:function(t){return(0,w.hu)(this.pins.has(t)),this.pins.get(t)}},{key:"get",value:function(t,e){return this.ins.has(t)?this.ins.get(t):this.outs.has(t)?this.outs.get(t):this.pins.has(t)?this.pins.get(t):this.getBuiltin(t,e)}},{key:"getBuiltin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(V.includes(t)){var n,r=(0,p.Z)(this.parts);try{for(r.s();!(n=r.n()).done;){var i=n.value,s=i.get(t,e);if(s)return s}}catch(u){r.e(u)}finally{r.f()}}}},{key:"isOutPin",value:function(t){return this.outs.has(t)}},{key:"wire",value:function(t,e){this.parts.add(t);var n,r=(0,p.Z)(e);try{for(r.s();!(n=r.n()).done;){var i=n.value,s=i.to,u=i.from;t.isOutPin(s.name)?this.wireOutPin(t,s,u):this.wireInPin(t,s,u)}}catch(a){r.e(a)}finally{r.f()}}},{key:"findPin",value:function(t,e){return"true"===t.toLowerCase()||"1"===t?O:"false"===t.toLowerCase()||"0"===t?R:this.ins.has(t)?this.ins.get(t):this.outs.has(t)?this.outs.get(t):this.pins.emplace(t,e)}},{key:"wireOutPin",value:function(t,e,n){var r,i,s,u=(0,w.kP)(t.outs.get(e.name),(function(){return"Cannot wire to missing pin ".concat(e.name)}));null!==(r=e.width)&&void 0!==r||(e.width=u.width);var a=this.findPin(n.name,null!==(i=n.width)&&void 0!==i?i:e.width),o=this.pins.has(a.name);if(null!==(s=n.width)&&void 0!==s||(n.width=a.width),a instanceof P)throw new Error("Cannot wire to constant bus");o&&a instanceof M&&a.ensureWidth(n.start+n.width),(n.start>0||n.width!==a.width)&&(a=new S(a,n.start,n.width)),(e.start>0||e.width!==a.width)&&(a=new D(a,e.start,e.width)),u.connect(a)}},{key:"wireInPin",value:function(t,e,n){var r,i,s,u=(0,w.kP)(t.ins.get(e.name),(function(){return"Cannot wire to missing pin ".concat(e.name)}));null!==(r=e.width)&&void 0!==r||(e.width=u.width);var a=this.findPin(n.name,null!==(i=n.width)&&void 0!==i?i:e.width);null!==(s=n.width)&&void 0!==s||(n.width=a.width),(e.start>0||e.width!==a.width)&&(u=new S(u,e.start,e.width)),["true","false"].includes(a.name)||(n.start>0||n.width!==a.width)&&(u=new D(u,n.start,n.width)),a.connect(u)}},{key:"eval",value:function(){var t,e=(0,p.Z)(this.parts);try{for(e.s();!(t=e.n()).done;){var n=t.value;O.next.forEach((function(t){return t.busVoltage=O.busVoltage})),R.next.forEach((function(t){return t.busVoltage=R.busVoltage})),n.eval()}}catch(r){e.e(r)}finally{e.f()}}},{key:"tick",value:function(){this.eval()}},{key:"tock",value:function(){this.eval()}},{key:"remove",value:function(){var t,e=(0,p.Z)(this.parts);try{for(e.s();!(t=e.n()).done;){t.value.remove()}}catch(n){e.e(n)}finally{e.f()}}},{key:"load",value:function(){var t=(0,c.Z)((0,o.Z)().mark((function t(e,n){var r,i,s;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=(0,p.Z)(this.parts),t.prev=1,r.s();case 3:if((i=r.n()).done){t.next=10;break}if("ROM32K"!==(s=i.value).name){t.next=8;break}return t.next=8,s.load(e,n);case 8:t.next=3;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),r.e(t.t0);case 15:return t.prev=15,r.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[1,12,15,18]])})));return function(e,n){return t.apply(this,arguments)}}()}]),t}(),j=function(t){(0,d.Z)(n,t);var e=(0,v.Z)(n);function n(){var t;return(0,Z.Z)(this,n),(t=e.call(this,[],[])).outs.insert(R),t}return(0,k.Z)(n)}(I),L=new WeakMap,B=function(t){(0,d.Z)(n,t);var e=(0,v.Z)(n);function n(){var t;(0,Z.Z)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return t=e.call.apply(e,[this].concat(i)),(0,u.Z)((0,f.Z)(t),L,{writable:!0,value:b.S.get().$.subscribe((function(e){e.level===A?t.tock():t.tick()}))}),t}return(0,k.Z)(n,[{key:"clocked",get:function(){return!0}},{key:"remove",value:function(){(0,a.Z)(this,L).unsubscribe(),(0,i.Z)((0,s.Z)(n.prototype),"remove",this).call(this)}},{key:"reset",value:function(){(0,i.Z)((0,s.Z)(n.prototype),"reset",this).call(this),this.tick(),this.tock()}}]),n}(I);function N(t){return Math.pow(2,t)-1}var V=["Register","ARegister","DRegister","PC","RAM8","RAM64","RAM512","RAM4K","RAM16K","ROM32K","Screen","Keyboard","Memory"]},6531:function(t,e,n){n.d(e,{S:function(){return h}});var r,i=n(2951),s=n(1976),u=n(4649),a=n(1496),o=n(9810),c=n(5541),l=n(6329),h=function(){function t(){(0,i.Z)(this,t),(0,u.Z)(this,"level",l.yE),(0,u.Z)(this,"ticks",0),(0,u.Z)(this,"subject",new a.X({level:this.level,ticks:this.ticks})),(0,u.Z)(this,"frameSubject",new o.x),(0,u.Z)(this,"resetSubject",new o.x),(0,u.Z)(this,"$",this.subject),(0,u.Z)(this,"frame$",this.frameSubject),(0,u.Z)(this,"reset$",this.resetSubject)}return(0,s.Z)(t,[{key:"isHigh",get:function(){return this.level===l.lj}},{key:"isLow",get:function(){return this.level===l.yE}},{key:"next",value:function(){this.subject.next({level:this.level,ticks:this.ticks})}},{key:"reset",value:function(){this.level=l.yE,this.ticks=0,this.next(),this.resetSubject.next()}},{key:"tick",value:function(){(0,c.hu)(this.level===l.yE,"Can only tick up from LOW"),this.level=l.lj,this.next()}},{key:"tock",value:function(){(0,c.hu)(this.level===l.lj,"Can only tock down from HIGH"),this.level=l.yE,this.ticks+=1,this.next()}},{key:"toggle",value:function(){this.level===l.lj?this.tock():this.tick()}},{key:"eval",value:function(){this.tick(),this.tock()}},{key:"frame",value:function(){this.frameSubject.next()}},{key:"toString",value:function(){return"".concat(this.ticks).concat(this.level===l.lj?"+":"")}}],[{key:"get",value:function(){return void 0===r&&(r=new t),r}}]),t}()},6693:function(t,e,n){n.d(e,{Bb:function(){return o},NM:function(){return r},PH:function(){return i},Uc:function(){return s},lK:function(){return u},vU:function(){return a}});var r={op:{42:"0",63:"1",58:"-1",12:"x",48:"y",13:"!x",49:"!y",15:"-x",51:"-y",31:"x+1",55:"y+1",14:"x-1",50:"y-1",2:"x+y",19:"x-y",7:"y-x",0:"x&y",21:"x|y"}},i={asm:{0:42,1:63,"-1":58,D:12,A:48,M:48,"!D":13,"!A":49,"-D":15,"-A":51,"D+1":31,"A+1":55,"D-1":14,"A-1":50,"D+A":2,"D-A":19,"D-M":19,"A-D":7,"D&A":0,"D&M":0,"D|A":21,"D|M":21},op:{42:"0",63:"1",58:"-1",12:"D",48:"A",13:"!D",49:"!A",15:"-D",51:"-A",31:"D+1",55:"A+1",14:"D-1",50:"A-1",2:"D+A",19:"D-A",7:"A-D",0:"D&A",21:"D|A"}},s={asm:{"":0,M:1,D:2,MD:3,A:4,AM:5,AD:6,AMD:7},op:{0:"",1:"M",2:"D",3:"MD",4:"A",5:"AM",6:"AD",7:"AMD"}},u={asm:{"":0,JGT:1,JEQ:2,JGE:3,JLT:4,JNE:5,JLE:6,JMP:7},op:{0:"",1:"JGT",2:"JEQ",3:"JGE",4:"JLT",5:"JNE",6:"JLE",7:"JMP"}},a={1:"Positive",0:"Zero",15:"Negative",Positive:1,Zero:0,Negative:15};function o(t,e,n){var r=0;switch(t){case 42:r=0;break;case 63:r=1;break;case 58:r=-1;break;case 12:r=e;break;case 48:r=n;break;case 13:r=~e;break;case 49:r=~n;break;case 15:r=-e;break;case 51:r=-n;break;case 31:r=e+1;break;case 55:r=n+1;break;case 14:r=e-1;break;case 50:r=n-1;break;case 2:r=e+n;break;case 19:r=e-n;break;case 7:r=n-e;break;case 0:r=e&n;break;case 21:r=e|n}return[r&=65535,0===r?a.Zero:32768&r?a.Negative:a.Positive]}},134:function(t,e,n){n.d(e,{Ff:function(){return S},Jx:function(){return A},Z9:function(){return E},Zu:function(){return f},aL:function(){return M}});var r=n(2951),i=n(1976),s=n(7538),u=n(4649),a=n(2648),o=n(3943),c=n(1026),l=n(6693),h=n(5838);function f(){return{A:0,D:0,PC:0,ALU:0,flag:l.vU.Zero}}var d=32768,v=36864,p=36864,m=36864,Z=4032,k=32800,y=32784,w=32776,g=32769,b=32770,x=32772;function A(t){function e(e){return(t&e)===e}return{c:e(d),x1:e(v),x2:e(p),am:e(m),op:(t&Z)>>6,d1:e(k),d2:e(y),d3:e(w),j1:e(g),j2:e(b),j3:e(x)}}function M(t,e){var n=t.inM,r=t.instruction,i=e.A,s=e.D,u=e.PC,a=A(r),o=a.am?n:i,h=(0,l.Bb)(a.op,s,o),f=(0,c.Z)(h,2);return[{A:i,D:s,PC:u+1,ALU:f[0],flag:f[1]},a.d3]}function S(t,e){var n=t.inM,r=t.instruction,i=t.reset,s=e.A,u=e.D,a=e.PC,o=e.ALU,c=e.flag,h=A(r),f=h.j1&&c===l.vU.Positive,d=h.j2&&c===l.vU.Zero,v=h.j3&&c===l.vU.Negative;a=i?0:f||d||v?s:a,h.d2&&(u=o);var p=s;h.c?h.d1&&(s=o):s=32767&r;var m=h.am?n:s,Z=(0,l.Bb)(h.op,u,m);return o=Z[0],c=Z[1],[{addressM:h.d3?p:s,outM:o,writeM:h.d3},{A:s,D:u,ALU:o,flag:c,PC:a}]}var D=new WeakMap,P=new WeakMap,O=new WeakMap,R=new WeakMap,E=function(){function t(e){var n=e.RAM,i=void 0===n?new h.FH:n,a=e.ROM;(0,r.Z)(this,t),(0,u.Z)(this,"RAM",void 0),(0,u.Z)(this,"ROM",void 0),(0,u.Z)(this,"Screen",void 0),(0,u.Z)(this,"Keyboard",void 0),(0,s.Z)(this,D,{writable:!0,value:0}),(0,s.Z)(this,P,{writable:!0,value:0}),(0,s.Z)(this,O,{writable:!0,value:0}),(0,s.Z)(this,R,{writable:!0,value:{A:0,D:0,PC:0,ALU:0,flag:l.vU.Zero}}),this.RAM=i,this.ROM=a,this.Screen=new h.kG(this.RAM,h.yJ,h.GD),this.Keyboard=new h.qT(this.RAM)}return(0,i.Z)(t,[{key:"state",get:function(){return(0,o.Z)(this,R)}},{key:"PC",get:function(){return(0,o.Z)(this,D)}},{key:"A",get:function(){return(0,o.Z)(this,P)}},{key:"D",get:function(){return(0,o.Z)(this,O)}},{key:"setA",value:function(t){(0,a.Z)(this,P,t)}},{key:"setD",value:function(t){(0,a.Z)(this,O,t)}},{key:"setPC",value:function(t){(0,a.Z)(this,D,t)}},{key:"reset",value:function(){(0,a.Z)(this,D,0),(0,a.Z)(this,P,0),(0,a.Z)(this,O,0)}},{key:"tick",value:function(){var t=function(t,e){var n=M(t,e),r=(0,c.Z)(n,2),i=r[0];return r[1],S(t,i)}({inM:this.RAM.get((0,o.Z)(this,P)),instruction:this.ROM.get((0,o.Z)(this,D)),reset:!1},{A:(0,o.Z)(this,P),D:(0,o.Z)(this,O),PC:(0,o.Z)(this,D),ALU:(0,o.Z)(this,O),flag:l.vU.Zero}),e=(0,c.Z)(t,2),n=e[0],r=n.addressM,i=n.outM,s=n.writeM,u=e[1],h=u.A,f=u.D,d=u.PC;(0,a.Z)(this,P,h),(0,a.Z)(this,O,f),(0,a.Z)(this,D,d),s&&this.RAM.set(r,i)}}]),t}()},5838:function(t,e,n){n.d(e,{FH:function(){return x},GD:function(){return m},I2:function(){return p},eD:function(){return b},eu:function(){return k},kG:function(){return w},qT:function(){return g},yJ:function(){return Z},zp:function(){return y}});var r=n(7591),i=n(4337),s=n(649),u=n(1092),a=n(7791),o=n(2951),c=n(1976),l=n(4649),h=n(5541),f=n(7693),d=n(326),v=n(7930),p=["bin","dec","hex","asm"],m=16384,Z=131072,k=24576,y=function(){function t(e){(0,o.Z)(this,t),(0,l.Z)(this,"memory",void 0),this.memory=new Int16Array(e)}return(0,c.Z)(t,[{key:"size",get:function(){return this.memory.length}},{key:"get",value:function(t){var e;return t<0||t>=this.size?65535:null!==(e=this.memory[t])&&void 0!==e?e:0}},{key:"set",value:function(t,e){t>=0&&t<this.size&&(this.memory[t]=65535&e)}},{key:"reset",value:function(){this.memory.fill(0)}},{key:"update",value:function(t,e,n){var r;switch(n){case"asm":r=(0,f.op)(e);break;case"bin":r=(0,d.C$)(e);break;case"hex":r=(0,d.Af)(e);break;default:r=(0,d.o5)(e)}isFinite(r)&&r<=65535&&this.set(t,r)}},{key:"load",value:function(){var t=(0,a.Z)((0,u.Z)().mark((function t(e,n){return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=this,t.next=4,(0,v.zD)(e,n);case 4:t.t1=t.sent,t.t0.loadBytes.call(t.t0,t.t1),t.next=11;break;case 8:throw t.prev=8,t.t2=t.catch(0),new Error("Memory Failed to load file ".concat(n));case 11:case"end":return t.stop()}}),t,this,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"loadBytes",value:function(t){this.memory.set(new Int16Array(t)),this.memory.fill(0,t.length,this.size)}},{key:"range",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size;return(0,s.Z)(this.memory.slice(t,e))}},{key:"map",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.size;return(0,u.Z)().mark((function i(){var s;return(0,u.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:(0,h.hu)(n<r),s=n;case 2:if(!(s<r)){i.next=8;break}return i.next=5,t(s,e.get(s));case 5:s++,i.next=2;break;case 8:case"end":return i.stop()}}),i)}))()}}]),t}(),w=function(){function t(e,n,r){(0,o.Z)(this,t),(0,l.Z)(this,"parent",void 0),(0,l.Z)(this,"size",void 0),(0,l.Z)(this,"offset",void 0),this.parent=e,this.size=n,this.offset=r}return(0,c.Z)(t,[{key:"get",value:function(t){return t<0||t>=this.size?65535:this.parent.get(this.offset+t)}},{key:"set",value:function(t,e){t>=0&&t<this.size&&this.parent.set(t+this.offset,e)}},{key:"reset",value:function(){for(var t=0;t<this.size;t++)this.set(t,0)}},{key:"update",value:function(t,e,n){t>=0&&t<this.size&&this.parent.update(t+this.offset,e,n)}},{key:"load",value:function(t,e){return this.parent.load(t,e)}},{key:"loadBytes",value:function(t){return this.parent.loadBytes(t)}},{key:"range",value:function(t,e){return this.parent.range(t,e)}},{key:"map",value:function(t,e,n){return this.parent.map(t,e,n)}}]),t}(),g=function(t){(0,r.Z)(n,t);var e=(0,i.Z)(n);function n(t){return(0,o.Z)(this,n),e.call(this,t,1,24576)}return(0,c.Z)(n,[{key:"getKey",value:function(){return this.get(0)}},{key:"setKey",value:function(t){this.set(0,65535&t)}},{key:"clearKey",value:function(){this.set(0,0)}}]),n}(w),b=function(t){(0,r.Z)(n,t);var e=(0,i.Z)(n);function n(t){(0,o.Z)(this,n);var r=new Int16Array(n.SIZE);return r.set(t),e.call(this,r)}return(0,c.Z)(n)}(y);(0,l.Z)(b,"SIZE",32768);var x=function(t){(0,r.Z)(n,t);var e=(0,i.Z)(n);function n(){return(0,o.Z)(this,n),e.call(this,n.SIZE)}return(0,c.Z)(n)}(y);(0,l.Z)(x,"SIZE",32768)},7930:function(t,e,n){n.d(e,{zD:function(){return u}});var r=n(1092),i=n(7791),s=n(2724);function u(t,e){return a.apply(this,arguments)}function a(){return(a=(0,i.Z)((0,r.Z)().mark((function t(e,n){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.endsWith(".hack")){t.next=2;break}return t.abrupt("return",l(e,n));case 2:if(!n.endsWith(".asm")){t.next=4;break}return t.abrupt("return",o(e,n));case 4:throw new Error("Cannot load file without hack or asm extension ".concat(n));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function o(t,e){return c.apply(this,arguments)}function c(){return(c=(0,i.Z)((0,r.Z)().mark((function t(e,n){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=s,t.next=3,e.readFile(n);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.loadAsm.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function l(t,e){return h.apply(this,arguments)}function h(){return(h=(0,i.Z)((0,r.Z)().mark((function t(e,n){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=s,t.next=3,e.readFile(n);case 3:return t.t1=t.sent,t.abrupt("return",t.t0.loadHack.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},1510:function(t,e,n){n.d(e,{eP:function(){return u},rJ:function(){return o},y1:function(){return a},Pz:function(){return c}});var r=n(5640),i=n(326),s=n(4625),u="Unknown parse error",a={Base:r.Z.grammar('\nBase {\n  Root = Value*\n\n  At = at\n  Bang = bang\n  Bar = bar\n  CloseAngle = closeAngle\n  CloseBrace = closeBrace\n  CloseParen = closeParen\n  CloseSquare = closeSquare\n  Comma = comma\n  Dollar = dollar\n  Dot = dot\n  DoubleQuote = doubleQuote\n  Equal = equal\n  OpenAngle = openAngle\n  OpenBrace = openBrace\n  OpenParen = openParen\n  OpenSquare = openSquare\n  Percent = percent\n  Semi = semi\n  Underscore = underscore\n\n  at = "@"\n  bang = "!"\n  bar = "|"\n  closeAngle = ">"\n  closeBrace = "}"\n  closeParen = ")"\n  closeSquare = "]"\n  comma = ","\n  dollar = "$"\n  dot = "."\n  doubleQuote = "\\""\n  equal = "="\n  minus = "-"\n  newline = "\\r"? "\\n"\n  openAngle = "<"\n  openBrace = "{"\n  openParen = "("\n  openSquare = "["\n  percent = "%"\n  semi = ";"\n  underscore = "_"\n\n  Value = identifier | number | boolean\n\n  boolean = true | false\n  True = true\n  False = false\n  true = "true"\n  false = "false"\n\n  Name = identifier\n  identifier = (letter|underscore) (alnum|underscore|dot|dollar)*\n\n  Number = number\n  number = hexNumber | decNumber | binNumber\n  binNumber = ("%B") ("0"|"1")+\n  hexNumber = ("%X") hexDigit+\n  decNumber = ("%D")? (wholeDec | realDec)\n  wholeDec = minus? digit+\n  realDec = minus? digit* "." digit+\n\n  String = DoubleQuote (~doubleQuote any)* doubleQuote\n  \n  spaces := (lineComment | comment | space)*\n  commentStart = "/*"\n  commentEnd = "*/"\n  comment = commentStart (~commentEnd any)* commentEnd\n  lineCommentStart = "//"\n  lineComment = lineCommentStart (~"\\n" any)* "\\n"\n\n  List<elem, sep> = NonemptyListOf<elem, sep> sep?\n  EmptyList<elem, sep> = EmptyList<elem, sep> sep?\n}')},o=a.Base.createSemantics();function c(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.root};return function(r){try{var i,a,o=t.match(r);if(o.succeeded()){var c=e(o),l=n(c);return(0,s.Ok)(l)}return(0,s.UG)({message:null!==(i=o.message)&&void 0!==i?i:u,shortMessage:null!==(a=o.shortMessage)&&void 0!==a?a:u})}catch(h){return(0,s.UG)(h)}}}o.extendOperation("asIteration",{List:function(t,e){return t.asIteration()}}),o.addAttribute("value",{decNumber:function(t,e){return(0,i.o5)(e.sourceString)},wholeDec:function(t,e){return(0,i.o5)(e.sourceString)},binNumber:function(t,e){return(0,i.C$)(e.sourceString)},hexNumber:function(t,e){return(0,i.Af)(e.sourceString)},Number:function(t){return t.value},Name:function(t){return t.name},identifier:function(t,e){return this.sourceString}}),o.addAttribute("name",{identifier:function(t,e){return this.sourceString},Name:function(t){var e;return null===(e=this.child(0))||void 0===e?void 0:e.name}}),o.addAttribute("String",{String:function(t,e,n){return e.sourceString}})},8365:function(t,e,n){n.d(e,{lA:function(){return o}});var r=n(5640),i=n(1510),s="\nCmp <: Base {\n  Root := line*\n  line = bar cell+ newline?\n  cell = cellvalue bar\n  cellvalue = (~(bar|newline) any)*\n}",u=r.Z.grammar(s,i.y1),a=u.extendSemantics(i.rJ);a.addAttribute("cell",{cell:function(t,e){return t.sourceString}}),a.addAttribute("line",{line:function(t,e,n){return e.children.map((function(t){return t.cell}))}}),a.addAttribute("root",{Root:function(t){return t.children.map((function(t){return t.line}))}});var o={grammar:s,semantics:a,parser:u,parse:(0,i.Pz)(u,a)}},9647:function(t,e,n){n.d(e,{qH:function(){return o}});var r=n(5640),i=n(1510),s='\nTst <: Base {\n  Root := Tst\n  Tst = (TstStatement | TstRepeat | TstWhile)+\n\n  TstRepeat = Repeat Number? OpenBrace TstStatement+ CloseBrace\n  TstWhile = While Condition OpenBrace TstStatement+ CloseBrace\n  TstStatement = List<TstOperation, ","> (Semi | Bang)\n\n  TstOperation =\n    | TstFileOperation\n    | TstOutputListOperation\n    | TstEvalOperation\n    | TstSetOperation\n    | TstOutputOperation\n    | TstEchoOperation\n    | TstClearEchoOperation\n    | TstLoadROMOperation\n\n  TstLoadROMOperation = ROM32K Load FileName\n  TstFileOperation = FileOperation FileName\n  TstOutputListOperation = "output-list" OutputFormat+\n  OutputFormat = Name Index? percent FormatStyle wholeDec dot wholeDec dot wholeDec\n  TstSetOperation = Set Name Index? Number\n  Index = OpenSquare wholeDec? CloseSquare\n  Condition = Value CompareOp Value\n  TstEvalOperation = Eval | Tick | Tock | TickTock\n  TstOutputOperation = Output\n  TstEchoOperation = Echo String\n  TstClearEchoOperation = ClearEcho\n\n  FileName = Name\n  FileOperation = "load" | "output-file" | "compare-to"\n\n  Set = "set"\n  Eval = "eval"\n  Tick = "tick"\n  Tock = "tock"\n  TickTock = "ticktock"\n  Echo = "echo"\n  Repeat = "repeat"\n  ClearEcho = "clear-echo"\n  Output = "output"\n  OutputList = "output-list"\n  FormatStyle = "B"|"D"|"S"|"X"\n  ROM32K = "ROM32K"\n  Load = "load"\n  While = "while"\n\n  CompareOp = "<>" | "<=" | ">=" | "=" | "<" | ">"\n}',u=r.Z.grammar(s,i.y1),a=u.extendSemantics(i.rJ);a.extendAttribute("value",{Index:function(t,e,n){var r,i;return null!==(r=null===e||void 0===e||null===(i=e.child(0))||void 0===i?void 0:i.value)&&void 0!==r?r:-1}}),a.extendAttribute("name",{FileName:function(t){return t.name}}),a.addAttribute("index",{Index:function(t,e,n){var r,i;return null!==(r=null===(i=e.child(0))||void 0===i?void 0:i.value)&&void 0!==r?r:0}}),a.addAttribute("format",{OutputFormat:function(t,e,n,r,i,s,u,a,o){var c,l,h=t.name,f=r.sourceString,d=i.value,v=u.value,p=o.value;return{id:h,builtin:void 0!==(null===e||void 0===e?void 0:e.child(0)),address:null!==(c=null===e||void 0===e||null===(l=e.child(0))||void 0===l?void 0:l.value)&&void 0!==c?c:-1,style:f,width:v,lpad:d,rpad:p}}}),a.addAttribute("operation",{TstEvalOperation:function(t){return{op:t.sourceString}},TstOutputOperation:function(t){return{op:"output"}},TstOutputListOperation:function(t,e){return{op:"output-list",spec:e.children.map((function(t){return t.format}))}},TstSetOperation:function(t,e,n,r){var i,s,u={op:"set",id:e.name,value:r.value},a=null===(i=n.child(0))||void 0===i||null===(s=i.child(1))||void 0===s?void 0:s.child(0);return a&&(u.index=a.value),u},TstEchoOperation:function(t,e){return{op:"echo",message:e.String}},TstClearEchoOperation:function(t){return{op:"clear-echo"}},TstLoadROMOperation:function(t,e,n){return{op:"loadRom",file:n.name}},TstFileOperation:function(t,e){return{op:t.sourceString,file:e.sourceString}}}),a.addAttribute("condition",{Condition:function(t,e,n){var r=t.value,i=e.sourceString;return{left:r,right:n.value,op:i}}}),a.addAttribute("statement",{TstWhile:function(t,e,n,r,i){return{statements:r.children.map((function(t){return t.statement})),condition:e.condition,span:{start:t.source.startIdx,end:e.source.endIdx}}},TstRepeat:function(t,e,n,r,i){var s,u;return{statements:r.children.map((function(t){return t.statement})),count:null!==(s=null===(u=e.child(0))||void 0===u?void 0:u.value)&&void 0!==s?s:-1,span:{start:t.source.startIdx,end:e.source.endIdx}}},TstStatement:function(t,e){var n={ops:t.asIteration().children.map((function(t){return t.operation})),span:{start:this.source.startIdx,end:this.source.endIdx}};return"!"===e.sourceString&&(n.break=!0),n}}),a.addAttribute("tst",{Tst:function(t){return{lines:t.children.map((function(t){return t.statement}))}}}),a.addAttribute("root",{Root:function(t){return t.tst}});var o={grammar:s,semantics:a,parser:u,parse:(0,i.Pz)(u,a)}},2724:function(t,e,n){n.r(e),n.d(e,{loadAsm:function(){return y},loadBlob:function(){return x},loadHack:function(){return g}});var r=n(1092),i=n(7791),s=n(4625),u=n(726),a=n(5541),o=n(5640),c=n(6693),l=n(5838),h=n(7693),f=n(1510),d='\nASM <: Base {\n  Root := ASM\n  ASM = Instruction*\n  \n  Instruction = Label|AInstruction|CInstruction\n  \n  Label = OpenParen identifier closeParen\n  AInstruction = at (identifier | decNumber)\n  CInstruction = assign? op jmp?\n  \n  assign = (\n      "AMD"\n      | "AM"\n      | "AD"\n      | "MD"\n      | "M"\n      | "D"\n      | "A"\n      ) equal\n      \n  op =\n      | "0" | "1" | "-1"\n      | "!D" | "!A" | "!M"\n      | "-D" | "-A" | "-M"\n      | "D+1" | "A+1" | "M+1"\n      | "D-1" | "A-1" | "M-1"\n      | "D+A" | "D+M"\n      | "D-A" | "D-M"\n      | "A-D" | "M-D"\n      | "D&A" | "D&M"\n      | "D|A" | "D|M"\n      | "D" | "A" | "M"\n\n\n  jmp = semi ("JGT" | "JEQ" | "JGE" | "JLT" | "JNE" | "JLE" | "JMP")\n}',v=o.Z.grammar(d,f.y1),p=v.extendSemantics(f.rJ);function m(t){return void 0!==t.label}p.addAttribute("root",{Root:function(t){return this.asm}}),p.addAttribute("asm",{Root:function(t){return{instructions:t.child(0).children.map((function(t){return t.instruction}))}}}),p.addAttribute("instruction",{AInstruction:function(t,e){try{return{type:"A",label:e.name}}catch(n){}try{return{type:"A",value:e.value}}catch(n){}throw new Error("AsmAInstruction must have either a name or a value")},CInstruction:function(t,e,n){var r,i,s,u,a=null===(r=t.child(0))||void 0===r||null===(i=r.child(0))||void 0===i?void 0:i.sourceString,o=e.sourceString.replace("M","A"),l=null===(s=n.child(0))||void 0===s||null===(u=s.child(1))||void 0===u?void 0:u.sourceString,h=t.sourceString.includes("M")||e.sourceString.includes("M"),f={type:"C",op:c.PH.asm[o],isM:h};return l&&(f.jump=c.lK.asm[l]),a&&(f.store=c.Uc.asm[a]),f},Label:function(t,e,n){return{type:"L",label:e.name}}});var Z={grammar:d,semantics:p,parser:v,parse:(0,f.Pz)(v,p),passes:{fillLabel:function(t){var e,n=16,r=new Map([["R0",0],["R1",1],["R2",2],["R3",3],["R4",4],["R5",5],["R6",6],["R7",7],["R8",8],["R9",9],["R10",10],["R11",11],["R12",12],["R13",13],["R14",14],["R15",15],["SP",0],["LCL",1],["ARG",2],["THIS",3],["THAT",4],["SCREEN",l.GD],["KBD",l.eu]]),i=[],s=0,o=(0,u.Z)(t.instructions);try{for(o.s();!(e=o.n()).done;){var c=e.value;if("L"!==c.type)s+=1,"A"===c.type&&m(c)&&i.push(c);else{if(r.has(c.label))throw new Error("ASM Duplicate label ".concat(c.label));r.set(c.label,s)}}}catch(h){o.e(h)}finally{o.f()}i.forEach((function(t){var e,i=(e=t.label,r.has(e)||(r.set(e,n),n+=1),(0,a.kP)(r.get(e),"Label not in symbols: ".concat(e)));t.value=i,delete t.label}))},emit:function(t){return t.instructions.map((function(t){if("A"===t.type){if(m(t))throw new Error("ASM Emitting unfilled A instruction");return t.value}if("C"===t.type)return(0,h.p)(t.isM,t.op,t.store,t.jump)})).filter((function(t){return void 0!==t}))}}},k=n(326);function y(t){return w.apply(this,arguments)}function w(){return w=(0,i.Z)((0,r.Z)().mark((function t(e){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,s.Wg)(Z.parse(e)),Z.passes.fillLabel(n),t.abrupt("return",Z.passes.emit(n));case 3:case"end":return t.stop()}}),t)}))),w.apply(this,arguments)}function g(t){return b.apply(this,arguments)}function b(){return(b=(0,i.Z)((0,r.Z)().mark((function t(e){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.split("\n").filter((function(t){return""!==t.trim()})).map(k.C$));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(t){return A.apply(this,arguments)}function A(){return(A=(0,i.Z)((0,r.Z)().mark((function t(e){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.split("\n").filter((function(t){return""!==t.trim()})).map(k.t1));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},3389:function(t,e,n){n.d(e,{o6:function(){return R},l1:function(){return O}});var r=n(7169),i=n(3243),s=n(7597),u=n(7591),a=n(4337),o=n(726),c=n(1092),l=n(7791),h=n(2951),f=n(1976),d=n(4649),v=n(5541),p=n(9956),m=n(6329),Z=n(6531),k=n(9422),y=n(326),w=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"%B1.1.1",r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0;if((0,h.Z)(this,t),(0,d.Z)(this,"variable",void 0),(0,d.Z)(this,"fmt",void 0),(0,d.Z)(this,"lPad",void 0),(0,d.Z)(this,"rPad",void 0),(0,d.Z)(this,"len",void 0),(0,d.Z)(this,"index",void 0),(0,d.Z)(this,"builtin",void 0),this.variable=e,n.startsWith("%")&&void 0===r&&void 0===i&&void 0===s){var o,c=null===(o=n.match((0,k.Z)(/^%([BDXS])(\d+)\.(\d+)\.(\d+)$/,{fmt:1,lPad:2,len:3,rPad:4})))||void 0===o?void 0:o.groups,l=c.fmt,f=c.lPad,p=c.rPad,m=c.len;this.fmt=l,this.lPad=parseInt(f),this.rPad=parseInt(p),this.len=parseInt(m),this.builtin=!1,this.index=-1}else(0,v.hu)(["B","X","D","S"].includes(n[0])),this.fmt=n[0],this.len=null!==r&&void 0!==r?r:3,this.lPad=null!==i&&void 0!==i?i:1,this.rPad=null!==s&&void 0!==s?s:1,this.builtin=null!==u&&void 0!==u&&u,this.index=null!==a&&void 0!==a?a:-1}return(0,f.Z)(t,[{key:"header",value:function(t){var e="".concat(this.variable);if(this.builtin){var n=this.index>=0?this.index:"";e="".concat(e,"[").concat(n,"]")}return e.length>this.len+this.lPad+this.rPad?e.substring(0,this.len+this.lPad+this.rPad):this.padCenter(e)}},{key:"print",value:function(t){var e=t.getVar(this.variable,this.index);if("S"===this.fmt)return this.padLeft(e);var n=(0,{B:y.Ly,D:y.E_,X:y.$v}[this.fmt])(e);return"D"===this.fmt?this.padRight(n):this.padCenter(n.slice(n.length-this.len))}},{key:"padCenter",value:function(t){var e=this.lPad+this.len+this.rPad,n=Math.floor((e-t.length)/2),r=e-n-t.length,i=n+t.length,s=i+r;return t=(t=t.padStart(i)).padEnd(s)}},{key:"padLeft",value:function(t){t=t.substring(0,this.len);var e=this.rPad+this.len,n=this.lPad+e;return t=(t=t.padEnd(e)).padStart(n)}},{key:"padRight",value:function(t){t=t.substring(0,this.len);var e=this.lPad+this.len,n=this.rPad+e;return t=(t=t.padStart(e)).padEnd(n)}}]),t}(),g=n(5838),b=n(134),x=function(){function t(){(0,h.Z)(this,t),(0,d.Z)(this,"instructions",[]),(0,d.Z)(this,"_outputList",[]),(0,d.Z)(this,"_log",""),(0,d.Z)(this,"fs",new p.Wd),(0,d.Z)(this,"_steps",void 0),(0,d.Z)(this,"_step",void 0),(0,d.Z)(this,"breakpoints",new Map)}return(0,f.Z)(t,[{key:"setFileSystem",value:function(t){return this.fs=t,this}},{key:"echo",value:function(t){}},{key:"clearEcho",value:function(){}},{key:"load",value:function(){var t=(0,l.Z)((0,c.Z)().mark((function t(e){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",void 0);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"compareTo",value:function(){var t=(0,l.Z)((0,c.Z)().mark((function t(e){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",void 0);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"outputFile",value:function(t){}},{key:"outputList",value:function(t){this._outputList=t}},{key:"addInstruction",value:function(t){this.instructions.push(t)}},{key:"reset",value:function(){return this._steps=(0,c.Z)().mark((function t(e){var n,r,i;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=(0,o.Z)(e.instructions),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=8;break}return i=r.value,t.delegateYield(i.steps(e),"t0",6);case 6:t.next=3;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t.catch(1),n.e(t.t1);case 13:return t.prev=13,n.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])}))(this),this._step=this._steps.next(),this._step,this._log="",this}},{key:"steps",get:function(){return void 0===this._steps&&(this.reset(),this._steps=(0,v.kP)(this._steps,"Reset did not initialize steps"),this._step=(0,v.kP)(this._step,"Reset did not find first step")),this._steps}},{key:"currentStep",get:function(){var t;return null===(t=this._step)||void 0===t?void 0:t.value}},{key:"done",get:function(){var t,e;return null!==(t=null===(e=this._step)||void 0===e?void 0:e.done)&&void 0!==t&&t}},{key:"step",value:function(){return!!this._step.done||(this._step.value.do(this),this._step=this.steps.next(),!1)}},{key:"run",value:function(){var t=(0,l.Z)((0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.reset();case 1:return t.next=3,this.step();case 3:if(t.sent){t.next=7;break}t.next=1;break;case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"addBreakpoint",value:function(t,e){this.breakpoints.set(t,e)}},{key:"clearBreakpoints",value:function(){this.breakpoints.clear()}},{key:"output",value:function(){var t=this,e=this._outputList.map((function(e){return e.print(t)}));this._log+="|".concat(e.join("|"),"|\n")}},{key:"header",value:function(){var t=this,e=this._outputList.map((function(e){return e.header(t)}));this._log+="|".concat(e.join("|"),"|\n")}},{key:"log",value:function(){return this._log}}]),t}();function A(t){return void 0!==t.ops}function M(t){return void 0!==t.condition}function S(t){var e=new I;e.span=t.span;var n,r=(0,o.Z)(t.ops);try{for(r.s();!(n=r.n()).done;){var i=D(n.value);void 0!==i&&e.addInstruction(i)}}catch(s){r.e(s)}finally{r.f()}return e}function D(t){var e=t.op;switch(e){case"tick":return new F;case"tock":return new U;case"eval":return new J;case"output":return new C;case"set":return new E(t.id,t.value,t.index);case"output-list":return new T(t.spec);case"echo":return new N(t.message);case"clear-echo":return new V;case"loadRom":return new _(t.file);case"load":case"output-file":case"compare-to":return;default:(0,v.qV)(e,"Unknown tst operation ".concat(e))}}function P(t,e){var n,r=(0,o.Z)(e.lines);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(A(i))t.addInstruction(S(i));else{var s=M(i)?new B(new L(i.condition.left,i.condition.right,i.condition.op)):new j(i.count);s.span=i.span,t.addInstruction(s);var u,a=(0,o.Z)(i.statements);try{for(a.s();!(u=a.n()).done;){var c=u.value;s.addInstruction(S(c))}}catch(l){a.e(l)}finally{a.f()}}}}catch(l){r.e(l)}finally{r.f()}return t.reset(),t}var O=function(t){(0,u.Z)(n,t);var e=(0,a.Z)(n);function n(){var t;(0,h.Z)(this,n);for(var i=arguments.length,s=new Array(i),u=0;u<i;u++)s[u]=arguments[u];return t=e.call.apply(e,[this].concat(s)),(0,d.Z)((0,r.Z)(t),"chip",new m.P9),(0,d.Z)((0,r.Z)(t),"clock",Z.S.get()),t}return(0,f.Z)(n,[{key:"chipId",get:function(){return this.chip.id}},{key:"with",value:function(t){return this.chip=t,this}},{key:"hasVar",value:function(t){return"time"===t||(t="".concat(t),this.chip.hasIn(t)||this.chip.hasOut(t))}},{key:"getVar",value:function(t,e){if("time"===(t="".concat(t)))return this.clock.toString();var n=this.chip.get(t,e);return n?n instanceof m.Gc?n.busVoltage:n.voltage():0}},{key:"setVar",value:function(t,e,n){var r=this.chip.get(t,n);r instanceof m.Gc?r.busVoltage=e:null===r||void 0===r||r.pull(0===e?m.yE:m.lj)}},{key:"eval",value:function(){this.chip.eval()}},{key:"tick",value:function(){this.chip.eval(),this.clock.tick()}},{key:"tock",value:function(){this.chip.eval(),this.clock.tock()}},{key:"load",value:function(){var t=(0,l.Z)((0,c.Z)().mark((function t(e){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.chip.load(this.fs,e);case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"run",value:function(){var t=(0,l.Z)((0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clock.reset(),t.next=3,(0,i.Z)((0,s.Z)(n.prototype),"run",this).call(this);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}],[{key:"from",value:function(t){return P(new n,t)}}]),n}(x),R=function(t){(0,u.Z)(n,t);var e=(0,a.Z)(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new g.eD(new Int16Array);return(0,h.Z)(this,n),t=e.call(this),(0,d.Z)((0,r.Z)(t),"cpu",void 0),(0,d.Z)((0,r.Z)(t),"ticks",0),t.cpu=new b.Z9({ROM:i}),t.reset(),t}return(0,f.Z)(n,[{key:"reset",value:function(){return this.cpu.reset(),this.ticks=0,this}},{key:"hasVar",value:function(t){return"number"!==typeof t&&!("A"!==t&&"D"!==t&&"PC"!==t&&"time"!==t&&!t.startsWith("RAM"))}},{key:"getVar",value:function(t){switch(t){case"A":return this.cpu.A;case"D":return this.cpu.D;case"PC":return this.cpu.PC;case"time":return this.ticks}if("number"===typeof t)return 0;if(t.startsWith("RAM")){var e=Number(t.substring(4,t.length-1));return this.cpu.RAM.get(e)}return 0}},{key:"setVar",value:function(t,e,n){switch(t){case"A":this.cpu.setA(e);break;case"D":this.cpu.setD(e);break;case"PC":this.cpu.setPC(e);break;case"RAM":this.cpu.RAM.set(null!==n&&void 0!==n?n:0,e)}}},{key:"ticktock",value:function(){this.ticks+=1,this.cpu.tick()}},{key:"load",value:function(){var t=(0,l.Z)((0,c.Z)().mark((function t(e){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.cpu.ROM.load(this.fs,e);case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}],[{key:"from",value:function(t){return P(new n,t)}}]),n}(x),E=function(){function t(e,n,r){(0,h.Z)(this,t),(0,d.Z)(this,"variable",void 0),(0,d.Z)(this,"value",void 0),(0,d.Z)(this,"index",void 0),this.variable=e,this.value=n,this.index=r}return(0,f.Z)(t,[{key:"do",value:function(t){t.setVar(this.variable,this.value,this.index)}},{key:"steps",value:(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}(),C=function(){function t(){(0,h.Z)(this,t)}return(0,f.Z)(t,[{key:"do",value:function(t){t.output()}},{key:"steps",value:(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}(),T=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,h.Z)(this,t),(0,d.Z)(this,"outputs",[]);var n,r=(0,o.Z)(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.addOutput(i)}}catch(s){r.e(s)}finally{r.f()}}return(0,f.Z)(t,[{key:"addOutput",value:function(t){this.outputs.push(new w(t.id,t.style,t.width,t.lpad,t.rpad,t.builtin,t.address))}},{key:"do",value:function(t){t.outputList(this.outputs),t.header()}},{key:"steps",value:(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}(),I=function(){function t(){(0,h.Z)(this,t),(0,d.Z)(this,"instructions",[]),(0,d.Z)(this,"span",void 0)}return(0,f.Z)(t,[{key:"addInstruction",value:function(t){this.instructions.push(t)}},{key:"do",value:function(t){var e,n=(0,o.Z)(this.instructions);try{for(n.s();!(e=n.n()).done;){e.value.do(t)}}catch(r){n.e(r)}finally{n.f()}}},{key:"steps",value:(0,c.Z)().mark((function t(e){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}(),j=function(t){(0,u.Z)(n,t);var e=(0,a.Z)(n);function n(t){var i;return(0,h.Z)(this,n),i=e.call(this),(0,d.Z)((0,r.Z)(i),"repeat",void 0),i.repeat=t,i}return(0,f.Z)(n,[{key:"do",value:function(){}},{key:"innerSteps",value:(0,c.Z)().mark((function t(e){var n,r,i;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=(0,o.Z)(this.instructions),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=8;break}return i=r.value,t.delegateYield(i.steps(e),"t0",6);case 6:t.next=3;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t.catch(1),n.e(t.t1);case 13:return t.prev=13,n.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[1,10,13,16]])}))},{key:"steps",value:(0,c.Z)().mark((function t(e){var n;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==this.repeat){t.next=9;break}return t.next=3,this;case 3:return t.delegateYield(this.innerSteps(e),"t0",5);case 5:t.next=3;break;case 7:t.next=17;break;case 9:n=0;case 10:if(!(n<this.repeat)){t.next=17;break}return t.next=13,this;case 13:return t.delegateYield(this.innerSteps(e),"t1",14);case 14:n++,t.next=10;break;case 17:case"end":return t.stop()}}),t,this)}))}]),n}(I),L=function(){function t(e,n,r){(0,h.Z)(this,t),(0,d.Z)(this,"x",void 0),(0,d.Z)(this,"y",void 0),(0,d.Z)(this,"op",void 0),this.x=e,this.y=n,this.op=r}return(0,f.Z)(t,[{key:"check",value:function(t){var e=t.hasVar(this.x)?t.getVar(this.x):this.x,n=t.hasVar(this.y)?t.getVar(this.y):this.y;if("string"===typeof e||"string"===typeof n)switch(this.op){case"=":return"".concat(e)==="".concat(n);case"<>":return"".concat(e)!=="".concat(n)}else switch(this.op){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;case"=":return e===n;case"<>":return e!==n}return!1}}]),t}(),B=function(t){(0,u.Z)(n,t);var e=(0,a.Z)(n);function n(t){var i;return(0,h.Z)(this,n),i=e.call(this),(0,d.Z)((0,r.Z)(i),"condition",void 0),i.condition=t,i}return(0,f.Z)(n,[{key:"steps",value:(0,c.Z)().mark((function t(e){var n,r,i;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.condition.check(e)){t.next=21;break}return t.next=3,this;case 3:n=(0,o.Z)(this.instructions),t.prev=4,n.s();case 6:if((r=n.n()).done){t.next=11;break}return i=r.value,t.delegateYield(i.steps(e),"t0",9);case 9:t.next=6;break;case 11:t.next=16;break;case 13:t.prev=13,t.t1=t.catch(4),n.e(t.t1);case 16:return t.prev=16,n.f(),t.finish(16);case 19:t.next=0;break;case 21:case"end":return t.stop()}}),t,this,[[4,13,16,19]])}))}]),n}(I),N=function(){function t(e){(0,h.Z)(this,t),(0,d.Z)(this,"content",void 0),this.content=e}return(0,f.Z)(t,[{key:"do",value:function(t){t.echo(this.content)}},{key:"steps",value:(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}(),V=function(){function t(){(0,h.Z)(this,t)}return(0,f.Z)(t,[{key:"do",value:function(t){t.clearEcho()}},{key:"steps",value:(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}(),_=function(){function t(e){(0,h.Z)(this,t),(0,d.Z)(this,"file",void 0),this.file=e}return(0,f.Z)(t,[{key:"do",value:function(){var t=(0,l.Z)((0,c.Z)().mark((function t(e){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.fs.pushd("/test"),t.next=3,e.load(this.file);case 3:e.fs.popd();case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"steps",value:(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}(),J=function(){function t(){(0,h.Z)(this,t),(0,d.Z)(this,"_chipTestInstruction_",!0)}return(0,f.Z)(t,[{key:"do",value:function(t){t.eval()}},{key:"steps",value:(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}(),F=function(){function t(){(0,h.Z)(this,t),(0,d.Z)(this,"_chipTestInstruction_",!0)}return(0,f.Z)(t,[{key:"do",value:function(t){t.tick()}},{key:"steps",value:(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}(),U=function(){function t(){(0,h.Z)(this,t),(0,d.Z)(this,"_chipTestInstruction_",!0)}return(0,f.Z)(t,[{key:"do",value:function(t){t.tock()}},{key:"steps",value:(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this;case 2:case"end":return t.stop()}}),t,this)}))}]),t}()},7693:function(t,e,n){n.d(e,{a:function(){return s},op:function(){return u},p:function(){return a}});var r=n(9422),i=n(6693);function s(t){return 32768&t?function(t){t&=65535;var e=(4096&t)>>12,n=(4032&t)>>6,r=(56&t)>>3,s=7&t;if(void 0===i.PH.op[n])return"#ERR";var u=i.PH.op[n];e&&(u=u.replace(/A/g,"M"));var a=i.Uc.op[r],o=i.lK.op[s],c=u;a&&(c="".concat(a,"=").concat(c));o&&(c="".concat(c,";").concat(o));return c}(t):function(t){return"@"+(32767&t).toString(10)}(t)}function u(t){return"@"===t[0]?function(t){return parseInt(t.substring(1),10)}(t):function(t){var e,n=t.match((0,r.Z)(/(?:([AMD]{1,3})=)?([-!01ADM&|]{1,3})(?:;(JGT|JLT|JGE|JLE|JEQ|JMP))?/,{assign:1,operation:2,jump:3})),s=null!==(e=null===n||void 0===n?void 0:n.groups)&&void 0!==e?e:{},u=s.assign,o=s.operation,c=s.jump,l=o.includes("M")||u.includes("M"),h=i.Uc.asm[null!==u&&void 0!==u?u:""],f=i.lK.asm[null!==c&&void 0!==c?c:""],d=i.PH.asm[null!==o&&void 0!==o?o:""];return a(l,d,h,f)}(t)}function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=57344,s=t?4096:0,u=e<<6,a=(null!==n&&void 0!==n?n:0)<<3,o=null!==r&&void 0!==r?r:0;return i+s+u+a+o}},326:function(t,e,n){n.d(e,{$v:function(){return h},Af:function(){return a},C$:function(){return c},C2:function(){return p},E_:function(){return d},Ly:function(){return f},nN:function(){return v},o5:function(){return o},t1:function(){return l}});var r=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];function i(t){var e;return null!==(e=r[t])&&void 0!==e?e:"X"}function s(t){switch(t){case 0:return"0000";case 1:return"0001";case 2:return"0010";case 3:return"0011";case 4:return"0100";case 5:return"0101";case 6:return"0110";case 7:return"0111";case 8:return"1000";case 9:return"1001";case 10:return"1010";case 11:return"1011";case 12:return"1100";case 13:return"1101";case 14:return"1110";case 15:return"1111";default:return"erro"}}function u(t,e){return 65535&parseInt(t.replace(/[^\d a-f A-F +-.]/g,""),e)}function a(t){return u(t,16)}function o(t){return u(t,10)}function c(t){return u(t.replaceAll(" ",""),2)}function l(t){return t.toUpperCase().includes("X")?a(t):o(t)}function h(t){var e=i((61440&t)>>12),n=i((3840&t)>>8),r=i((240&t)>>4),s=i(15&t);return"0x".concat(e).concat(n).concat(r).concat(s)}function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=s((61440&t)>>12),r=s((3840&t)>>8),i=s((240&t)>>4),u=s(15&t);return"".concat(n).concat(r).concat(i).concat(u).substring(16-e)}function d(t){return 32768===(t&=65535)?"-32768":32768&t?"-".concat(t=1+~t&32767):"".concat(t)}function v(t){return"".concat(t&=65535)}function p(t,e){var n=~((t&=65535)&(e&=65535));return n&=65535}}}]);
//# sourceMappingURL=387.4d25afe6.chunk.js.map