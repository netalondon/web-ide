"use strict";(self.webpackChunk_nand2tetris_web=self.webpackChunk_nand2tetris_web||[]).push([[996],{9200:(e,t,n)=>{n.d(t,{M:()=>m});var s=n(5072),i=n(6635),r=n(1703),o=n(6845),a=n(8722),u=n(3484),l=n(864);const c=e=>{var t,n;let{error:i}=e;return null!==i&&void 0!==i&&i.failed()?(0,l.jsxs)("details",{className:"ErrorPanel",open:!0,children:[(0,l.jsx)("summary",{role:"button",className:"secondary",children:(0,l.jsx)(s.cC,{id:"Parse Error"})}),(0,l.jsx)("pre",{children:(0,l.jsx)("code",{children:null!==(t=null!==(n=null===i||void 0===i?void 0:i.message)&&void 0!==n?n:null===i||void 0===i?void 0:i.shortMessage)&&void 0!==t?t:u.eP})})]}):(0,l.jsx)(l.Fragment,{})},h=e=>{let{value:t,onChange:n,language:s,disabled:i=!1}=e;const[r,a]=(0,o.useState)(t);return(0,l.jsx)("textarea",{"data-testid":`editor-${s}`,disabled:i,value:r,onChange:e=>{var t;const s=null===(t=e.target)||void 0===t?void 0:t.value;a(s),n(s)}})},d=e=>{let{value:t,onChange:n,onCursorPositionChange:s,language:i,error:u,disabled:c=!1,highlight:h,dynamicHeight:d=!1,lineNumberTransform:m}=e;const{theme:p}=(0,o.useContext)(a.Il),g=(0,r.Ik)(),[f,b]=(0,o.useState)(0),v=(0,o.useRef)(),w=(0,o.useRef)([]),y=(0,o.useRef)(void 0),A=(0,o.useCallback)((()=>("system"===p?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"===p)?"vs-dark":"vs"),[p]),x=(0,o.useCallback)((()=>{var e;w.current=((e,t,n,s)=>{if(!t||!n)return s;const i=t.getModel();if(!i)return s;const r=i.getPositionAt(n.start),o=i.getPositionAt(n.end),a=null===e||void 0===e?void 0:e.Range.fromPositions(r,o),u=[];return a&&(u.push({range:a,options:{inlineClassName:"highlight"}}),t.revealRangeInCenter(a)),t.deltaDecorations(s,u)})(g,v.current,null!==(e=y.current)&&void 0!==e?e:{start:0,end:0},w.current)}),[w,g,v,y]),M=()=>{if(d){var e;const t=null===(e=v.current)||void 0===e?void 0:e.getContentHeight();t&&b(t)}};(0,o.useEffect)((()=>{y.current=h,x()}),[h]);const C=(0,o.useCallback)((e=>{var t,n;v.current=e,null===(t=v.current)||void 0===t||t.updateOptions({fontFamily:'"JetBrains Mono", source-code-pro, Menlo, Monaco,\n      Consolas, "Roboto Mono", "Ubuntu Monospace", "Noto Mono", "Oxygen Mono",\n      "Liberation Mono", monospace, "Apple Color Emoji", "Segoe UI Emoji",\n      "Segoe UI Symbol", "Noto Color Emoji"',fontSize:16,minimap:{enabled:!1},theme:A(),scrollBeyondLastLine:!1,readOnly:c,lineNumbers:null!==m&&void 0!==m?m:"on",folding:!1}),x(),M(),null===(n=v.current)||void 0===n||n.onDidChangeCursorPosition((e=>{var t,n;const i=null===(t=v.current)||void 0===t||null===(n=t.getModel())||void 0===n?void 0:n.getOffsetAt(e.position);void 0!==i&&(null===s||void 0===s||s(i))}))}),[A]);(0,o.useEffect)((()=>{void 0!==v.current&&v.current.updateOptions({lineNumbers:null!==m&&void 0!==m?m:"on"})}),[m]),(0,o.useEffect)((()=>{void 0!==v.current&&v.current.updateOptions({theme:A()})}),[v,A]),(0,o.useEffect)((()=>{void 0!==v.current&&v.current.updateOptions({readOnly:c})}),[v,c]),(0,o.useEffect)((()=>{var e,t,n,s,r;if(void 0===v.current)return;if(null===g)return;const o=v.current.getModel();if(null===o)return;if(void 0===u||u.succeeded())return void g.editor.setModelMarkers(o,i,[]);const{line:a,column:l,message:c}=null!==(e=null===(t=/Line (?<line>\d+), col (?<column>\d+): (?<message>.*)/.exec(null!==(n=u.shortMessage)&&void 0!==n?n:""))||void 0===t?void 0:t.groups)&&void 0!==e?e:{line:1,column:1,message:"could not parse error"},h=Number(a),d=h,m=Number(l);let p=m+(null!==(s=null===(r=o.getLineContent(h).substring(m-1).match(/([^\s]+)/))||void 0===r?void 0:r[0].length)&&void 0!==s?s:1);p<=m&&(p=m+1),g.editor.setModelMarkers(o,i,[{message:c,startColumn:m,startLineNumber:h,endColumn:p,endLineNumber:d,severity:8}])}),[u,v,g,i]);return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(r.ZP,{value:t,onChange:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";M(),n(e)},language:i,onMount:C,height:d?f:void 0})})},m=e=>{let{className:t="",style:n={},disabled:s=!1,value:r,onChange:u,onCursorPositionChange:m,grammar:p,language:g,highlight:f,dynamicHeight:b=!1,lineNumberTransform:v}=e;const[w,y]=(0,o.useState)(),{monaco:A}=(0,o.useContext)(a.Il),x=(0,o.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(p){const t=p.match(e);y(t.failed()?t:void 0)}}),[y,p]);(0,o.useEffect)((()=>x(r)),[x,r]);const M=(0,o.useMemo)((()=>(0,i.D)(x,500)),[x]),C=(0,o.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";u(e),M(e)}),[M,u]);return(0,l.jsx)("div",{className:`Editor ${b?"dynamic-height":""} ${t}`,style:n,children:A.canUse&&A.wants?(0,l.jsx)(d,{value:r,onChange:C,onCursorPositionChange:m,language:g,error:w,disabled:s,highlight:f,dynamicHeight:b,lineNumberTransform:v}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h,{value:r,onChange:C,language:g,disabled:s}),(0,l.jsx)(c,{error:w})]})})}},8398:(e,t,n)=>{n.d(t,{G:()=>r,s:()=>i});var s=n(864);const i=e=>{var t;return(0,s.jsxs)("article",{className:["panel",null!==(t=e.className)&&void 0!==t?t:""].join(" "),children:[e.header&&(0,s.jsx)("header",{children:e.header}),(0,s.jsx)("main",{children:e.children}),e.footer&&(0,s.jsx)("footer",{children:e.footer})]})},r=e=>{var t;return(0,s.jsxs)("details",{className:null!==(t=e.className)&&void 0!==t?t:"",open:e.open,style:e.style,children:[(0,s.jsx)("summary",{children:(0,s.jsx)("div",{className:"flex row align-baseline",children:e.summary})}),e.children]})}},6604:(e,t,n)=>{n.d(t,{C:()=>r,i:()=>o});var s=n(4983),i=n(6845);function r(e,t){return(0,i.useReducer)(((t,n)=>(0,s.ZP)(t,(t=>{e[n.action](t,n.payload)}))),t)}function o(e){const[t,n]=(0,i.useState)(e);return(0,i.useEffect)((()=>{n(e)}),[e]),[t,n]}},6791:(e,t,n)=>{n.d(t,{D:()=>o});var s=n(864),i=n(6845),r=n(6604);const o=e=>{const t=function(e){const t=(0,i.useRef)((()=>{})),{initialState:n,reducers:s,actions:o}=(0,i.useMemo)((()=>((e,t)=>{const n={running:e.running,speed:e.speed,steps:e.steps},s=e.finishFrame.bind(e);return e.finishFrame=function(){s(),t.current({action:"update"})},{initialState:n,reducers:{update(t){t.running=e.running,t.speed=e.speed,t.steps=e.steps},setSteps(t,n){t.steps=n,e.steps=n},setSpeed(t,n){t.speed=n,e.speed=n}},actions:{frame(){e.frame()},start(){e.start(),t.current({action:"update"})},stop(){e.stop(),t.current({action:"update"})},reset(){e.reset(),t.current({action:"update"})}}}})(e,t)),[e,t]),[a,u]=(0,r.C)(s,n);return t.current=u,{state:a,dispatch:t.current,actions:o}}(e.runner),[n,o]=(0,i.useState)(0),a={0:[1e3,1],1:[500,1],2:[16,1],3:[16,16666],4:[16,499980]};(0,i.useEffect)((()=>{u()}),[n]);const u=()=>{const[e,s]=a[n];t.dispatch({action:"setSpeed",payload:e}),t.dispatch({action:"setSteps",payload:s})};return(0,s.jsxs)("fieldset",{role:"group",children:[e.prefix,(0,s.jsx)("button",{className:"flex-0",onClick:()=>t.actions.frame(),"data-tooltip":e.overrideTooltips?.[0]??"Step","data-placement":"bottom",children:"\u27a1\ufe0f"}),(0,s.jsx)("button",{className:"flex-0",onClick:()=>t.state.running?t.actions.stop():t.actions.start(),"data-tooltip":t.state.running?e.overrideTooltips?.[2]??"Pause":e.overrideTooltips?.[1]??"Run","data-placement":"bottom",children:t.state.running?"\u23f8":"\ufe0f\u23e9"}),(0,s.jsx)("button",{className:"flex-0",onClick:()=>t.actions.reset(),"data-tooltip":e.overrideTooltips?.[3]??"Reset","data-placement":"bottom",children:"\u23ee"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,fontWeight:"normal"},children:[(0,s.jsx)("span",{style:{padding:"0.2rem"},children:"Slow"}),(0,s.jsx)("input",{type:"range",min:0,max:4,step:1,value:n,disabled:t.state.running,onChange:t=>{o(Number(t.target.value)),e.onSpeedChange?.(Number(t.target.value))},style:{width:"150px",padding:"0.2rem"},"data-tooltip":"Execution speed","data-placement":"bottom"}),(0,s.jsx)("span",{style:{padding:"0.2rem"},children:"Fast"})]}),e.children]})}},5524:(e,t,n)=>{n.d(t,{Af:()=>b,Gc:()=>u,P9:()=>v,lj:()=>o,qP:()=>h,tI:()=>w,yE:()=>a});var s=n(7239),i=n(8177),r=n(5424);const o=1,a=0;class u{name;width;state;next=[];constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.name=e,this.width=t,this.state=(0,i.w)(0,this.width).map((()=>a))}ensureWidth(e){(0,s.hu)(e<=16,`Cannot widen past 16 to ${e} bits`),this.width<e&&(this.width=e,this.state=[...this.state,...(0,i.w)(this.width,e).map((()=>a))])}connect(e){this.next.push(e),e.busVoltage=this.busVoltage}pull(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,s.hu)(t>=0&&t<this.width,`Bit out of bounds: ${this.name}@${t}`),this.state[t]=e,this.next.forEach((n=>n.pull(e,t)))}voltage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,s.hu)(e>=0&&e<this.width),this.state[e]}set busVoltage(e){for(const t of(0,i.w)(0,this.width))this.state[t]=(e&1<<t)>>t;this.next.forEach((e=>e.busVoltage=this.busVoltage))}get busVoltage(){return(0,i.w)(0,this.width).reduce(((e,t)=>e|this.state[t]<<t),0)}toggle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this.voltage(e)===a?o:a;this.pull(t,e)}}class l extends u{bus;start;width;constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e.name),this.bus=e,this.start=t,this.width=n,(0,s.hu)(t>=0&&t+n<=e.width,`Mismatched InSubBus dimensions on ${e.name} (${n} + ${t} > ${e.width})`),this.connect(e)}pull(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,s.hu)(t>=0&&t<this.width),this.bus.pull(e,this.start+t)}voltage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,s.hu)(e>=0&&e<this.width),this.bus.voltage(this.start+e)}set busVoltage(e){const t=this.bus.busVoltage&~y(this.width+this.start),n=this.bus.busVoltage&y(this.start),s=(e&y(this.width))<<this.start;this.bus.busVoltage=t|s|n}get busVoltage(){return this.bus.busVoltage>>this.start&y(this.width)}connect(e){(0,s.hu)(this.start+this.width<=e.width,`Mismatched InSubBus connection dimensions (From ${e.name} to ${this.name})`),this.bus=e}}class c extends u{bus;start;width;constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e.name),this.bus=e,this.start=t,this.width=n,(0,s.hu)(t>=0&&n<=e.width,"Mismatched OutSubBus dimensions"),this.connect(e)}set busVoltage(e){this.bus.busVoltage=(e&y(this.width+this.start))>>this.start}get busVoltage(){return this.bus.busVoltage&y(this.width)}connect(e){(0,s.hu)(this.width<=e.width,"Mismatched OutSubBus connection dimensions"),this.bus=e}}class h extends u{value;constructor(e,t){super(e,16),this.value=t}pullHigh(){}pullLow(){}voltage(){return 1&this.busVoltage}set busVoltage(e){}get busVoltage(){return this.value}}const d=new h("true",65535),m=new h("false",0);function p(e){const{pin:t,w:n}=e.match(/(?<pin>[a-zA-Z]+)(\[(?<w>\d+)\])?/)?.groups;return{pin:t,width:n?Number(n):1}}class g{map=new Map;insert(e){const{name:t}=e;(0,s.hu)(!this.map.has(t),`Pins already has ${t}!`),this.map.set(t,e)}emplace(e,t){if(this.has(e))return this.get(e);{const n=new u(e,t);return this.insert(n),n}}has(e){return this.map.has(e)}get(e){return this.map.get(e)}entries(){return this.map.values()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}let f=0;class b{name;id=f++;ins=new g;outs=new g;pins=new g;parts=new Set;clockedPins;get clocked(){if(this.clockedPins.size>0)return!0;for(const e of this.parts)if(e.clocked)return!0;return!1}constructor(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];this.name=n;for(const r of e){const{pin:e,width:t=1}=void 0!==r.pin?r:p(r);this.ins.insert(new u(e,t))}for(const r of t){const{pin:e,width:t=1}=void 0!==r.pin?r:p(r);this.outs.insert(new u(e,t))}for(const r of s){const{pin:e,width:t=1}=void 0!==r.pin?r:p(r);this.pins.insert(new u(e,t))}this.clockedPins=new Set(i),r.S.get().$.subscribe((()=>this.eval()))}reset(){for(const[e,t]of this.ins)t.busVoltage=0;for(const e of this.parts)e.reset();this.eval()}in(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"in";return(0,s.hu)(this.hasIn(e),`No in pin ${e}`),this.ins.get(e)}out(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"out";return(0,s.hu)(this.hasOut(e),`No in pin ${e}`),this.outs.get(e)}hasIn(e){return this.ins.has(e)}hasOut(e){return this.outs.has(e)}pin(e){return(0,s.hu)(this.pins.has(e)),this.pins.get(e)}get(e,t){return this.ins.has(e)?this.ins.get(e):this.outs.has(e)?this.outs.get(e):this.pins.has(e)?this.pins.get(e):this.getBuiltin(e,t)}getBuiltin(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(A.includes(e))for(const n of this.parts){const s=n.get(e,t);if(s)return s}}isOutPin(e){return this.outs.has(e)}wire(e,t){this.parts.add(e);for(const{to:n,from:s}of t)e.isOutPin(n.name)?this.wireOutPin(e,n,s):this.wireInPin(e,n,s)}findPin(e,t){return"true"===e.toLowerCase()||"1"===e?d:"false"===e.toLowerCase()||"0"===e?m:this.ins.has(e)?this.ins.get(e):this.outs.has(e)?this.outs.get(e):this.pins.emplace(e,t)}wireOutPin(e,t,n){const i=(0,s.kP)(e.outs.get(t.name),(()=>`Cannot wire to missing pin ${t.name}`));t.width??=i.width;let r=this.findPin(n.name,n.width??t.width);const o=this.pins.has(r.name);if(n.width??=r.width,r instanceof h)throw new Error("Cannot wire to constant bus");o&&r instanceof u&&r.ensureWidth(n.start+n.width),(n.start>0||n.width!==r.width)&&(r=new l(r,n.start,n.width)),(t.start>0||t.width!==r.width)&&(r=new c(r,t.start,t.width)),i.connect(r)}wireInPin(e,t,n){let i=(0,s.kP)(e.ins.get(t.name),(()=>`Cannot wire to missing pin ${t.name}`));t.width??=i.width;const r=this.findPin(n.name,n.width??t.width);n.width??=r.width,(t.start>0||t.width!==r.width)&&(i=new l(i,t.start,t.width)),["true","false"].includes(r.name)||(n.start>0||n.width!==r.width)&&(i=new c(i,n.start,n.width)),r.connect(i)}eval(){for(const e of this.parts)d.next.forEach((e=>e.busVoltage=d.busVoltage)),m.next.forEach((e=>e.busVoltage=m.busVoltage)),e.eval()}tick(){this.eval()}tock(){this.eval()}remove(){for(const e of this.parts)e.remove()}async load(e,t){for(const n of this.parts)"ROM32K"===n.name&&await n.load(e,t)}}class v extends b{constructor(){super([],[]),this.outs.insert(m)}}class w extends b{get clocked(){return!0}#e=r.S.get().$.subscribe((e=>{let{level:t}=e;t===a?this.tock():this.tick()}));remove(){this.#e.unsubscribe(),super.remove()}reset(){super.reset(),this.tick(),this.tock()}}function y(e){return Math.pow(2,e)-1}const A=["Register","ARegister","DRegister","PC","RAM8","RAM64","RAM512","RAM4K","RAM16K","ROM32K","Screen","Keyboard","Memory"]},5424:(e,t,n)=>{n.d(t,{S:()=>u});var s=n(5728),i=n(1370),r=n(7239),o=n(5524);let a;class u{level=o.yE;ticks=0;static get(){return void 0===a&&(a=new u),a}get isHigh(){return this.level===o.lj}get isLow(){return this.level===o.yE}subject=new s.X({level:this.level,ticks:this.ticks});frameSubject=new i.x;resetSubject=new i.x;$=this.subject;frame$=this.frameSubject;reset$=this.resetSubject;next(){this.subject.next({level:this.level,ticks:this.ticks})}constructor(){}reset(){this.level=o.yE,this.ticks=0,this.next(),this.resetSubject.next()}tick(){(0,r.hu)(this.level===o.yE,"Can only tick up from LOW"),this.level=o.lj,this.next()}tock(){(0,r.hu)(this.level===o.lj,"Can only tock down from HIGH"),this.level=o.yE,this.ticks+=1,this.next()}toggle(){this.level===o.lj?this.tock():this.tick()}eval(){this.tick(),this.tock()}frame(){this.frameSubject.next()}toString(){return`${this.ticks}${this.level===o.lj?"+":""}`}}},137:(e,t,n)=>{n.d(t,{Bb:()=>u,NM:()=>s,PH:()=>i,Uc:()=>r,lK:()=>o,vU:()=>a});const s={op:{42:"0",63:"1",58:"-1",12:"x",48:"y",13:"!x",49:"!y",15:"-x",51:"-y",31:"x+1",55:"y+1",14:"x-1",50:"y-1",2:"x+y",19:"x-y",7:"y-x",0:"x&y",21:"x|y"}},i={asm:{0:42,1:63,"-1":58,D:12,A:48,M:48,"!D":13,"!A":49,"-D":15,"-A":51,"D+1":31,"A+1":55,"D-1":14,"A-1":50,"D+A":2,"D-A":19,"D-M":19,"A-D":7,"D&A":0,"D&M":0,"D|A":21,"D|M":21},op:{42:"0",63:"1",58:"-1",12:"D",48:"A",13:"!D",49:"!A",15:"-D",51:"-A",31:"D+1",55:"A+1",14:"D-1",50:"A-1",2:"D+A",19:"D-A",7:"A-D",0:"D&A",21:"D|A"}},r={asm:{"":0,M:1,D:2,MD:3,A:4,AM:5,AD:6,AMD:7},op:{0:"",1:"M",2:"D",3:"MD",4:"A",5:"AM",6:"AD",7:"AMD"}},o={asm:{"":0,JGT:1,JEQ:2,JGE:3,JLT:4,JNE:5,JLE:6,JMP:7},op:{0:"",1:"JGT",2:"JEQ",3:"JGE",4:"JLT",5:"JNE",6:"JLE",7:"JMP"}},a={1:"Positive",0:"Zero",15:"Negative",Positive:1,Zero:0,Negative:15};function u(e,t,n){let s=0;switch(e){case 42:s=0;break;case 63:s=1;break;case 58:s=-1;break;case 12:s=t;break;case 48:s=n;break;case 13:s=~t;break;case 49:s=~n;break;case 15:s=-t;break;case 51:s=-n;break;case 31:s=t+1;break;case 55:s=n+1;break;case 14:s=t-1;break;case 50:s=n-1;break;case 2:s=t+n;break;case 19:s=t-n;break;case 7:s=n-t;break;case 0:s=t&n;break;case 21:s=t|n}s&=65535;return[s,0===s?a.Zero:32768&s?a.Negative:a.Positive]}},2201:(e,t,n)=>{n.d(t,{FH:()=>g,GD:()=>u,I2:()=>a,eD:()=>p,eu:()=>c,kG:()=>d,qT:()=>m,yJ:()=>l,zp:()=>h});var s=n(7239),i=n(6871),r=n(5150),o=n(9415);const a=["bin","dec","hex","asm"],u=16384,l=131072,c=24576;class h{memory;get size(){return this.memory.length}constructor(e){this.memory=new Int16Array(e)}get(e){return e<0||e>=this.size?65535:this.memory[e]??0}set(e,t){e>=0&&e<this.size&&(this.memory[e]=65535&t)}reset(){this.memory.fill(0)}update(e,t,n){let s;switch(n){case"asm":s=(0,i.op)(t);break;case"bin":s=(0,r.C$)(t);break;case"hex":s=(0,r.Af)(t);break;default:s=(0,r.o5)(t)}isFinite(s)&&s<=65535&&this.set(e,s)}async load(e,t){try{this.loadBytes(await(0,o.zD)(e,t))}catch(n){throw new Error(`Memory Failed to load file ${t}`)}}loadBytes(e){this.memory.set(new Int16Array(e)),this.memory.fill(0,e.length,this.size)}range(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size;return[...this.memory.slice(e,t)]}map(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.size;return function*(){(0,s.hu)(n<i);for(let s=n;s<i;s++)yield e(s,t.get(s))}()}}class d{parent;size;offset;constructor(e,t,n){this.parent=e,this.size=t,this.offset=n}get(e){return e<0||e>=this.size?65535:this.parent.get(this.offset+e)}set(e,t){e>=0&&e<this.size&&this.parent.set(e+this.offset,t)}reset(){for(let e=0;e<this.size;e++)this.set(e,0)}update(e,t,n){e>=0&&e<this.size&&this.parent.update(e+this.offset,t,n)}load(e,t){return this.parent.load(e,t)}loadBytes(e){return this.parent.loadBytes(e)}range(e,t){return this.parent.range(e,t)}map(e,t,n){return this.parent.map(e,t,n)}}class m extends d{constructor(e){super(e,1,24576)}getKey(){return this.get(0)}setKey(e){this.set(0,65535&e)}clearKey(){this.set(0,0)}}class p extends h{static SIZE=32768;constructor(e){const t=new Int16Array(p.SIZE);t.set(e),super(t)}}class g extends h{static SIZE=32768;constructor(){super(g.SIZE)}}},9415:(e,t,n)=>{n.d(t,{zD:()=>i});var s=n(6699);async function i(e,t){if(t.endsWith(".hack"))return async function(e,t){return s.$W(await e.readFile(t))}(e,t);if(t.endsWith(".asm"))return async function(e,t){return s.eC(await e.readFile(t))}(e,t);throw new Error(`Cannot load file without hack or asm extension ${t}`)}},7472:(e,t,n)=>{n.d(t,{Ww:()=>f,$o:()=>p,w_:()=>d,Y_:()=>g});var s=n(7239),i=n(9814),r=n(137),o=n(2201),a=n(6871),u=n(3484);const l='\nASM <: Base {\n  Root := ASM\n  ASM = Instruction*\n  \n  Instruction = Label|AInstruction|CInstruction\n  \n  Label = OpenParen identifier closeParen\n  AInstruction = at (identifier | decNumber)\n  CInstruction = assign? op jmp?\n  \n  assign = (\n      "AMD"\n      | "AM"\n      | "AD"\n      | "MD"\n      | "M"\n      | "D"\n      | "A"\n      ) equal\n      \n  op =\n      | "0" | "1" | "-1"\n      | "!D" | "!A" | "!M"\n      | "-D" | "-A" | "-M"\n      | "D+1" | "A+1" | "M+1"\n      | "D-1" | "A-1" | "M-1"\n      | "D+A" | "D+M"\n      | "D-A" | "D-M"\n      | "A-D" | "M-D"\n      | "D&A" | "D&M"\n      | "D|A" | "D|M"\n      | "D" | "A" | "M"\n\n\n  jmp = semi ("JGT" | "JEQ" | "JGE" | "JLT" | "JNE" | "JLE" | "JMP")\n}',c=i.Z.grammar(l,u.y1),h=c.extendSemantics(u.rJ);function d(e){return void 0!==e.value}function m(e){return void 0!==e.label}function p(e,t){let n=16;const i=new Map([["R0",0],["R1",1],["R2",2],["R3",3],["R4",4],["R5",5],["R6",6],["R7",7],["R8",8],["R9",9],["R10",10],["R11",11],["R12",12],["R13",13],["R14",14],["R15",15],["SP",0],["LCL",1],["ARG",2],["THIS",3],["THAT",4],["SCREEN",o.GD],["KBD",o.eu]]);const r=[];let a=0;for(const s of e.instructions)if("L"!==s.type)a+=1,"A"===s.type&&m(s)&&r.push(s);else{if(i.has(s.label))throw new Error(`ASM Duplicate label ${s.label}`);i.set(s.label,a),t?.(s.label,a,!1)}r.forEach((function(e){const r=(o=e.label,i.has(o)||(i.set(o,n),t?.(o,n,!0),n+=1),(0,s.kP)(i.get(o),`Label not in symbols: ${o}`));var o;e.value=r,delete e.label}))}function g(e){if("A"===e.type){if(m(e))throw new Error("ASM Emitting unfilled A instruction");return e.value}if("C"===e.type)return(0,a.p)(e.isM,e.op,e.store,e.jump)}h.addAttribute("root",{Root(e){return this.asm}}),h.addAttribute("asm",{Root:e=>({instructions:e.child(0).children.map((e=>{let{instruction:t}=e;return t}))})}),h.addAttribute("instruction",{AInstruction(e,t){try{return{type:"A",label:t.name,span:{start:e.source.startIdx,end:t.source.endIdx},lineNum:e.source.getLineAndColumn().lineNum}}catch(n){}try{return{type:"A",value:t.value,span:{start:e.source.startIdx,end:t.source.endIdx},lineNum:e.source.getLineAndColumn().lineNum}}catch(n){}throw new Error("AsmAInstruction must have either a name or a value")},CInstruction(e,t,n){const s=e.child(0)?.child(0)?.sourceString,i=t.sourceString.replace("M","A"),o=n.child(0)?.child(1)?.sourceString,a=t.sourceString.includes("M"),u={type:"C",op:r.PH.asm[i],isM:a,span:{start:e.source.startIdx,end:n.source.endIdx},lineNum:e.source.getLineAndColumn().lineNum};return o&&(u.jump=r.lK.asm[o]),s&&(u.store=r.Uc.asm[s]),u},Label(e,t,n){let{name:s}=t;return{type:"L",label:s,lineNum:e.source.getLineAndColumn().lineNum}}});const f={grammar:l,semantics:h,parser:c,parse:(0,u.Pz)(c,h),passes:{fillLabel:p,emit:function(e){return e.instructions.map(g).filter((e=>void 0!==e))}}}},3484:(e,t,n)=>{n.d(t,{eP:()=>o,rJ:()=>u,y1:()=>a,Pz:()=>l});var s=n(9814),i=n(5150),r=n(7054);const o="Unknown parse error",a={Base:s.Z.grammar('\nBase {\n  Root = Value*\n\n  At = at\n  Bang = bang\n  Bar = bar\n  CloseAngle = closeAngle\n  CloseBrace = closeBrace\n  CloseParen = closeParen\n  CloseSquare = closeSquare\n  Comma = comma\n  Dollar = dollar\n  Dot = dot\n  DoubleQuote = doubleQuote\n  Equal = equal\n  OpenAngle = openAngle\n  OpenBrace = openBrace\n  OpenParen = openParen\n  OpenSquare = openSquare\n  Percent = percent\n  Semi = semi\n  Underscore = underscore\n\n  at = "@"\n  bang = "!"\n  bar = "|"\n  closeAngle = ">"\n  closeBrace = "}"\n  closeParen = ")"\n  closeSquare = "]"\n  comma = ","\n  dollar = "$"\n  dot = "."\n  doubleQuote = "\\""\n  equal = "="\n  minus = "-"\n  newline = "\\r"? "\\n"\n  openAngle = "<"\n  openBrace = "{"\n  openParen = "("\n  openSquare = "["\n  percent = "%"\n  semi = ";"\n  underscore = "_"\n\n  Value = identifier | number | boolean\n\n  boolean = true | false\n  True = true\n  False = false\n  true = "true"\n  false = "false"\n\n  Name = identifier\n  identifier = (letter|underscore) (alnum|underscore|dot|dollar)*\n\n  Number = number\n  number = hexNumber | decNumber | binNumber\n  binNumber = ("%B") ("0"|"1")+\n  hexNumber = ("%X") hexDigit+\n  decNumber = ("%D")? (wholeDec | realDec)\n  wholeDec = minus? digit+\n  realDec = minus? digit* "." digit+\n\n  String = DoubleQuote (~doubleQuote any)* doubleQuote\n  \n  spaces := (lineComment | comment | space)*\n  commentStart = "/*"\n  commentEnd = "*/"\n  comment = commentStart (~commentEnd any)* commentEnd\n  lineCommentStart = "//"\n  lineComment = lineCommentStart (~"\\n" any)* "\\n"\n\n  List<elem, sep> = NonemptyListOf<elem, sep> sep?\n  EmptyList<elem, sep> = EmptyList<elem, sep> sep?\n}')},u=a.Base.createSemantics();function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>{let{root:t}=e;return t};return function(s){try{const i=e.match(s);if(i.succeeded()){const e=t(i),s=n(e);return(0,r.Ok)(s)}return(0,r.UG)({message:i.message??o,shortMessage:i.shortMessage??o})}catch(i){return(0,r.UG)(i)}}}u.extendOperation("asIteration",{List:(e,t)=>e.asIteration()}),u.addAttribute("value",{decNumber:(e,t)=>(0,i.o5)(t.sourceString),wholeDec:(e,t)=>(0,i.o5)(t.sourceString),binNumber:(e,t)=>(0,i.C$)(t.sourceString),hexNumber:(e,t)=>(0,i.Af)(t.sourceString),Number:e=>e.value,Name:e=>e.name,identifier(e,t){return this.sourceString}}),u.addAttribute("name",{identifier(e,t){return this.sourceString},Name(e){return this.child(0)?.name}}),u.addAttribute("String",{String:(e,t,n)=>t.sourceString})},6699:(e,t,n)=>{n.d(t,{$W:()=>a,eC:()=>o,uC:()=>u});var s=n(7054),i=n(7472),r=n(5150);async function o(e){const t=(0,s.Wg)(i.Ww.parse(e));return i.Ww.passes.fillLabel(t),i.Ww.passes.emit(t)}async function a(e){return e.split("\n").filter((e=>""!==e.trim())).map(r.C$)}async function u(e){return e.split("\n").filter((e=>""!==e.trim())).map(r.t1)}},4619:(e,t,n)=>{n.d(t,{B:()=>i});const s=n(5424).S.get();class i{frame(){this.tick(),this.finishFrame()}finishFrame(){s.frame()}steps=1;speed=1e3;get running(){return this.#t}#t=!1;#n=0;#s=0;#i=async()=>{if(!this.#t)return;const e=Date.now(),t=e-this.#s;if(this.#s=e,this.#n+=t,this.#n>this.speed){let e=!1,t=this.steps;const n=`Timing ${t} steps`;for(console.time(n);!e&&t--;)e=await this.tick();console.timeEnd(n),this.finishFrame(),e&&this.stop(),this.#n-=this.speed}requestAnimationFrame(this.#i)};start(){this.#t=!0,this.#s=Date.now()-this.speed,this.#i(),this.toggle()}stop(){this.#t=!1,this.toggle()}}},6871:(e,t,n)=>{n.d(t,{a:()=>i,op:()=>r,p:()=>o});var s=n(137);function i(e){return 32768&e?function(e){e&=65535;const t=(4096&e)>>12,n=(4032&e)>>6,i=(56&e)>>3,r=7&e;if(void 0===s.PH.op[n])return"#ERR";let o=s.PH.op[n];t&&(o=o.replace(/A/g,"M"));const a=s.Uc.op[i],u=s.lK.op[r];let l=o;a&&(l=`${a}=${l}`);u&&(l=`${l};${u}`);return l}(e):function(e){return"@"+(32767&e).toString(10)}(e)}function r(e){return"@"===e[0]?function(e){return parseInt(e.substring(1),10)}(e):function(e){const t=e.match(/(?:(?<assign>[AMD]{1,3})=)?(?<operation>[-!01ADM&|]{1,3})(?:;(?<jump>JGT|JLT|JGE|JLE|JEQ|JMP))?/),{assign:n,operation:i,jump:r}=t?.groups??{},a=i.includes("M")||n.includes("M"),u=s.Uc.asm[n??""],l=s.lK.asm[r??""],c=s.PH.asm[i??""];return o(a,c,u,l)}(e)}function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=57344,r=e?4096:0,o=t<<6,a=(n??0)<<3,u=s??0;return i+r+o+a+u}},5150:(e,t,n)=>{n.d(t,{$v:()=>h,Af:()=>a,C$:()=>l,C2:()=>g,E_:()=>m,Ly:()=>d,nN:()=>p,o5:()=>u,t1:()=>c});const s=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];function i(e){return s[e]??"X"}function r(e){switch(e){case 0:return"0000";case 1:return"0001";case 2:return"0010";case 3:return"0011";case 4:return"0100";case 5:return"0101";case 6:return"0110";case 7:return"0111";case 8:return"1000";case 9:return"1001";case 10:return"1010";case 11:return"1011";case 12:return"1100";case 13:return"1101";case 14:return"1110";case 15:return"1111";default:return"erro"}}function o(e,t){return 65535&parseInt(e.replace(/[^\d a-f A-F +-.]/g,""),t)}function a(e){return o(e,16)}function u(e){return o(e,10)}function l(e){return o(e.replaceAll(" ",""),2)}function c(e){return e.toUpperCase().includes("X")?a(e):u(e)}function h(e){return`0x${i((61440&e)>>12)}${i((3840&e)>>8)}${i((240&e)>>4)}${i(15&e)}`}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;const n=r((61440&e)>>12),s=r((3840&e)>>8),i=r((240&e)>>4),o=r(15&e);return`${n}${s}${i}${o}`.substring(16-t)}function m(e){return 32768===(e&=65535)?"-32768":32768&e?`-${e=1+~e&32767}`:`${e}`}function p(e){return`${e&=65535}`}function g(e,t){let n=~((e&=65535)&(t&=65535));return n&=65535,n}}}]);