"use strict";(globalThis.webpackChunk_nand2tetris_web=globalThis.webpackChunk_nand2tetris_web||[]).push([[548],{3263:(t,e,r)=>{r.d(e,{jM:()=>$});var n=Symbol.for("immer-nothing"),i=Symbol.for("immer-draftable"),s=Symbol.for("immer-state");function o(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var a=Object.getPrototypeOf;function c(t){return!!t&&!!t[s]}function u(t){return!!t&&(p(t)||Array.isArray(t)||!!t[i]||!!t.constructor?.[i]||g(t)||v(t))}var l=Object.prototype.constructor.toString();function p(t){if(!t||"object"!==typeof t)return!1;const e=a(t);if(null===e)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===l}function h(t,e){0===m(t)?Reflect.ownKeys(t).forEach((r=>{e(r,t[r],t)})):t.forEach(((r,n)=>e(n,r,t)))}function m(t){const e=t[s];return e?e.type_:Array.isArray(t)?1:g(t)?2:v(t)?3:0}function d(t,e){return 2===m(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function f(t,e,r){const n=m(t);2===n?t.set(e,r):3===n?t.add(r):t[e]=r}function g(t){return t instanceof Map}function v(t){return t instanceof Set}function y(t){return t.copy_||t.base_}function I(t,e){if(g(t))return new Map(t);if(v(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=p(t);if(!0===e||"class_only"===e&&!r){const e=Object.getOwnPropertyDescriptors(t);delete e[s];let r=Reflect.ownKeys(e);for(let n=0;n<r.length;n++){const i=r[n],s=e[i];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(e[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:t[i]})}return Object.create(a(t),e)}{const e=a(t);if(null!==e&&r)return{...t};const n=Object.create(e);return Object.assign(n,t)}}function x(t,e=!1){return S(t)||c(t)||!u(t)||(m(t)>1&&(t.set=t.add=t.clear=t.delete=_),Object.freeze(t),e&&Object.entries(t).forEach((([t,e])=>x(e,!0)))),t}function _(){o(2)}function S(t){return Object.isFrozen(t)}var b,w={};function A(t){const e=w[t];return e||o(0),e}function O(){return b}function N(t,e){e&&(A("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function L(t){R(t),t.drafts_.forEach(F),t.drafts_=null}function R(t){t===b&&(b=t.parent_)}function P(t){return b={drafts_:[],parent_:b,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function F(t){const e=t[s];0===e.type_||1===e.type_?e.revoke_():e.revoked_=!0}function E(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return void 0!==t&&t!==r?(r[s].modified_&&(L(e),o(4)),u(t)&&(t=C(e,t),e.parent_||D(e,t)),e.patches_&&A("Patches").generateReplacementPatches_(r[s].base_,t,e.patches_,e.inversePatches_)):t=C(e,r,[]),L(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==n?t:void 0}function C(t,e,r){if(S(e))return e;const n=e[s];if(!n)return h(e,((i,s)=>k(t,n,e,i,s,r))),e;if(n.scope_!==t)return e;if(!n.modified_)return D(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const e=n.copy_;let i=e,s=!1;3===n.type_&&(i=new Set(e),e.clear(),s=!0),h(i,((i,o)=>k(t,n,e,i,o,r,s))),D(t,e,!1),r&&t.patches_&&A("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function k(t,e,r,n,i,s,o){if(c(i)){const o=C(t,i,s&&e&&3!==e.type_&&!d(e.assigned_,n)?s.concat(n):void 0);if(f(r,n,o),!c(o))return;t.canAutoFreeze_=!1}else o&&r.add(i);if(u(i)&&!S(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;C(t,i),e&&e.scope_.parent_||"symbol"===typeof n||!Object.prototype.propertyIsEnumerable.call(r,n)||D(t,i)}}function D(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&x(e,r)}var T={get(t,e){if(e===s)return t;const r=y(t);if(!d(r,e))return function(t,e,r){const n=G(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}(t,r,e);const n=r[e];return t.finalized_||!u(n)?n:n===M(t.base_,e)?(q(t),t.copy_[e]=z(n,t)):n},has:(t,e)=>e in y(t),ownKeys:t=>Reflect.ownKeys(y(t)),set(t,e,r){const n=G(y(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const n=M(y(t),e),a=n?.[s];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(((i=r)===(o=n)?0!==i||1/i===1/o:i!==i&&o!==o)&&(void 0!==r||d(t.base_,e)))return!0;q(t),B(t)}var i,o;return t.copy_[e]===r&&(void 0!==r||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty:(t,e)=>(void 0!==M(t.base_,e)||e in t.base_?(t.assigned_[e]=!1,q(t),B(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0),getOwnPropertyDescriptor(t,e){const r=y(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n?{writable:!0,configurable:1!==t.type_||"length"!==e,enumerable:n.enumerable,value:r[e]}:n},defineProperty(){o(11)},getPrototypeOf:t=>a(t.base_),setPrototypeOf(){o(12)}},j={};function M(t,e){const r=t[s];return(r?y(r):t)[e]}function G(t,e){if(!(e in t))return;let r=a(t);for(;r;){const t=Object.getOwnPropertyDescriptor(r,e);if(t)return t;r=a(r)}}function B(t){t.modified_||(t.modified_=!0,t.parent_&&B(t.parent_))}function q(t){t.copy_||(t.copy_=I(t.base_,t.scope_.immer_.useStrictShallowCopy_))}h(T,((t,e)=>{j[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}})),j.deleteProperty=function(t,e){return j.set.call(this,t,e,void 0)},j.set=function(t,e,r){return T.set.call(this,t[0],e,r,t[0])};function z(t,e){const r=g(t)?A("MapSet").proxyMap_(t,e):v(t)?A("MapSet").proxySet_(t,e):function(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:O(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=T;r&&(i=[n],s=j);const{revoke:o,proxy:a}=Proxy.revocable(i,s);return n.draft_=a,n.revoke_=o,a}(t,e);return(e?e.scope_:O()).drafts_.push(r),r}function U(t){if(!u(t)||S(t))return t;const e=t[s];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=I(t,e.scope_.immer_.useStrictShallowCopy_)}else r=I(t,!0);return h(r,((t,e)=>{f(r,t,U(e))})),e&&(e.finalized_=!1),r}var K=new class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,e,r)=>{if("function"===typeof t&&"function"!==typeof e){const r=e;e=t;const n=this;return function(t=r,...i){return n.produce(t,(t=>e.call(this,t,...i)))}}let i;if("function"!==typeof e&&o(6),void 0!==r&&"function"!==typeof r&&o(7),u(t)){const n=P(this),s=z(t,void 0);let o=!0;try{i=e(s),o=!1}finally{o?L(n):R(n)}return N(n,r),E(i,n)}if(!t||"object"!==typeof t){if(i=e(t),void 0===i&&(i=t),i===n&&(i=void 0),this.autoFreeze_&&x(i,!0),r){const e=[],n=[];A("Patches").generateReplacementPatches_(t,i,e,n),r(e,n)}return i}o(1)},this.produceWithPatches=(t,e)=>{if("function"===typeof t)return(e,...r)=>this.produceWithPatches(e,(e=>t(e,...r)));let r,n;return[this.produce(t,e,((t,e)=>{r=t,n=e})),r,n]},"boolean"===typeof t?.autoFreeze&&this.setAutoFreeze(t.autoFreeze),"boolean"===typeof t?.useStrictShallowCopy&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){u(t)||o(8),c(t)&&(t=function(t){c(t)||o(10);return U(t)}(t));const e=P(this),r=z(t,void 0);return r[s].isManual_=!0,R(e),r}finishDraft(t,e){const r=t&&t[s];r&&r.isManual_||o(9);const{scope_:n}=r;return N(n,e),E(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const n=e[r];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}r>-1&&(e=e.slice(r+1));const n=A("Patches").applyPatches_;return c(t)?n(t,e):this.produce(t,(t=>n(t,e)))}},$=K.produce;K.produceWithPatches.bind(K),K.setAutoFreeze.bind(K),K.setUseStrictShallowCopy.bind(K),K.applyPatches.bind(K),K.createDraft.bind(K),K.finishDraft.bind(K)},5874:(t,e,r)=>{r.d(e,{HQ:()=>i,Ok:()=>o,_:()=>a,oA:()=>c,ys:()=>s});const n=t=>null===t;const i=t=>Object.prototype.hasOwnProperty.call(t??{},"ok"),s=t=>Object.prototype.hasOwnProperty.call(t,"err");function o(t){return i(t)?t.ok:{ok:t,map(t){return t(o(this))}}}function a(t){return t.err??{err:t,map(t){return this}}}function c(t){if(n(t))throw new Error("Attempted to unwrap None");if(s(t))throw a(t);return i(t)?o(t):t}},9563:(t,e,r)=>{r.d(e,{qN:()=>oe});var n={};r.r(n),r.d(n,{CV:()=>f,b0:()=>s,vA:()=>o,Ms:()=>p,xA:()=>a,$L:()=>l,pX:()=>m,lO:()=>h,Ho:()=>d,ux:()=>u,repeatStr:()=>c,qj:()=>v,rE:()=>y});const i={};for(let ae=0;ae<128;ae++)i[ae]=String.fromCharCode(ae);function s(t){const e=t||"";return function(){throw new Error("this method "+e+" is abstract! (it has no implementation in class "+this.constructor.name+")")}}function o(t,e){if(!t)throw new Error(e||"Assertion failed")}function a(t,e,r){let n;Object.defineProperty(t,e,{get(){return n||(n=r.call(this)),n}})}function c(t,e){return new Array(e+1).join(t)}function u(t,e){return function(t,e){const r=[];for(;e-- >0;)r.push(t());return r}((()=>t),e)}function l(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r];t.lastIndexOf(n)!==r&&e.indexOf(n)<0&&e.push(n)}return e}function p(t){const e=[];return t.forEach((t=>{e.indexOf(t)<0&&e.push(t)})),e}function h(t){const e=t[0];return e===e.toUpperCase()}function m(t){return!h(t)}function d(t,e,r){const n=r||" ";return t.length<e?c(n,e-t.length)+t:t}function f(){this.strings=[]}i["'".charCodeAt(0)]="\\'",i['"'.charCodeAt(0)]='\\"',i["\\".charCodeAt(0)]="\\\\",i["\b".charCodeAt(0)]="\\b",i["\f".charCodeAt(0)]="\\f",i["\n".charCodeAt(0)]="\\n",i["\r".charCodeAt(0)]="\\r",i["\t".charCodeAt(0)]="\\t",i["\v".charCodeAt(0)]="\\v",f.prototype.append=function(t){this.strings.push(t)},f.prototype.contents=function(){return this.strings.join("")};const g=t=>String.fromCodePoint(parseInt(t,16));function v(t){if("\\"!==t.charAt(0))return t;switch(t.charAt(1)){case"b":return"\b";case"f":return"\f";case"n":return"\n";case"r":return"\r";case"t":return"\t";case"v":return"\v";case"x":return g(t.slice(2,4));case"u":return"{"===t.charAt(2)?g(t.slice(3,-1)):g(t.slice(2,6));default:return t.charAt(1)}}function y(t){if(null==t)return String(t);const e=Object.prototype.toString.call(t);try{let r;return r=t.constructor&&t.constructor.name?t.constructor.name:0===e.indexOf("[object ")?e.slice(8,-1):typeof t,r+": "+JSON.stringify(String(t))}catch(r){return e}}const I={Lu:/\p{Lu}/u,Ll:/\p{Ll}/u,Lt:/\p{Lt}/u,Lm:/\p{Lm}/u,Lo:/\p{Lo}/u,Nl:/\p{Nl}/u,Nd:/\p{Nd}/u,Mn:/\p{Mn}/u,Mc:/\p{Mc}/u,Pc:/\p{Pc}/u,Zs:/\p{Zs}/u,L:/\p{Letter}/u,Ltmo:/\p{Lt}|\p{Lm}|\p{Lo}/u};class x{constructor(){if(this.constructor===x)throw new Error("PExpr cannot be instantiated -- it's abstract")}withSource(t){return t&&(this.source=t.trimmed()),this}}const _=Object.create(x.prototype),S=Object.create(x.prototype);class b extends x{constructor(t){super(),this.obj=t}}class w extends x{constructor(t,e){super(),this.from=t,this.to=e,this.matchCodePoint=t.length>1||e.length>1}}class A extends x{constructor(t){super(),this.index=t}}class O extends x{constructor(t){super(),this.terms=t}}class N extends O{constructor(t,e,r){super([r,t.rules[e].body]),this.superGrammar=t,this.name=e,this.body=r}}class L extends O{constructor(t,e,r,n){const i=t.rules[e].body;super([...r,i,...n]),this.superGrammar=t,this.ruleName=e,this.expansionPos=r.length}}class R extends x{constructor(t){super(),this.factors=t}}class P extends x{constructor(t){super(),this.expr=t}}class F extends P{}class E extends P{}class C extends P{}F.prototype.operator="*",E.prototype.operator="+",C.prototype.operator="?",F.prototype.minNumMatches=0,E.prototype.minNumMatches=1,C.prototype.minNumMatches=0,F.prototype.maxNumMatches=Number.POSITIVE_INFINITY,E.prototype.maxNumMatches=Number.POSITIVE_INFINITY,C.prototype.maxNumMatches=1;class k extends x{constructor(t){super(),this.expr=t}}class D extends x{constructor(t){super(),this.expr=t}}class T extends x{constructor(t){super(),this.expr=t}}class j extends x{constructor(t,e=[]){super(),this.ruleName=t,this.args=e}isSyntactic(){return h(this.ruleName)}toMemoKey(){return this._memoKey||Object.defineProperty(this,"_memoKey",{value:this.toString()}),this._memoKey}}class M extends x{constructor(t){super(),this.category=t,this.pattern=I[t]}}function G(t,e){let r;return e?(r=new Error(e.getLineAndColumnMessage()+t),r.shortMessage=t,r.interval=e):r=new Error(t),r}function B(){return G("Interval sources don't match")}function q(t,e,r){return G("Rule "+t+" is not declared in grammar "+e,r)}function z(t,e,r,n){let i="Duplicate declaration for rule '"+t+"' in grammar '"+e+"'";return e!==r&&(i+=" (originally declared in '"+r+"')"),G(i,n)}function U(t,e,r,n){return G("Wrong number of parameters for rule "+t+" (expected "+e+", got "+r+")",n)}function K(t,e,r){return G("Duplicate parameter names in rule "+t+": "+e.join(", "),r)}function $(t,e){return G("Incorrect argument type: expected "+t,e.source)}function H(t,e){const r=e.length>0?e[e.length-1].args:[];let n="Nullable expression "+t.expr.substituteParams(r)+" is not allowed inside '"+t.operator+"' (possible infinite loop)";if(e.length>0){n+="\nApplication stack (most recent application last):\n"+e.map((t=>new j(t.ruleName,t.args))).join("\n")}return G(n,t.expr.source)}function V(t,e,r,n){return G("Rule "+t+" involves an alternation which has inconsistent arity (expected "+e+", got "+r+")",n.source)}function W(t){if(1===t.length)throw t[0];if(t.length>1)throw function(t){const e=t.map((t=>t.message));return G(["Errors:"].concat(e).join("\n- "),t[0].interval)}(t)}function J(t,e,r){const n=t.length;return(t.slice(0,r)+e+t.slice(r+e.length)).substr(0,n)}function Q(...t){const e=this,{offset:r}=e,{repeatStr:i}=n,s=new f;s.append("Line "+e.lineNum+", col "+e.colNum+":\n");const a=function(t){let e=0;return t.map((t=>{const r=t.toString();return e=Math.max(e,r.length),r})).map((t=>d(t,e)))}([null==e.prevLine?0:e.lineNum-1,e.lineNum,null==e.nextLine?0:e.lineNum+1]),c=(t,e,r)=>{s.append(r+a[t]+" | "+e+"\n")};null!=e.prevLine&&c(0,e.prevLine,"  "),c(1,e.line,"> ");const u=e.line.length;let l=i(" ",u+1);for(let n=0;n<t.length;++n){let s=t[n][0],a=t[n][1];o(s>=0&&s<=a,"range start must be >= 0 and <= end");const c=r-e.colNum+1;s=Math.max(0,s-c),a=Math.min(a-c,u),l=J(l,i("~",a-s),s)}const p=2+a[1].length+3;return s.append(i(" ",p)),l=J(l,"^",e.colNum-1),s.append(l.replace(/ +$/,"")+"\n"),null!=e.nextLine&&c(2,e.nextLine,"  "),s.contents()}let Z=[];function X(t){Z.push(t)}function Y(t,e){let r=1,n=1,i=0,s=0,o=null,a=null,c=-1;for(;i<e;){const e=t.charAt(i++);"\n"===e?(r++,n=1,c=s,s=i):"\r"!==e&&n++}let u=t.indexOf("\n",s);if(-1===u)u=t.length;else{const e=t.indexOf("\n",u+1);o=-1===e?t.slice(u):t.slice(u,e),o=o.replace(/^\r?\n/,"").replace(/\r$/,"")}c>=0&&(a=t.slice(c,s).replace(/\r?\n$/,""));return{offset:e,lineNum:r,colNum:n,line:t.slice(s,u).replace(/\r$/,""),prevLine:a,nextLine:o,toString:Q}}function tt(t,e,...r){return Y(t,e).toString(...r)}const et=(()=>{let t=0;return e=>""+e+t++})();class rt{constructor(t,e,r){this.sourceString=t,this.startIdx=e,this.endIdx=r}get contents(){return void 0===this._contents&&(this._contents=this.sourceString.slice(this.startIdx,this.endIdx)),this._contents}get length(){return this.endIdx-this.startIdx}coverageWith(...t){return rt.coverage(...t,this)}collapsedLeft(){return new rt(this.sourceString,this.startIdx,this.startIdx)}collapsedRight(){return new rt(this.sourceString,this.endIdx,this.endIdx)}getLineAndColumn(){return Y(this.sourceString,this.startIdx)}getLineAndColumnMessage(){const t=[this.startIdx,this.endIdx];return tt(this.sourceString,this.startIdx,t)}minus(t){if(this.sourceString!==t.sourceString)throw B();return this.startIdx===t.startIdx&&this.endIdx===t.endIdx?[]:this.startIdx<t.startIdx&&t.endIdx<this.endIdx?[new rt(this.sourceString,this.startIdx,t.startIdx),new rt(this.sourceString,t.endIdx,this.endIdx)]:this.startIdx<t.endIdx&&t.endIdx<this.endIdx?[new rt(this.sourceString,t.endIdx,this.endIdx)]:this.startIdx<t.startIdx&&t.startIdx<this.endIdx?[new rt(this.sourceString,this.startIdx,t.startIdx)]:[this]}relativeTo(t){if(this.sourceString!==t.sourceString)throw B();return o(this.startIdx>=t.startIdx&&this.endIdx<=t.endIdx,"other interval does not cover this one"),new rt(this.sourceString,this.startIdx-t.startIdx,this.endIdx-t.startIdx)}trimmed(){const{contents:t}=this,e=this.startIdx+t.match(/^\s*/)[0].length,r=this.endIdx-t.match(/\s*$/)[0].length;return new rt(this.sourceString,e,r)}subInterval(t,e){const r=this.startIdx+t;return new rt(this.sourceString,r,r+e)}}rt.coverage=function(t,...e){let{startIdx:r,endIdx:n}=t;for(const i of e){if(i.sourceString!==t.sourceString)throw B();r=Math.min(r,i.startIdx),n=Math.max(n,i.endIdx)}return new rt(t.sourceString,r,n)};class nt{constructor(t){this.source=t,this.pos=0,this.examinedLength=0}atEnd(){const t=this.pos>=this.source.length;return this.examinedLength=Math.max(this.examinedLength,this.pos+1),t}next(){const t=this.source[this.pos++];return this.examinedLength=Math.max(this.examinedLength,this.pos),t}nextCharCode(){const t=this.next();return t&&t.charCodeAt(0)}nextCodePoint(){const t=this.source.slice(this.pos++).codePointAt(0);return t>65535&&(this.pos+=1),this.examinedLength=Math.max(this.examinedLength,this.pos),t}matchString(t,e){let r;if(e){for(r=0;r<t.length;r++){const e=this.next(),n=t[r];if(null==e||e.toUpperCase()!==n.toUpperCase())return!1}return!0}for(r=0;r<t.length;r++)if(this.next()!==t[r])return!1;return!0}sourceSlice(t,e){return this.source.slice(t,e)}interval(t,e){return new rt(this.source,t,e||this.pos)}}class it{constructor(t,e,r,n,i,s,o){this.matcher=t,this.input=e,this.startExpr=r,this._cst=n,this._cstOffset=i,this._rightmostFailurePosition=s,this._rightmostFailures=o,this.failed()&&(a(this,"message",(function(){const t="Expected "+this.getExpectedText();return tt(this.input,this.getRightmostFailurePosition())+t})),a(this,"shortMessage",(function(){const t="expected "+this.getExpectedText(),e=Y(this.input,this.getRightmostFailurePosition());return"Line "+e.lineNum+", col "+e.colNum+": "+t})))}succeeded(){return!!this._cst}failed(){return!this.succeeded()}getRightmostFailurePosition(){return this._rightmostFailurePosition}getRightmostFailures(){if(!this._rightmostFailures){this.matcher.setInput(this.input);const t=this.matcher._match(this.startExpr,{tracing:!1,positionToRecordFailures:this.getRightmostFailurePosition()});this._rightmostFailures=t.getRightmostFailures()}return this._rightmostFailures}toString(){return this.succeeded()?"[match succeeded]":"[match failed at position "+this.getRightmostFailurePosition()+"]"}getExpectedText(){if(this.succeeded())throw new Error("cannot get expected text of a successful MatchResult");const t=new f;let e=this.getRightmostFailures();e=e.filter((t=>!t.isFluffy()));for(let r=0;r<e.length;r++)r>0&&(r===e.length-1?t.append(e.length>2?", or ":" or "):t.append(", ")),t.append(e[r].toString());return t.contents()}getInterval(){const t=this.getRightmostFailurePosition();return new rt(this.input,t,t)}}class st{constructor(){this.applicationMemoKeyStack=[],this.memo={},this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,this.currentLeftRecursion=void 0}isActive(t){return this.applicationMemoKeyStack.indexOf(t.toMemoKey())>=0}enter(t){this.applicationMemoKeyStack.push(t.toMemoKey())}exit(){this.applicationMemoKeyStack.pop()}startLeftRecursion(t,e){e.isLeftRecursion=!0,e.headApplication=t,e.nextLeftRecursion=this.currentLeftRecursion,this.currentLeftRecursion=e;const{applicationMemoKeyStack:r}=this,n=r.indexOf(t.toMemoKey())+1,i=r.slice(n);e.isInvolved=function(t){return i.indexOf(t)>=0},e.updateInvolvedApplicationMemoKeys=function(){for(let t=n;t<r.length;t++){const e=r[t];this.isInvolved(e)||i.push(e)}}}endLeftRecursion(){this.currentLeftRecursion=this.currentLeftRecursion.nextLeftRecursion}shouldUseMemoizedResult(t){if(!t.isLeftRecursion)return!0;const{applicationMemoKeyStack:e}=this;for(let r=0;r<e.length;r++){const n=e[r];if(t.isInvolved(n))return!1}return!0}memoize(t,e){return this.memo[t]=e,this.maxExaminedLength=Math.max(this.maxExaminedLength,e.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,e.rightmostFailureOffset),e}clearObsoleteEntries(t,e){if(t+this.maxExaminedLength<=e)return;const{memo:r}=this;this.maxExaminedLength=0,this.maxRightmostFailureOffset=-1,Object.keys(r).forEach((n=>{const i=r[n];t+i.examinedLength>e?delete r[n]:(this.maxExaminedLength=Math.max(this.maxExaminedLength,i.examinedLength),this.maxRightmostFailureOffset=Math.max(this.maxRightmostFailureOffset,i.rightmostFailureOffset))}))}}const ot="\u22c5",at="\u2409",ct="\u240a",ut="\u240d",lt={succeeded:1,isRootNode:2,isImplicitSpaces:4,isMemoized:8,isHeadOfLeftRecursion:16,terminatesLR:32};function pt(t){return"string"===typeof t?t.replace(/ /g,ot).replace(/\t/g,at).replace(/\n/g,ct).replace(/\r/g,ut):String(t)}class ht{constructor(t,e,r,n,i,s,o){this.input=t,this.pos=this.pos1=e,this.pos2=r,this.source=new rt(t,e,r),this.expr=n,this.bindings=s,this.children=o||[],this.terminatingLREntry=null,this._flags=i?lt.succeeded:0}get displayString(){return this.expr.toDisplayString()}clone(){return this.cloneWithExpr(this.expr)}cloneWithExpr(t){const e=new ht(this.input,this.pos,this.pos2,t,this.succeeded,this.bindings,this.children);return e.isHeadOfLeftRecursion=this.isHeadOfLeftRecursion,e.isImplicitSpaces=this.isImplicitSpaces,e.isMemoized=this.isMemoized,e.isRootNode=this.isRootNode,e.terminatesLR=this.terminatesLR,e.terminatingLREntry=this.terminatingLREntry,e}recordLRTermination(t,e){this.terminatingLREntry=new ht(this.input,this.pos,this.pos2,this.expr,!1,[e],[t]),this.terminatingLREntry.terminatesLR=!0}walk(t,e){let r=t;function n(t,i,s){let o=!0;r.enter&&r.enter.call(e,t,i,s)===ht.prototype.SKIP&&(o=!1),o&&(t.children.forEach((e=>{n(e,t,s+1)})),r.exit&&r.exit.call(e,t,i,s))}"function"===typeof r&&(r={enter:r}),this.isRootNode?this.children.forEach((t=>{n(t,null,0)})):n(this,null,0)}toString(){const t=new f;return this.walk(((e,r,n)=>{if(!e)return this.SKIP;if("Alt"!==e.expr.constructor.name){if(t.append(function(t,e,r){const n=pt(t.slice(e,e+r));return n.length<r?n+u(" ",r-n.length).join(""):n}(e.input,e.pos,10)+u(" ",2*n+1).join("")),t.append((e.succeeded?"\u2713":"\u2717")+" "+e.displayString),e.isHeadOfLeftRecursion&&t.append(" (LR)"),e.succeeded){const r=pt(e.source.contents);t.append(" \u21d2  "),t.append("string"===typeof r?'"'+r+'"':r)}t.append("\n")}})),t.contents()}}let mt,dt,ft;ht.prototype.SKIP={},Object.keys(lt).forEach((t=>{const e=lt[t];Object.defineProperty(ht.prototype,t,{get(){return 0!==(this._flags&e)},set(t){t?this._flags|=e:this._flags&=~e}})})),x.prototype.allowsSkippingPrecedingSpace=s("allowsSkippingPrecedingSpace"),_.allowsSkippingPrecedingSpace=S.allowsSkippingPrecedingSpace=j.prototype.allowsSkippingPrecedingSpace=b.prototype.allowsSkippingPrecedingSpace=w.prototype.allowsSkippingPrecedingSpace=M.prototype.allowsSkippingPrecedingSpace=function(){return!0},O.prototype.allowsSkippingPrecedingSpace=P.prototype.allowsSkippingPrecedingSpace=T.prototype.allowsSkippingPrecedingSpace=D.prototype.allowsSkippingPrecedingSpace=k.prototype.allowsSkippingPrecedingSpace=A.prototype.allowsSkippingPrecedingSpace=R.prototype.allowsSkippingPrecedingSpace=function(){return!1},X((t=>{mt=t})),x.prototype.assertAllApplicationsAreValid=function(t,e){dt=0,this._assertAllApplicationsAreValid(t,e)},x.prototype._assertAllApplicationsAreValid=s("_assertAllApplicationsAreValid"),_._assertAllApplicationsAreValid=S._assertAllApplicationsAreValid=b.prototype._assertAllApplicationsAreValid=w.prototype._assertAllApplicationsAreValid=A.prototype._assertAllApplicationsAreValid=M.prototype._assertAllApplicationsAreValid=function(t,e){},T.prototype._assertAllApplicationsAreValid=function(t,e){dt++,this.expr._assertAllApplicationsAreValid(t,e),dt--},O.prototype._assertAllApplicationsAreValid=function(t,e){for(let r=0;r<this.terms.length;r++)this.terms[r]._assertAllApplicationsAreValid(t,e)},R.prototype._assertAllApplicationsAreValid=function(t,e){for(let r=0;r<this.factors.length;r++)this.factors[r]._assertAllApplicationsAreValid(t,e)},P.prototype._assertAllApplicationsAreValid=k.prototype._assertAllApplicationsAreValid=D.prototype._assertAllApplicationsAreValid=function(t,e){this.expr._assertAllApplicationsAreValid(t,e)},j.prototype._assertAllApplicationsAreValid=function(t,e,r=!1){const n=e.rules[this.ruleName],i=h(t)&&0===dt;if(!n)throw q(this.ruleName,e.name,this.source);if(!r&&h(this.ruleName)&&!i)throw function(t,e){return G("Cannot apply syntactic rule "+t+" from here (inside a lexical context)",e.source)}(this.ruleName,this);const s=this.args.length,o=n.formals.length;if(s!==o)throw function(t,e,r,n){return G("Wrong number of arguments for rule "+t+" (expected "+e+", got "+r+")",n)}(this.ruleName,o,s,this.source);const a=mt&&n===mt.rules.applySyntactic;if(mt&&n===mt.rules.caseInsensitive&&!(this.args[0]instanceof b))throw $('a Terminal (e.g. "abc")',this.args[0]);if(a){const t=this.args[0];if(!(t instanceof j))throw $("a syntactic rule application",t);if(!h(t.ruleName))throw function(t){const{ruleName:e}=t;return G(`applySyntactic is for syntactic rules, but '${e}' is a lexical rule. NOTE: A _syntactic rule_ is a rule whose name begins with a capital letter. See https://ohmjs.org/d/svl for more details.`,t.source)}(t);if(i)throw G("applySyntactic is not required here (in a syntactic context)",this.source)}this.args.forEach((r=>{if(r._assertAllApplicationsAreValid(t,e,a),1!==r.getArity())throw function(t,e){return G("Invalid parameter to rule "+t+": "+e+" has arity "+e.getArity()+", but parameter expressions must have arity 1",e.source)}(this.ruleName,r)}))},x.prototype.assertChoicesHaveUniformArity=s("assertChoicesHaveUniformArity"),_.assertChoicesHaveUniformArity=S.assertChoicesHaveUniformArity=b.prototype.assertChoicesHaveUniformArity=w.prototype.assertChoicesHaveUniformArity=A.prototype.assertChoicesHaveUniformArity=T.prototype.assertChoicesHaveUniformArity=M.prototype.assertChoicesHaveUniformArity=function(t){},O.prototype.assertChoicesHaveUniformArity=function(t){if(0===this.terms.length)return;const e=this.terms[0].getArity();for(let r=0;r<this.terms.length;r++){const n=this.terms[r];n.assertChoicesHaveUniformArity();const i=n.getArity();if(e!==i)throw V(t,e,i,n)}},N.prototype.assertChoicesHaveUniformArity=function(t){const e=this.terms[0].getArity(),r=this.terms[1].getArity();if(e!==r)throw V(t,r,e,this.terms[0])},R.prototype.assertChoicesHaveUniformArity=function(t){for(let e=0;e<this.factors.length;e++)this.factors[e].assertChoicesHaveUniformArity(t)},P.prototype.assertChoicesHaveUniformArity=function(t){this.expr.assertChoicesHaveUniformArity(t)},k.prototype.assertChoicesHaveUniformArity=function(t){},D.prototype.assertChoicesHaveUniformArity=function(t){this.expr.assertChoicesHaveUniformArity(t)},j.prototype.assertChoicesHaveUniformArity=function(t){},x.prototype.assertIteratedExprsAreNotNullable=s("assertIteratedExprsAreNotNullable"),_.assertIteratedExprsAreNotNullable=S.assertIteratedExprsAreNotNullable=b.prototype.assertIteratedExprsAreNotNullable=w.prototype.assertIteratedExprsAreNotNullable=A.prototype.assertIteratedExprsAreNotNullable=M.prototype.assertIteratedExprsAreNotNullable=function(t){},O.prototype.assertIteratedExprsAreNotNullable=function(t){for(let e=0;e<this.terms.length;e++)this.terms[e].assertIteratedExprsAreNotNullable(t)},R.prototype.assertIteratedExprsAreNotNullable=function(t){for(let e=0;e<this.factors.length;e++)this.factors[e].assertIteratedExprsAreNotNullable(t)},P.prototype.assertIteratedExprsAreNotNullable=function(t){if(this.expr.assertIteratedExprsAreNotNullable(t),this.expr.isNullable(t))throw H(this,[])},C.prototype.assertIteratedExprsAreNotNullable=k.prototype.assertIteratedExprsAreNotNullable=D.prototype.assertIteratedExprsAreNotNullable=T.prototype.assertIteratedExprsAreNotNullable=function(t){this.expr.assertIteratedExprsAreNotNullable(t)},j.prototype.assertIteratedExprsAreNotNullable=function(t){this.args.forEach((e=>{e.assertIteratedExprsAreNotNullable(t)}))};class gt{constructor(t){this.matchLength=t}get ctorName(){throw new Error("subclass responsibility")}numChildren(){return this.children?this.children.length:0}childAt(t){if(this.children)return this.children[t]}indexOfChild(t){return this.children.indexOf(t)}hasChildren(){return this.numChildren()>0}hasNoChildren(){return!this.hasChildren()}onlyChild(){if(1!==this.numChildren())throw new Error("cannot get only child of a node of type "+this.ctorName+" (it has "+this.numChildren()+" children)");return this.firstChild()}firstChild(){if(this.hasNoChildren())throw new Error("cannot get first child of a "+this.ctorName+" node, which has no children");return this.childAt(0)}lastChild(){if(this.hasNoChildren())throw new Error("cannot get last child of a "+this.ctorName+" node, which has no children");return this.childAt(this.numChildren()-1)}childBefore(t){const e=this.indexOfChild(t);if(e<0)throw new Error("Node.childBefore() called w/ an argument that is not a child");if(0===e)throw new Error("cannot get child before first child");return this.childAt(e-1)}childAfter(t){const e=this.indexOfChild(t);if(e<0)throw new Error("Node.childAfter() called w/ an argument that is not a child");if(e===this.numChildren()-1)throw new Error("cannot get child after last child");return this.childAt(e+1)}isTerminal(){return!1}isNonterminal(){return!1}isIteration(){return!1}isOptional(){return!1}}class vt extends gt{get ctorName(){return"_terminal"}isTerminal(){return!0}get primitiveValue(){throw new Error("The `primitiveValue` property was removed in Ohm v17.")}}class yt extends gt{constructor(t,e,r,n){super(n),this.ruleName=t,this.children=e,this.childOffsets=r}get ctorName(){return this.ruleName}isNonterminal(){return!0}isLexical(){return m(this.ctorName)}isSyntactic(){return h(this.ctorName)}}class It extends gt{constructor(t,e,r,n){super(r),this.children=t,this.childOffsets=e,this.optional=n}get ctorName(){return"_iter"}isIteration(){return!0}isOptional(){return this.optional}}function xt(t,e){const r={};if(t.source&&e){const n=t.source.relativeTo(e);r.sourceInterval=[n.startIdx,n.endIdx]}return r}function _t(t){return/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)}function St(t){const e=Object.create(null);t.forEach((t=>{e[t]=(e[t]||0)+1})),Object.keys(e).forEach((r=>{if(e[r]<=1)return;let n=1;t.forEach(((e,i)=>{e===r&&(t[i]=e+"_"+n++)}))}))}x.prototype.eval=s("eval"),_.eval=function(t){const{inputStream:e}=t,r=e.pos,n=e.nextCodePoint();return void 0!==n?(t.pushBinding(new vt(String.fromCodePoint(n).length),r),!0):(t.processFailure(r,this),!1)},S.eval=function(t){const{inputStream:e}=t,r=e.pos;return e.atEnd()?(t.pushBinding(new vt(0),r),!0):(t.processFailure(r,this),!1)},b.prototype.eval=function(t){const{inputStream:e}=t,r=e.pos;return e.matchString(this.obj)?(t.pushBinding(new vt(this.obj.length),r),!0):(t.processFailure(r,this),!1)},w.prototype.eval=function(t){const{inputStream:e}=t,r=e.pos,n=this.matchCodePoint?e.nextCodePoint():e.nextCharCode();return void 0!==n&&this.from.codePointAt(0)<=n&&n<=this.to.codePointAt(0)?(t.pushBinding(new vt(String.fromCodePoint(n).length),r),!0):(t.processFailure(r,this),!1)},A.prototype.eval=function(t){return t.eval(t.currentApplication().args[this.index])},T.prototype.eval=function(t){t.enterLexifiedContext();const e=t.eval(this.expr);return t.exitLexifiedContext(),e},O.prototype.eval=function(t){for(let e=0;e<this.terms.length;e++)if(t.eval(this.terms[e]))return!0;return!1},R.prototype.eval=function(t){for(let e=0;e<this.factors.length;e++){const r=this.factors[e];if(!t.eval(r))return!1}return!0},P.prototype.eval=function(t){const{inputStream:e}=t,r=e.pos,n=this.getArity(),i=[],s=[];for(;i.length<n;)i.push([]),s.push([]);let o,a=0,c=r;for(;a<this.maxNumMatches&&t.eval(this.expr);){if(e.pos===c)throw H(this,t._applicationStack);c=e.pos,a++;const r=t._bindings.splice(t._bindings.length-n,n),u=t._bindingOffsets.splice(t._bindingOffsets.length-n,n);for(o=0;o<r.length;o++)i[o].push(r[o]),s[o].push(u[o])}if(a<this.minNumMatches)return!1;let u=t.posToOffset(r),l=0;if(a>0){const t=i[n-1],e=s[n-1],r=e[e.length-1]+t[t.length-1].matchLength;u=s[0][0],l=r-u}const p=this instanceof C;for(o=0;o<i.length;o++)t._bindings.push(new It(i[o],s[o],l,p)),t._bindingOffsets.push(u);return!0},k.prototype.eval=function(t){const{inputStream:e}=t,r=e.pos;t.pushFailuresInfo();const n=t.eval(this.expr);return t.popFailuresInfo(),n?(t.processFailure(r,this),!1):(e.pos=r,!0)},D.prototype.eval=function(t){const{inputStream:e}=t,r=e.pos;return!!t.eval(this.expr)&&(e.pos=r,!0)},j.prototype.eval=function(t){const e=t.currentApplication(),r=e?e.args:[],n=this.substituteParams(r),i=t.getCurrentPosInfo();if(i.isActive(n))return n.handleCycle(t);const s=n.toMemoKey(),o=i.memo[s];if(o&&i.shouldUseMemoizedResult(o)){if(t.hasNecessaryInfo(o))return t.useMemoizedResult(t.inputStream.pos,o);delete i.memo[s]}return n.reallyEval(t)},j.prototype.handleCycle=function(t){const e=t.getCurrentPosInfo(),{currentLeftRecursion:r}=e,n=this.toMemoKey();let i=e.memo[n];return r&&r.headApplication.toMemoKey()===n?i.updateInvolvedApplicationMemoKeys():i||(i=e.memoize(n,{matchLength:0,examinedLength:0,value:!1,rightmostFailureOffset:-1}),e.startLeftRecursion(this,i)),t.useMemoizedResult(t.inputStream.pos,i)},j.prototype.reallyEval=function(t){const{inputStream:e}=t,r=e.pos,n=t.getCurrentPosInfo(),i=t.grammar.rules[this.ruleName],{body:s}=i,{description:a}=i;t.enterApplication(n,this),a&&t.pushFailuresInfo();const c=e.examinedLength;e.examinedLength=0;let u=this.evalOnce(s,t);const l=n.currentLeftRecursion,p=this.toMemoKey(),h=l&&l.headApplication.toMemoKey()===p;let m;t.doNotMemoize?t.doNotMemoize=!1:h?(u=this.growSeedResult(s,t,r,l,u),n.endLeftRecursion(),m=l,m.examinedLength=e.examinedLength-r,m.rightmostFailureOffset=t._getRightmostFailureOffset(),n.memoize(p,m)):l&&l.isInvolved(p)||(m=n.memoize(p,{matchLength:e.pos-r,examinedLength:e.examinedLength-r,value:u,failuresAtRightmostPosition:t.cloneRecordedFailures(),rightmostFailureOffset:t._getRightmostFailureOffset()}));const d=!!u;if(a&&(t.popFailuresInfo(),d||t.processFailure(r,this),m&&(m.failuresAtRightmostPosition=t.cloneRecordedFailures())),t.isTracing()&&m){const e=t.getTraceEntry(r,this,d,d?[u]:[]);h&&(o(null!=e.terminatingLREntry||!d),e.isHeadOfLeftRecursion=!0),m.traceEntry=e}return e.examinedLength=Math.max(e.examinedLength,c),t.exitApplication(n,u),d},j.prototype.evalOnce=function(t,e){const{inputStream:r}=e,n=r.pos;if(e.eval(t)){const i=t.getArity(),s=e._bindings.splice(e._bindings.length-i,i),o=e._bindingOffsets.splice(e._bindingOffsets.length-i,i),a=r.pos-n;return new yt(this.ruleName,s,o,a)}return!1},j.prototype.growSeedResult=function(t,e,r,n,i){if(!i)return!1;const{inputStream:s}=e;for(;;){if(n.matchLength=s.pos-r,n.value=i,n.failuresAtRightmostPosition=e.cloneRecordedFailures(),e.isTracing()){const t=e.trace[e.trace.length-1];n.traceEntry=new ht(e.input,r,s.pos,this,!0,[i],[t.clone()])}if(s.pos=r,i=this.evalOnce(t,e),s.pos-r<=n.matchLength)break;e.isTracing()&&e.trace.splice(-2,1)}return e.isTracing()&&n.traceEntry.recordLRTermination(e.trace.pop(),i),s.pos=r+n.matchLength,n.value},M.prototype.eval=function(t){const{inputStream:e}=t,r=e.pos,n=e.next();return n&&this.pattern.test(n)?(t.pushBinding(new vt(n.length),r),!0):(t.processFailure(r,this),!1)},x.prototype.getArity=s("getArity"),_.getArity=S.getArity=b.prototype.getArity=w.prototype.getArity=A.prototype.getArity=j.prototype.getArity=M.prototype.getArity=function(){return 1},O.prototype.getArity=function(){return 0===this.terms.length?0:this.terms[0].getArity()},R.prototype.getArity=function(){let t=0;for(let e=0;e<this.factors.length;e++)t+=this.factors[e].getArity();return t},P.prototype.getArity=function(){return this.expr.getArity()},k.prototype.getArity=function(){return 0},D.prototype.getArity=T.prototype.getArity=function(){return this.expr.getArity()},x.prototype.outputRecipe=s("outputRecipe"),_.outputRecipe=function(t,e){return["any",xt(this,e)]},S.outputRecipe=function(t,e){return["end",xt(this,e)]},b.prototype.outputRecipe=function(t,e){return["terminal",xt(this,e),this.obj]},w.prototype.outputRecipe=function(t,e){return["range",xt(this,e),this.from,this.to]},A.prototype.outputRecipe=function(t,e){return["param",xt(this,e),this.index]},O.prototype.outputRecipe=function(t,e){return["alt",xt(this,e)].concat(this.terms.map((r=>r.outputRecipe(t,e))))},N.prototype.outputRecipe=function(t,e){return this.terms[0].outputRecipe(t,e)},L.prototype.outputRecipe=function(t,e){const r=this.terms.slice(0,this.expansionPos),n=this.terms.slice(this.expansionPos+1);return["splice",xt(this,e),r.map((r=>r.outputRecipe(t,e))),n.map((r=>r.outputRecipe(t,e)))]},R.prototype.outputRecipe=function(t,e){return["seq",xt(this,e)].concat(this.factors.map((r=>r.outputRecipe(t,e))))},F.prototype.outputRecipe=E.prototype.outputRecipe=C.prototype.outputRecipe=k.prototype.outputRecipe=D.prototype.outputRecipe=T.prototype.outputRecipe=function(t,e){return[this.constructor.name.toLowerCase(),xt(this,e),this.expr.outputRecipe(t,e)]},j.prototype.outputRecipe=function(t,e){return["app",xt(this,e),this.ruleName,this.args.map((r=>r.outputRecipe(t,e)))]},M.prototype.outputRecipe=function(t,e){return["unicodeChar",xt(this,e),this.category]},x.prototype.introduceParams=s("introduceParams"),_.introduceParams=S.introduceParams=b.prototype.introduceParams=w.prototype.introduceParams=A.prototype.introduceParams=M.prototype.introduceParams=function(t){return this},O.prototype.introduceParams=function(t){return this.terms.forEach(((e,r,n)=>{n[r]=e.introduceParams(t)})),this},R.prototype.introduceParams=function(t){return this.factors.forEach(((e,r,n)=>{n[r]=e.introduceParams(t)})),this},P.prototype.introduceParams=k.prototype.introduceParams=D.prototype.introduceParams=T.prototype.introduceParams=function(t){return this.expr=this.expr.introduceParams(t),this},j.prototype.introduceParams=function(t){const e=t.indexOf(this.ruleName);if(e>=0){if(this.args.length>0)throw new Error("Parameterized rules cannot be passed as arguments to another rule.");return new A(e).withSource(this.source)}return this.args.forEach(((e,r,n)=>{n[r]=e.introduceParams(t)})),this},x.prototype.isNullable=function(t){return this._isNullable(t,Object.create(null))},x.prototype._isNullable=s("_isNullable"),_._isNullable=w.prototype._isNullable=A.prototype._isNullable=E.prototype._isNullable=M.prototype._isNullable=function(t,e){return!1},S._isNullable=function(t,e){return!0},b.prototype._isNullable=function(t,e){return"string"===typeof this.obj&&""===this.obj},O.prototype._isNullable=function(t,e){return 0===this.terms.length||this.terms.some((r=>r._isNullable(t,e)))},R.prototype._isNullable=function(t,e){return this.factors.every((r=>r._isNullable(t,e)))},F.prototype._isNullable=C.prototype._isNullable=k.prototype._isNullable=D.prototype._isNullable=function(t,e){return!0},T.prototype._isNullable=function(t,e){return this.expr._isNullable(t,e)},j.prototype._isNullable=function(t,e){const r=this.toMemoKey();if(!Object.prototype.hasOwnProperty.call(e,r)){const{body:n}=t.rules[this.ruleName],i=n.substituteParams(this.args);e[r]=!1,e[r]=i._isNullable(t,e)}return e[r]},x.prototype.substituteParams=s("substituteParams"),_.substituteParams=S.substituteParams=b.prototype.substituteParams=w.prototype.substituteParams=M.prototype.substituteParams=function(t){return this},A.prototype.substituteParams=function(t){return t[this.index]},O.prototype.substituteParams=function(t){return new O(this.terms.map((e=>e.substituteParams(t))))},R.prototype.substituteParams=function(t){return new R(this.factors.map((e=>e.substituteParams(t))))},P.prototype.substituteParams=k.prototype.substituteParams=D.prototype.substituteParams=T.prototype.substituteParams=function(t){return new this.constructor(this.expr.substituteParams(t))},j.prototype.substituteParams=function(t){if(0===this.args.length)return this;{const e=this.args.map((e=>e.substituteParams(t)));return new j(this.ruleName,e)}},x.prototype.toArgumentNameList=s("toArgumentNameList"),_.toArgumentNameList=function(t,e){return["any"]},S.toArgumentNameList=function(t,e){return["end"]},b.prototype.toArgumentNameList=function(t,e){return"string"===typeof this.obj&&/^[_a-zA-Z0-9]+$/.test(this.obj)?["_"+this.obj]:["$"+t]},w.prototype.toArgumentNameList=function(t,e){let r=this.from+"_to_"+this.to;return _t(r)||(r="_"+r),_t(r)||(r="$"+t),[r]},O.prototype.toArgumentNameList=function(t,e){const r=this.terms.map((e=>e.toArgumentNameList(t,!0))),n=[],i=r[0].length;for(let s=0;s<i;s++){const t=[];for(let n=0;n<this.terms.length;n++)t.push(r[n][s]);const e=p(t);n.push(e.join("_or_"))}return e||St(n),n},R.prototype.toArgumentNameList=function(t,e){let r=[];return this.factors.forEach((e=>{const n=e.toArgumentNameList(t,!0);r=r.concat(n),t+=n.length})),e||St(r),r},P.prototype.toArgumentNameList=function(t,e){const r=this.expr.toArgumentNameList(t,e).map((t=>"s"===t[t.length-1]?t+"es":t+"s"));return e||St(r),r},C.prototype.toArgumentNameList=function(t,e){return this.expr.toArgumentNameList(t,e).map((t=>"opt"+t[0].toUpperCase()+t.slice(1)))},k.prototype.toArgumentNameList=function(t,e){return[]},D.prototype.toArgumentNameList=T.prototype.toArgumentNameList=function(t,e){return this.expr.toArgumentNameList(t,e)},j.prototype.toArgumentNameList=function(t,e){return[this.ruleName]},M.prototype.toArgumentNameList=function(t,e){return["$"+t]},A.prototype.toArgumentNameList=function(t,e){return["param"+this.index]},x.prototype.toDisplayString=s("toDisplayString"),O.prototype.toDisplayString=R.prototype.toDisplayString=function(){return this.source?this.source.trimmed().contents:"["+this.constructor.name+"]"},_.toDisplayString=S.toDisplayString=P.prototype.toDisplayString=k.prototype.toDisplayString=D.prototype.toDisplayString=T.prototype.toDisplayString=b.prototype.toDisplayString=w.prototype.toDisplayString=A.prototype.toDisplayString=function(){return this.toString()},j.prototype.toDisplayString=function(){if(this.args.length>0){const t=this.args.map((t=>t.toDisplayString()));return this.ruleName+"<"+t.join(",")+">"}return this.ruleName},M.prototype.toDisplayString=function(){return"Unicode ["+this.category+"] character"};class bt{constructor(t,e,r){if(!function(t){return"description"===t||"string"===t||"code"===t}(r))throw new Error("invalid Failure type: "+r);this.pexpr=t,this.text=e,this.type=r,this.fluffy=!1}getPExpr(){return this.pexpr}getText(){return this.text}getType(){return this.type}isDescription(){return"description"===this.type}isStringTerminal(){return"string"===this.type}isCode(){return"code"===this.type}isFluffy(){return this.fluffy}makeFluffy(){this.fluffy=!0}clearFluffy(){this.fluffy=!1}subsumes(t){return this.getText()===t.getText()&&this.type===t.type&&(!this.isFluffy()||this.isFluffy()&&t.isFluffy())}toString(){return"string"===this.type?JSON.stringify(this.getText()):this.getText()}clone(){const t=new bt(this.pexpr,this.text,this.type);return this.isFluffy()&&t.makeFluffy(),t}toKey(){return this.toString()+"#"+this.type}}x.prototype.toFailure=s("toFailure"),_.toFailure=function(t){return new bt(this,"any object","description")},S.toFailure=function(t){return new bt(this,"end of input","description")},b.prototype.toFailure=function(t){return new bt(this,this.obj,"string")},w.prototype.toFailure=function(t){return new bt(this,JSON.stringify(this.from)+".."+JSON.stringify(this.to),"code")},k.prototype.toFailure=function(t){const e=this.expr===_?"nothing":"not "+this.expr.toFailure(t);return new bt(this,e,"description")},D.prototype.toFailure=function(t){return this.expr.toFailure(t)},j.prototype.toFailure=function(t){let{description:e}=t.rules[this.ruleName];if(!e){e=(/^[aeiouAEIOU]/.test(this.ruleName)?"an":"a")+" "+this.ruleName}return new bt(this,e,"description")},M.prototype.toFailure=function(t){return new bt(this,"a Unicode ["+this.category+"] character","description")},O.prototype.toFailure=function(t){const e="("+this.terms.map((e=>e.toFailure(t))).join(" or ")+")";return new bt(this,e,"description")},R.prototype.toFailure=function(t){const e="("+this.factors.map((e=>e.toFailure(t))).join(" ")+")";return new bt(this,e,"description")},P.prototype.toFailure=function(t){const e="("+this.expr.toFailure(t)+this.operator+")";return new bt(this,e,"description")},x.prototype.toString=s("toString"),_.toString=function(){return"any"},S.toString=function(){return"end"},b.prototype.toString=function(){return JSON.stringify(this.obj)},w.prototype.toString=function(){return JSON.stringify(this.from)+".."+JSON.stringify(this.to)},A.prototype.toString=function(){return"$"+this.index},T.prototype.toString=function(){return"#("+this.expr.toString()+")"},O.prototype.toString=function(){return 1===this.terms.length?this.terms[0].toString():"("+this.terms.map((t=>t.toString())).join(" | ")+")"},R.prototype.toString=function(){return 1===this.factors.length?this.factors[0].toString():"("+this.factors.map((t=>t.toString())).join(" ")+")"},P.prototype.toString=function(){return this.expr+this.operator},k.prototype.toString=function(){return"~"+this.expr},D.prototype.toString=function(){return"&"+this.expr},j.prototype.toString=function(){if(this.args.length>0){const t=this.args.map((t=>t.toString()));return this.ruleName+"<"+t.join(",")+">"}return this.ruleName},M.prototype.toString=function(){return"\\p{"+this.category+"}"};class wt extends x{constructor(t){super(),this.obj=t}_getString(t){const e=t.currentApplication().args[this.obj.index];return o(e instanceof b,"expected a Terminal expression"),e.obj}allowsSkippingPrecedingSpace(){return!0}eval(t){const{inputStream:e}=t,r=e.pos,n=this._getString(t);return e.matchString(n,!0)?(t.pushBinding(new vt(n.length),r),!0):(t.processFailure(r,this),!1)}getArity(){return 1}substituteParams(t){return new wt(this.obj.substituteParams(t))}toDisplayString(){return this.obj.toDisplayString()+" (case-insensitive)"}toFailure(t){return new bt(this,this.obj.toFailure(t)+" (case-insensitive)","description")}_isNullable(t,e){return this.obj._isNullable(t,e)}}X((t=>{ft=t.rules.applySyntactic.body}));const At=new j("spaces");class Ot{constructor(t,e,r){this.matcher=t,this.startExpr=e,this.grammar=t.grammar,this.input=t.getInput(),this.inputStream=new nt(this.input),this.memoTable=t._memoTable,this.userData=void 0,this.doNotMemoize=!1,this._bindings=[],this._bindingOffsets=[],this._applicationStack=[],this._posStack=[0],this.inLexifiedContextStack=[!1],this.rightmostFailurePosition=-1,this._rightmostFailurePositionStack=[],this._recordedFailuresStack=[],void 0!==r&&(this.positionToRecordFailures=r,this.recordedFailures=Object.create(null))}posToOffset(t){return t-this._posStack[this._posStack.length-1]}enterApplication(t,e){this._posStack.push(this.inputStream.pos),this._applicationStack.push(e),this.inLexifiedContextStack.push(!1),t.enter(e),this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this.rightmostFailurePosition=-1}exitApplication(t,e){const r=this._posStack.pop();this._applicationStack.pop(),this.inLexifiedContextStack.pop(),t.exit(),this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,this._rightmostFailurePositionStack.pop()),e&&this.pushBinding(e,r)}enterLexifiedContext(){this.inLexifiedContextStack.push(!0)}exitLexifiedContext(){this.inLexifiedContextStack.pop()}currentApplication(){return this._applicationStack[this._applicationStack.length-1]}inSyntacticContext(){const t=this.currentApplication();return t?t.isSyntactic()&&!this.inLexifiedContext():this.startExpr.factors[0].isSyntactic()}inLexifiedContext(){return this.inLexifiedContextStack[this.inLexifiedContextStack.length-1]}skipSpaces(){return this.pushFailuresInfo(),this.eval(At),this.popBinding(),this.popFailuresInfo(),this.inputStream.pos}skipSpacesIfInSyntacticContext(){return this.inSyntacticContext()?this.skipSpaces():this.inputStream.pos}maybeSkipSpacesBefore(t){return t.allowsSkippingPrecedingSpace()&&t!==At?this.skipSpacesIfInSyntacticContext():this.inputStream.pos}pushBinding(t,e){this._bindings.push(t),this._bindingOffsets.push(this.posToOffset(e))}popBinding(){this._bindings.pop(),this._bindingOffsets.pop()}numBindings(){return this._bindings.length}truncateBindings(t){for(;this._bindings.length>t;)this.popBinding()}getCurrentPosInfo(){return this.getPosInfo(this.inputStream.pos)}getPosInfo(t){let e=this.memoTable[t];return e||(e=this.memoTable[t]=new st),e}processFailure(t,e){if(this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,t),this.recordedFailures&&t===this.positionToRecordFailures){const t=this.currentApplication();t&&(e=e.substituteParams(t.args)),this.recordFailure(e.toFailure(this.grammar),!1)}}recordFailure(t,e){const r=t.toKey();this.recordedFailures[r]?this.recordedFailures[r].isFluffy()&&!t.isFluffy()&&this.recordedFailures[r].clearFluffy():this.recordedFailures[r]=e?t.clone():t}recordFailures(t,e){Object.keys(t).forEach((r=>{this.recordFailure(t[r],e)}))}cloneRecordedFailures(){if(!this.recordedFailures)return;const t=Object.create(null);return Object.keys(this.recordedFailures).forEach((e=>{t[e]=this.recordedFailures[e].clone()})),t}getRightmostFailurePosition(){return this.rightmostFailurePosition}_getRightmostFailureOffset(){return this.rightmostFailurePosition>=0?this.posToOffset(this.rightmostFailurePosition):-1}getMemoizedTraceEntry(t,e){const r=this.memoTable[t];if(r&&e instanceof j){const t=r.memo[e.toMemoKey()];if(t&&t.traceEntry){const r=t.traceEntry.cloneWithExpr(e);return r.isMemoized=!0,r}}return null}getTraceEntry(t,e,r,n){if(e instanceof j){const t=this.currentApplication(),r=t?t.args:[];e=e.substituteParams(r)}return this.getMemoizedTraceEntry(t,e)||new ht(this.input,t,this.inputStream.pos,e,r,n,this.trace)}isTracing(){return!!this.trace}hasNecessaryInfo(t){return!(this.trace&&!t.traceEntry)&&(!this.recordedFailures||this.inputStream.pos+t.rightmostFailureOffset!==this.positionToRecordFailures||!!t.failuresAtRightmostPosition)}useMemoizedResult(t,e){this.trace&&this.trace.push(e.traceEntry);const r=this.inputStream.pos+e.rightmostFailureOffset;return this.rightmostFailurePosition=Math.max(this.rightmostFailurePosition,r),this.recordedFailures&&this.positionToRecordFailures===r&&e.failuresAtRightmostPosition&&this.recordFailures(e.failuresAtRightmostPosition,!0),this.inputStream.examinedLength=Math.max(this.inputStream.examinedLength,e.examinedLength+t),!!e.value&&(this.inputStream.pos+=e.matchLength,this.pushBinding(e.value,t),!0)}eval(t){const{inputStream:e}=this,r=this._bindings.length,n=this.userData;let i;this.recordedFailures&&(i=this.recordedFailures,this.recordedFailures=Object.create(null));const s=e.pos,o=this.maybeSkipSpacesBefore(t);let a;this.trace&&(a=this.trace,this.trace=[]);const c=t.eval(this);if(this.trace){const e=this._bindings.slice(r),n=this.getTraceEntry(o,t,c,e);n.isImplicitSpaces=t===At,n.isRootNode=t===this.startExpr,a.push(n),this.trace=a}return c?this.recordedFailures&&e.pos===this.positionToRecordFailures&&Object.keys(this.recordedFailures).forEach((t=>{this.recordedFailures[t].makeFluffy()})):(e.pos=s,this.truncateBindings(r),this.userData=n),this.recordedFailures&&this.recordFailures(i,!1),t===ft&&this.skipSpaces(),c}getMatchResult(){let t;this.grammar._setUpMatchState(this),this.eval(this.startExpr),this.recordedFailures&&(t=Object.keys(this.recordedFailures).map((t=>this.recordedFailures[t])));const e=this._bindings[0];return e&&(e.grammar=this.grammar),new it(this.matcher,this.input,this.startExpr,e,this._bindingOffsets[0],this.rightmostFailurePosition,t)}getTrace(){this.trace=[];const t=this.getMatchResult(),e=this.trace[this.trace.length-1];return e.result=t,e}pushFailuresInfo(){this._rightmostFailurePositionStack.push(this.rightmostFailurePosition),this._recordedFailuresStack.push(this.recordedFailures)}popFailuresInfo(){this.rightmostFailurePosition=this._rightmostFailurePositionStack.pop(),this.recordedFailures=this._recordedFailuresStack.pop()}}class Nt{constructor(t){this.grammar=t,this._memoTable=[],this._input="",this._isMemoTableStale=!1}_resetMemoTable(){this._memoTable=[],this._isMemoTableStale=!1}getInput(){return this._input}setInput(t){return this._input!==t&&this.replaceInputRange(0,this._input.length,t),this}replaceInputRange(t,e,r){const n=this._input,i=this._memoTable;if(t<0||t>n.length||e<0||e>n.length||t>e)throw new Error("Invalid indices: "+t+" and "+e);this._input=n.slice(0,t)+r+n.slice(e),this._input!==n&&i.length>0&&(this._isMemoTableStale=!0);const s=i.slice(e);i.length=t;for(let o=0;o<r.length;o++)i.push(void 0);for(const o of s)i.push(o);for(let o=0;o<t;o++){const e=i[o];e&&e.clearObsoleteEntries(o,t)}return this}match(t,e={incremental:!0}){return this._match(this._getStartExpr(t),{incremental:e.incremental,tracing:!1})}trace(t,e={incremental:!0}){return this._match(this._getStartExpr(t),{incremental:e.incremental,tracing:!0})}_match(t,e={}){const r={tracing:!1,incremental:!0,positionToRecordFailures:void 0,...e};if(r.incremental){if(this._isMemoTableStale&&!this.grammar.supportsIncrementalParsing)throw function(t){return G(`Grammar '${t.name}' does not support incremental parsing`)}(this.grammar)}else this._resetMemoTable();const n=new Ot(this,t,r.positionToRecordFailures);return r.tracing?n.getTrace():n.getMatchResult()}_getStartExpr(t){const e=t||this.grammar.defaultStartRule;if(!e)throw new Error("Missing start rule argument -- the grammar has no default start rule.");const r=this.grammar.parseApplication(e);return new R([r,S])}}const Lt=[],Rt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);class Pt{constructor(t,e,r){this._node=t,this.source=e,this._baseInterval=r,t.isNonterminal()&&o(e===r),this._childWrappers=[]}_forgetMemoizedResultFor(t){delete this._node[this._semantics.attributeKeys[t]],this.children.forEach((e=>{e._forgetMemoizedResultFor(t)}))}child(t){if(!(0<=t&&t<this._node.numChildren()))return;let e=this._childWrappers[t];if(!e){const r=this._node.childAt(t),n=this._node.childOffsets[t],i=this._baseInterval.subInterval(n,r.matchLength),s=r.isNonterminal()?i:this._baseInterval;e=this._childWrappers[t]=this._semantics.wrap(r,i,s)}return e}_children(){for(let t=0;t<this._node.numChildren();t++)this.child(t);return this._childWrappers}isIteration(){return this._node.isIteration()}isTerminal(){return this._node.isTerminal()}isNonterminal(){return this._node.isNonterminal()}isSyntactic(){return this.isNonterminal()&&this._node.isSyntactic()}isLexical(){return this.isNonterminal()&&this._node.isLexical()}isOptional(){return this._node.isOptional()}iteration(t){const e=t||[],r=e.map((t=>t._node)),n=new It(r,[],-1,!1),i=this._semantics.wrap(n,null,null);return i._childWrappers=e,i}get children(){return this._children()}get ctorName(){return this._node.ctorName}get numChildren(){return this._node.numChildren()}get sourceString(){return this.source.contents}}class Ft{constructor(t,e){const r=this;if(this.grammar=t,this.checkedActionDicts=!1,this.Wrapper=class extends(e?e.Wrapper:Pt){constructor(t,e,n){super(t,e,n),r.checkActionDictsIfHaventAlready(),this._semantics=r}toString(){return"[semantics wrapper for "+r.grammar.name+"]"}},this.super=e,e){if(!t.equals(this.super.grammar)&&!t._inheritsFrom(this.super.grammar))throw new Error("Cannot extend a semantics for grammar '"+this.super.grammar.name+"' for use with grammar '"+t.name+"' (not a sub-grammar)");this.operations=Object.create(this.super.operations),this.attributes=Object.create(this.super.attributes),this.attributeKeys=Object.create(null);for(const t in this.attributes)Object.defineProperty(this.attributeKeys,t,{value:et(t)})}else this.operations=Object.create(null),this.attributes=Object.create(null),this.attributeKeys=Object.create(null)}toString(){return"[semantics for "+this.grammar.name+"]"}checkActionDictsIfHaventAlready(){this.checkedActionDicts||(this.checkActionDicts(),this.checkedActionDicts=!0)}checkActionDicts(){let t;for(t in this.operations)this.operations[t].checkActionDict(this.grammar);for(t in this.attributes)this.attributes[t].checkActionDict(this.grammar)}toRecipe(t){function e(t){return t.super!==Ft.BuiltInSemantics._getSemantics()}let r="(function(g) {\n";if(e(this)){r+="  var semantics = "+this.super.toRecipe(!0)+"(g";const t=this.super.grammar;let e=this.grammar;for(;e!==t;)r+=".superGrammar",e=e.superGrammar;r+=");\n",r+="  return g.extendSemantics(semantics)"}else r+="  return g.createSemantics()";return["Operation","Attribute"].forEach((t=>{const n=this[t.toLowerCase()+"s"];Object.keys(n).forEach((i=>{const{actionDict:s,formals:o,builtInDefault:a}=n[i];let c,u=i;o.length>0&&(u+="("+o.join(", ")+")"),c=e(this)&&this.super[t.toLowerCase()+"s"][i]?"extend"+t:"add"+t,r+="\n    ."+c+"("+JSON.stringify(u)+", {";const l=[];Object.keys(s).forEach((t=>{if(s[t]!==a){let e=s[t].toString().trim();e=e.replace(/^.*\(/,"function("),l.push("\n      "+JSON.stringify(t)+": "+e)}})),r+=l.join(",")+"\n    })"}))})),r+=";\n  })",t||(r="(function() {\n  var grammar = this.fromRecipe("+this.grammar.toRecipe()+");\n  var semantics = "+r+"(grammar);\n  return semantics;\n});\n"),r}addOperationOrAttribute(t,e,r){const n=t+"s",i=Et(e,t),{name:s}=i,{formals:o}=i;this.assertNewName(s,t);const a=function(t,e,r){return function(...n){const i=(this._semantics.operations[e]||this._semantics.attributes[e]).formals.map((t=>this.args[t]));if(this.isIteration()||1!==n.length)throw function(t,e,r,n){let i=n.slice(0,-1).map((t=>{const e="  "+t[0].name+" > "+t[1];return 3===t.length?e+" for '"+t[2]+"'":e})).join("\n");i+="\n  "+e+" > "+t;let s="";"_iter"===t&&(s=["\nNOTE: as of Ohm v16, there is no default action for iteration nodes \u2014 see ","  https://ohmjs.org/d/dsa for details."].join("\n"));const o=G([`Missing semantic action for '${t}' in ${r} '${e}'.${s}`,"Action stack (most recent call last):",i].join("\n"));return o.name="missingSemanticAction",o}(this.ctorName,e,t,Lt);return r.apply(n[0],i)}}(t,s,l),c={_default:a};Object.keys(r).forEach((t=>{c[t]=r[t]}));const u="operation"===t?new Ct(s,o,c,a):new kt(s,c,a);function l(...e){const r=this._semantics[n][s];if(arguments.length!==r.formals.length)throw new Error("Invalid number of arguments passed to "+s+" "+t+" (expected "+r.formals.length+", got "+arguments.length+")");const i=Object.create(null);for(const[t,n]of Object.entries(e)){i[r.formals[t]]=n}const o=this.args;this.args=i;const a=r.execute(this._semantics,this);return this.args=o,a}u.checkActionDict(this.grammar),this[n][s]=u,"operation"===t?(this.Wrapper.prototype[s]=l,this.Wrapper.prototype[s].toString=function(){return"["+s+" operation]"}):(Object.defineProperty(this.Wrapper.prototype,s,{get:l,configurable:!0}),Object.defineProperty(this.attributeKeys,s,{value:et(s)}))}extendOperationOrAttribute(t,e,r){const n=t+"s";if(Et(e,"attribute"),!this.super||!(e in this.super[n]))throw new Error("Cannot extend "+t+" '"+e+"': did not inherit an "+t+" with that name");if(Rt(this[n],e))throw new Error("Cannot extend "+t+" '"+e+"' again");const i=this[n][e].formals,s=this[n][e].actionDict,o=Object.create(s);Object.keys(r).forEach((t=>{o[t]=r[t]})),this[n][e]="operation"===t?new Ct(e,i,o):new kt(e,o),this[n][e].checkActionDict(this.grammar)}assertNewName(t,e){if(Rt(Pt.prototype,t))throw new Error("Cannot add "+e+" '"+t+"': that's a reserved name");if(t in this.operations)throw new Error("Cannot add "+e+" '"+t+"': an operation with that name already exists");if(t in this.attributes)throw new Error("Cannot add "+e+" '"+t+"': an attribute with that name already exists")}wrap(t,e,r){const n=r||e;return t instanceof this.Wrapper?t:new this.Wrapper(t,e,n)}}function Et(t,e){if(!Ft.prototypeGrammar)return o(-1===t.indexOf("(")),{name:t,formals:[]};const r=Ft.prototypeGrammar.match(t,"operation"===e?"OperationSignature":"AttributeSignature");if(r.failed())throw new Error(r.message);return Ft.prototypeGrammarSemantics(r).parse()}Ft.createSemantics=function(t,e){const r=new Ft(t,void 0!==e?e:Ft.BuiltInSemantics._getSemantics()),n=function(e){if(!(e instanceof it))throw new TypeError("Semantics expected a MatchResult, but got "+y(e));if(e.failed())throw new TypeError("cannot apply Semantics to "+e.toString());const n=e._cst;if(n.grammar!==t)throw new Error("Cannot use a MatchResult from grammar '"+n.grammar.name+"' with a semantics for '"+t.name+"'");const i=new nt(e.input);return r.wrap(n,i.interval(e._cstOffset,e.input.length))};return n.addOperation=function(t,e){return r.addOperationOrAttribute("operation",t,e),n},n.extendOperation=function(t,e){return r.extendOperationOrAttribute("operation",t,e),n},n.addAttribute=function(t,e){return r.addOperationOrAttribute("attribute",t,e),n},n.extendAttribute=function(t,e){return r.extendOperationOrAttribute("attribute",t,e),n},n._getActionDict=function(e){const n=r.operations[e]||r.attributes[e];if(!n)throw new Error('"'+e+'" is not a valid operation or attribute name in this semantics for "'+t.name+'"');return n.actionDict},n._remove=function(t){let e;return t in r.operations?(e=r.operations[t],delete r.operations[t]):t in r.attributes&&(e=r.attributes[t],delete r.attributes[t]),delete r.Wrapper.prototype[t],e},n.getOperationNames=function(){return Object.keys(r.operations)},n.getAttributeNames=function(){return Object.keys(r.attributes)},n.getGrammar=function(){return r.grammar},n.toRecipe=function(t){return r.toRecipe(t)},n.toString=r.toString.bind(r),n._getSemantics=function(){return r},n};class Ct{constructor(t,e,r,n){this.name=t,this.formals=e,this.actionDict=r,this.builtInDefault=n}checkActionDict(t){t._checkTopDownActionDict(this.typeName,this.name,this.actionDict)}execute(t,e){try{const{ctorName:t}=e._node;let r=this.actionDict[t];return r?(Lt.push([this,t]),r.apply(e,e._children())):e.isNonterminal()&&(r=this.actionDict._nonterminal,r)?(Lt.push([this,"_nonterminal",t]),r.apply(e,e._children())):(Lt.push([this,"default action",t]),this.actionDict._default.apply(e,e._children()))}finally{Lt.pop()}}}Ct.prototype.typeName="operation";class kt extends Ct{constructor(t,e,r){super(t,[],e,r)}execute(t,e){const r=e._node,n=t.attributeKeys[this.name];return Rt(r,n)||(r[n]=Ct.prototype.execute.call(this,t,e)),r[n]}}kt.prototype.typeName="attribute";const Dt=["_iter","_terminal","_nonterminal","_default"];function Tt(t){return Object.keys(t.rules).sort().map((e=>t.rules[e]))}let jt,Mt;class Gt{constructor(t,e,r,n){if(this.name=t,this.superGrammar=e,this.rules=r,n){if(!(n in r))throw new Error("Invalid start rule: '"+n+"' is not a rule in grammar '"+t+"'");this.defaultStartRule=n}this._matchStateInitializer=void 0,this.supportsIncrementalParsing=!0}matcher(){return new Nt(this)}isBuiltIn(){return this===Gt.ProtoBuiltInRules||this===Gt.BuiltInRules}equals(t){if(this===t)return!0;if(null==t||this.name!==t.name||this.defaultStartRule!==t.defaultStartRule||this.superGrammar!==t.superGrammar&&!this.superGrammar.equals(t.superGrammar))return!1;const e=Tt(this),r=Tt(t);return e.length===r.length&&e.every(((t,e)=>t.description===r[e].description&&t.formals.join(",")===r[e].formals.join(",")&&t.body.toString()===r[e].body.toString()))}match(t,e){const r=this.matcher();return r.replaceInputRange(0,0,t),r.match(e)}trace(t,e){const r=this.matcher();return r.replaceInputRange(0,0,t),r.trace(e)}createSemantics(){return Ft.createSemantics(this)}extendSemantics(t){return Ft.createSemantics(this,t._getSemantics())}_checkTopDownActionDict(t,e,r){const n=[];for(const i in r){const t=r[i];if(!Dt.includes(i)&&!(i in this.rules)){n.push(`'${i}' is not a valid semantic action for '${this.name}'`);continue}if("function"!==typeof t){n.push(`'${i}' must be a function in an action dictionary for '${this.name}'`);continue}const e=t.length,s=this._topDownActionArity(i);if(e!==s){let t;t="_iter"===i||"_nonterminal"===i?`it should use a rest parameter, e.g. \`${i}(...children) {}\`. NOTE: this is new in Ohm v16 \u2014 see https://ohmjs.org/d/ati for details.`:`expected ${s}, got ${e}`,n.push(`Semantic action '${i}' has the wrong arity: ${t}`)}}if(n.length>0){const r=n.map((t=>"- "+t)),i=new Error([`Found errors in the action dictionary of the '${e}' ${t}:`,...r].join("\n"));throw i.problems=n,i}}_topDownActionArity(t){return Dt.includes(t)?0:this.rules[t].body.getArity()}_inheritsFrom(t){let e=this.superGrammar;for(;e;){if(e.equals(t,!0))return!0;e=e.superGrammar}return!1}toRecipe(t=void 0){const e={};this.source&&(e.source=this.source.contents);let r=null;this.defaultStartRule&&(r=this.defaultStartRule);const n={};Object.keys(this.rules).forEach((t=>{const e=this.rules[t],{body:r}=e,i=!this.superGrammar||!this.superGrammar.rules[t];let s;s=i?"define":r instanceof N?"extend":"override";const o={};if(e.source&&this.source){const t=e.source.relativeTo(this.source);o.sourceInterval=[t.startIdx,t.endIdx]}const a=i?e.description:null,c=r.outputRecipe(e.formals,this.source);n[t]=[s,o,a,e.formals,c]}));let i="null";t?i=t:this.superGrammar&&!this.superGrammar.isBuiltIn()&&(i=this.superGrammar.toRecipe());const s=[...["grammar",e,this.name].map(JSON.stringify),i,...[r,n].map(JSON.stringify)];return`[${s.join(",")}]`.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}toOperationActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()}toAttributeActionDictionaryTemplate(){return this._toOperationOrAttributeActionDictionaryTemplate()}_toOperationOrAttributeActionDictionaryTemplate(){const t=new f;t.append("{");let e=!0;for(const r in this.rules){const{body:n}=this.rules[r];e?e=!1:t.append(","),t.append("\n"),t.append("  "),this.addSemanticActionTemplate(r,n,t)}return t.append("\n}"),t.contents()}addSemanticActionTemplate(t,e,r){r.append(t),r.append(": function(");const n=this._topDownActionArity(t);r.append(u("_",n).join(", ")),r.append(") {\n"),r.append("  }")}parseApplication(t){let e;if(-1===t.indexOf("<"))e=new j(t);else{const r=jt.match(t,"Base_application");e=Mt(r,{})}if(!(e.ruleName in this.rules))throw q(e.ruleName,this.name);const{formals:r}=this.rules[e.ruleName];if(r.length!==e.args.length){const{source:t}=this.rules[e.ruleName];throw U(e.ruleName,r.length,e.args.length,t)}return e}_setUpMatchState(t){this._matchStateInitializer&&this._matchStateInitializer(t)}}Gt.ProtoBuiltInRules=new Gt("ProtoBuiltInRules",void 0,{any:{body:_,formals:[],description:"any character",primitive:!0},end:{body:S,formals:[],description:"end of input",primitive:!0},caseInsensitive:{body:new wt(new A(0)),formals:["str"],primitive:!0},lower:{body:new M("Ll"),formals:[],description:"a lowercase letter",primitive:!0},upper:{body:new M("Lu"),formals:[],description:"an uppercase letter",primitive:!0},unicodeLtmo:{body:new M("Ltmo"),formals:[],description:"a Unicode character in Lt, Lm, or Lo",primitive:!0},spaces:{body:new F(new j("space")),formals:[]},space:{body:new w("\0"," "),formals:[],description:"a space"}}),Gt.initApplicationParser=function(t,e){jt=t,Mt=e};class Bt{constructor(t){this.name=t}sourceInterval(t,e){return this.source.subInterval(t,e-t)}ensureSuperGrammar(){return this.superGrammar||this.withSuperGrammar("BuiltInRules"===this.name?Gt.ProtoBuiltInRules:Gt.BuiltInRules),this.superGrammar}ensureSuperGrammarRuleForOverriding(t,e){const r=this.ensureSuperGrammar().rules[t];if(!r)throw n=t,i=this.superGrammar.name,G("Cannot override rule "+n+" because it is not declared in "+i,e);var n,i;return r}installOverriddenOrExtendedRule(t,e,r,n){const i=l(e);if(i.length>0)throw K(t,i,n);const s=this.ensureSuperGrammar().rules[t],o=s.formals,a=o?o.length:0;if(e.length!==a)throw U(t,a,e.length,n);return this.install(t,e,r,s.description,n)}install(t,e,r,n,i,s=!1){return this.rules[t]={body:r.introduceParams(e),formals:e,description:n,source:i,primitive:s},this}withSuperGrammar(t){if(this.superGrammar)throw new Error("the super grammar of a GrammarDecl cannot be set more than once");return this.superGrammar=t,this.rules=Object.create(t.rules),t.isBuiltIn()||(this.defaultStartRule=t.defaultStartRule),this}withDefaultStartRule(t){return this.defaultStartRule=t,this}withSource(t){return this.source=new nt(t).interval(0,t.length),this}build(){const t=new Gt(this.name,this.ensureSuperGrammar(),this.rules,this.defaultStartRule);t._matchStateInitializer=t.superGrammar._matchStateInitializer,t.supportsIncrementalParsing=t.superGrammar.supportsIncrementalParsing;const e=[];let r=!1;return Object.keys(t.rules).forEach((n=>{const{body:i}=t.rules[n];try{i.assertChoicesHaveUniformArity(n)}catch(s){e.push(s)}try{i.assertAllApplicationsAreValid(n,t)}catch(s){e.push(s),r=!0}})),r||Object.keys(t.rules).forEach((r=>{const{body:n}=t.rules[r];try{n.assertIteratedExprsAreNotNullable(t,[])}catch(i){e.push(i)}})),e.length>0&&W(e),this.source&&(t.source=this.source),t}define(t,e,r,n,i,s){if(this.ensureSuperGrammar(),this.superGrammar.rules[t])throw z(t,this.name,this.superGrammar.name,i);if(this.rules[t])throw z(t,this.name,this.name,i);const o=l(e);if(o.length>0)throw K(t,o,i);return this.install(t,e,r,n,i,s)}override(t,e,r,n,i){return this.ensureSuperGrammarRuleForOverriding(t,i),this.installOverriddenOrExtendedRule(t,e,r,i),this}extend(t,e,r,n,i){if(!this.ensureSuperGrammar().rules[t])throw s=t,o=this.superGrammar.name,G("Cannot extend rule "+s+" because it is not declared in "+o,i);var s,o;const a=new N(this.superGrammar,t,r);return a.source=r.source,this.installOverriddenOrExtendedRule(t,e,a,i),this}}class qt{constructor(){this.currentDecl=null,this.currentRuleName=null}newGrammar(t){return new Bt(t)}grammar(t,e,r,n,i){const s=new Bt(e);return r&&s.withSuperGrammar(r instanceof Gt?r:this.fromRecipe(r)),n&&s.withDefaultStartRule(n),t&&t.source&&s.withSource(t.source),this.currentDecl=s,Object.keys(i).forEach((t=>{this.currentRuleName=t;const e=i[t],r=e[0],n=e[1],o=e[2],a=e[3],c=this.fromRecipe(e[4]);let u;s.source&&n&&n.sourceInterval&&(u=s.source.subInterval(n.sourceInterval[0],n.sourceInterval[1]-n.sourceInterval[0])),s[r](t,a,c,o,u)})),this.currentRuleName=this.currentDecl=null,s.build()}terminal(t){return new b(t)}range(t,e){return new w(t,e)}param(t){return new A(t)}alt(...t){let e=[];for(let r of t)r instanceof x||(r=this.fromRecipe(r)),r instanceof O?e=e.concat(r.terms):e.push(r);return 1===e.length?e[0]:new O(e)}seq(...t){let e=[];for(let r of t)r instanceof x||(r=this.fromRecipe(r)),r instanceof R?e=e.concat(r.factors):e.push(r);return 1===e.length?e[0]:new R(e)}star(t){return t instanceof x||(t=this.fromRecipe(t)),new F(t)}plus(t){return t instanceof x||(t=this.fromRecipe(t)),new E(t)}opt(t){return t instanceof x||(t=this.fromRecipe(t)),new C(t)}not(t){return t instanceof x||(t=this.fromRecipe(t)),new k(t)}lookahead(t){return t instanceof x||(t=this.fromRecipe(t)),new D(t)}lex(t){return t instanceof x||(t=this.fromRecipe(t)),new T(t)}app(t,e){return e&&e.length>0&&(e=e.map((function(t){return t instanceof x?t:this.fromRecipe(t)}),this)),new j(t,e)}splice(t,e){return new L(this.currentDecl.superGrammar,this.currentRuleName,t.map((t=>this.fromRecipe(t))),e.map((t=>this.fromRecipe(t))))}fromRecipe(t){const e="grammar"===t[0]?t.slice(1):t.slice(2),r=this[t[0]](...e),n=t[1];return n&&n.sourceInterval&&this.currentDecl&&r.withSource(this.currentDecl.sourceInterval(...n.sourceInterval)),r}}function zt(t){return"function"===typeof t?t.call(new qt):("string"===typeof t&&(t=JSON.parse(t)),(new qt).fromRecipe(t))}const Ut=zt(["grammar",{source:'BuiltInRules {\n\n  alnum  (an alpha-numeric character)\n    = letter\n    | digit\n\n  letter  (a letter)\n    = lower\n    | upper\n    | unicodeLtmo\n\n  digit  (a digit)\n    = "0".."9"\n\n  hexDigit  (a hexadecimal digit)\n    = digit\n    | "a".."f"\n    | "A".."F"\n\n  ListOf<elem, sep>\n    = NonemptyListOf<elem, sep>\n    | EmptyListOf<elem, sep>\n\n  NonemptyListOf<elem, sep>\n    = elem (sep elem)*\n\n  EmptyListOf<elem, sep>\n    = /* nothing */\n\n  listOf<elem, sep>\n    = nonemptyListOf<elem, sep>\n    | emptyListOf<elem, sep>\n\n  nonemptyListOf<elem, sep>\n    = elem (sep elem)*\n\n  emptyListOf<elem, sep>\n    = /* nothing */\n\n  // Allows a syntactic rule application within a lexical context.\n  applySyntactic<app> = app\n}'},"BuiltInRules",null,null,{alnum:["define",{sourceInterval:[18,78]},"an alpha-numeric character",[],["alt",{sourceInterval:[60,78]},["app",{sourceInterval:[60,66]},"letter",[]],["app",{sourceInterval:[73,78]},"digit",[]]]],letter:["define",{sourceInterval:[82,142]},"a letter",[],["alt",{sourceInterval:[107,142]},["app",{sourceInterval:[107,112]},"lower",[]],["app",{sourceInterval:[119,124]},"upper",[]],["app",{sourceInterval:[131,142]},"unicodeLtmo",[]]]],digit:["define",{sourceInterval:[146,177]},"a digit",[],["range",{sourceInterval:[169,177]},"0","9"]],hexDigit:["define",{sourceInterval:[181,254]},"a hexadecimal digit",[],["alt",{sourceInterval:[219,254]},["app",{sourceInterval:[219,224]},"digit",[]],["range",{sourceInterval:[231,239]},"a","f"],["range",{sourceInterval:[246,254]},"A","F"]]],ListOf:["define",{sourceInterval:[258,336]},null,["elem","sep"],["alt",{sourceInterval:[282,336]},["app",{sourceInterval:[282,307]},"NonemptyListOf",[["param",{sourceInterval:[297,301]},0],["param",{sourceInterval:[303,306]},1]]],["app",{sourceInterval:[314,336]},"EmptyListOf",[["param",{sourceInterval:[326,330]},0],["param",{sourceInterval:[332,335]},1]]]]],NonemptyListOf:["define",{sourceInterval:[340,388]},null,["elem","sep"],["seq",{sourceInterval:[372,388]},["param",{sourceInterval:[372,376]},0],["star",{sourceInterval:[377,388]},["seq",{sourceInterval:[378,386]},["param",{sourceInterval:[378,381]},1],["param",{sourceInterval:[382,386]},0]]]]],EmptyListOf:["define",{sourceInterval:[392,434]},null,["elem","sep"],["seq",{sourceInterval:[438,438]}]],listOf:["define",{sourceInterval:[438,516]},null,["elem","sep"],["alt",{sourceInterval:[462,516]},["app",{sourceInterval:[462,487]},"nonemptyListOf",[["param",{sourceInterval:[477,481]},0],["param",{sourceInterval:[483,486]},1]]],["app",{sourceInterval:[494,516]},"emptyListOf",[["param",{sourceInterval:[506,510]},0],["param",{sourceInterval:[512,515]},1]]]]],nonemptyListOf:["define",{sourceInterval:[520,568]},null,["elem","sep"],["seq",{sourceInterval:[552,568]},["param",{sourceInterval:[552,556]},0],["star",{sourceInterval:[557,568]},["seq",{sourceInterval:[558,566]},["param",{sourceInterval:[558,561]},1],["param",{sourceInterval:[562,566]},0]]]]],emptyListOf:["define",{sourceInterval:[572,682]},null,["elem","sep"],["seq",{sourceInterval:[685,685]}]],applySyntactic:["define",{sourceInterval:[685,710]},null,["app"],["param",{sourceInterval:[707,710]},0]]}]);Gt.BuiltInRules=Ut,function(t){Z.forEach((e=>{e(t)})),Z=null}(Gt.BuiltInRules);const Kt=zt(["grammar",{source:'Ohm {\n\n  Grammars\n    = Grammar*\n\n  Grammar\n    = ident SuperGrammar? "{" Rule* "}"\n\n  SuperGrammar\n    = "<:" ident\n\n  Rule\n    = ident Formals? ruleDescr? "="  RuleBody  -- define\n    | ident Formals?            ":=" OverrideRuleBody  -- override\n    | ident Formals?            "+=" RuleBody  -- extend\n\n  RuleBody\n    = "|"? NonemptyListOf<TopLevelTerm, "|">\n\n  TopLevelTerm\n    = Seq caseName  -- inline\n    | Seq\n\n  OverrideRuleBody\n    = "|"? NonemptyListOf<OverrideTopLevelTerm, "|">\n\n  OverrideTopLevelTerm\n    = "..."  -- superSplice\n    | TopLevelTerm\n\n  Formals\n    = "<" ListOf<ident, ","> ">"\n\n  Params\n    = "<" ListOf<Seq, ","> ">"\n\n  Alt\n    = NonemptyListOf<Seq, "|">\n\n  Seq\n    = Iter*\n\n  Iter\n    = Pred "*"  -- star\n    | Pred "+"  -- plus\n    | Pred "?"  -- opt\n    | Pred\n\n  Pred\n    = "~" Lex  -- not\n    | "&" Lex  -- lookahead\n    | Lex\n\n  Lex\n    = "#" Base  -- lex\n    | Base\n\n  Base\n    = ident Params? ~(ruleDescr? "=" | ":=" | "+=")  -- application\n    | oneCharTerminal ".." oneCharTerminal           -- range\n    | terminal                                       -- terminal\n    | "(" Alt ")"                                    -- paren\n\n  ruleDescr  (a rule description)\n    = "(" ruleDescrText ")"\n\n  ruleDescrText\n    = (~")" any)*\n\n  caseName\n    = "--" (~"\\n" space)* name (~"\\n" space)* ("\\n" | &"}")\n\n  name  (a name)\n    = nameFirst nameRest*\n\n  nameFirst\n    = "_"\n    | letter\n\n  nameRest\n    = "_"\n    | alnum\n\n  ident  (an identifier)\n    = name\n\n  terminal\n    = "\\"" terminalChar* "\\""\n\n  oneCharTerminal\n    = "\\"" terminalChar "\\""\n\n  terminalChar\n    = escapeChar\n      | ~"\\\\" ~"\\"" ~"\\n" "\\u{0}".."\\u{10FFFF}"\n\n  escapeChar  (an escape sequence)\n    = "\\\\\\\\"                                     -- backslash\n    | "\\\\\\""                                     -- doubleQuote\n    | "\\\\\\\'"                                     -- singleQuote\n    | "\\\\b"                                      -- backspace\n    | "\\\\n"                                      -- lineFeed\n    | "\\\\r"                                      -- carriageReturn\n    | "\\\\t"                                      -- tab\n    | "\\\\u{" hexDigit hexDigit? hexDigit?\n             hexDigit? hexDigit? hexDigit? "}"   -- unicodeCodePoint\n    | "\\\\u" hexDigit hexDigit hexDigit hexDigit  -- unicodeEscape\n    | "\\\\x" hexDigit hexDigit                    -- hexEscape\n\n  space\n   += comment\n\n  comment\n    = "//" (~"\\n" any)* &("\\n" | end)  -- singleLine\n    | "/*" (~"*/" any)* "*/"  -- multiLine\n\n  tokens = token*\n\n  token = caseName | comment | ident | operator | punctuation | terminal | any\n\n  operator = "<:" | "=" | ":=" | "+=" | "*" | "+" | "?" | "~" | "&"\n\n  punctuation = "<" | ">" | "," | "--"\n}'},"Ohm",null,"Grammars",{Grammars:["define",{sourceInterval:[9,32]},null,[],["star",{sourceInterval:[24,32]},["app",{sourceInterval:[24,31]},"Grammar",[]]]],Grammar:["define",{sourceInterval:[36,83]},null,[],["seq",{sourceInterval:[50,83]},["app",{sourceInterval:[50,55]},"ident",[]],["opt",{sourceInterval:[56,69]},["app",{sourceInterval:[56,68]},"SuperGrammar",[]]],["terminal",{sourceInterval:[70,73]},"{"],["star",{sourceInterval:[74,79]},["app",{sourceInterval:[74,78]},"Rule",[]]],["terminal",{sourceInterval:[80,83]},"}"]]],SuperGrammar:["define",{sourceInterval:[87,116]},null,[],["seq",{sourceInterval:[106,116]},["terminal",{sourceInterval:[106,110]},"<:"],["app",{sourceInterval:[111,116]},"ident",[]]]],Rule_define:["define",{sourceInterval:[131,181]},null,[],["seq",{sourceInterval:[131,170]},["app",{sourceInterval:[131,136]},"ident",[]],["opt",{sourceInterval:[137,145]},["app",{sourceInterval:[137,144]},"Formals",[]]],["opt",{sourceInterval:[146,156]},["app",{sourceInterval:[146,155]},"ruleDescr",[]]],["terminal",{sourceInterval:[157,160]},"="],["app",{sourceInterval:[162,170]},"RuleBody",[]]]],Rule_override:["define",{sourceInterval:[188,248]},null,[],["seq",{sourceInterval:[188,235]},["app",{sourceInterval:[188,193]},"ident",[]],["opt",{sourceInterval:[194,202]},["app",{sourceInterval:[194,201]},"Formals",[]]],["terminal",{sourceInterval:[214,218]},":="],["app",{sourceInterval:[219,235]},"OverrideRuleBody",[]]]],Rule_extend:["define",{sourceInterval:[255,305]},null,[],["seq",{sourceInterval:[255,294]},["app",{sourceInterval:[255,260]},"ident",[]],["opt",{sourceInterval:[261,269]},["app",{sourceInterval:[261,268]},"Formals",[]]],["terminal",{sourceInterval:[281,285]},"+="],["app",{sourceInterval:[286,294]},"RuleBody",[]]]],Rule:["define",{sourceInterval:[120,305]},null,[],["alt",{sourceInterval:[131,305]},["app",{sourceInterval:[131,170]},"Rule_define",[]],["app",{sourceInterval:[188,235]},"Rule_override",[]],["app",{sourceInterval:[255,294]},"Rule_extend",[]]]],RuleBody:["define",{sourceInterval:[309,362]},null,[],["seq",{sourceInterval:[324,362]},["opt",{sourceInterval:[324,328]},["terminal",{sourceInterval:[324,327]},"|"]],["app",{sourceInterval:[329,362]},"NonemptyListOf",[["app",{sourceInterval:[344,356]},"TopLevelTerm",[]],["terminal",{sourceInterval:[358,361]},"|"]]]]],TopLevelTerm_inline:["define",{sourceInterval:[385,408]},null,[],["seq",{sourceInterval:[385,397]},["app",{sourceInterval:[385,388]},"Seq",[]],["app",{sourceInterval:[389,397]},"caseName",[]]]],TopLevelTerm:["define",{sourceInterval:[366,418]},null,[],["alt",{sourceInterval:[385,418]},["app",{sourceInterval:[385,397]},"TopLevelTerm_inline",[]],["app",{sourceInterval:[415,418]},"Seq",[]]]],OverrideRuleBody:["define",{sourceInterval:[422,491]},null,[],["seq",{sourceInterval:[445,491]},["opt",{sourceInterval:[445,449]},["terminal",{sourceInterval:[445,448]},"|"]],["app",{sourceInterval:[450,491]},"NonemptyListOf",[["app",{sourceInterval:[465,485]},"OverrideTopLevelTerm",[]],["terminal",{sourceInterval:[487,490]},"|"]]]]],OverrideTopLevelTerm_superSplice:["define",{sourceInterval:[522,543]},null,[],["terminal",{sourceInterval:[522,527]},"..."]],OverrideTopLevelTerm:["define",{sourceInterval:[495,562]},null,[],["alt",{sourceInterval:[522,562]},["app",{sourceInterval:[522,527]},"OverrideTopLevelTerm_superSplice",[]],["app",{sourceInterval:[550,562]},"TopLevelTerm",[]]]],Formals:["define",{sourceInterval:[566,606]},null,[],["seq",{sourceInterval:[580,606]},["terminal",{sourceInterval:[580,583]},"<"],["app",{sourceInterval:[584,602]},"ListOf",[["app",{sourceInterval:[591,596]},"ident",[]],["terminal",{sourceInterval:[598,601]},","]]],["terminal",{sourceInterval:[603,606]},">"]]],Params:["define",{sourceInterval:[610,647]},null,[],["seq",{sourceInterval:[623,647]},["terminal",{sourceInterval:[623,626]},"<"],["app",{sourceInterval:[627,643]},"ListOf",[["app",{sourceInterval:[634,637]},"Seq",[]],["terminal",{sourceInterval:[639,642]},","]]],["terminal",{sourceInterval:[644,647]},">"]]],Alt:["define",{sourceInterval:[651,685]},null,[],["app",{sourceInterval:[661,685]},"NonemptyListOf",[["app",{sourceInterval:[676,679]},"Seq",[]],["terminal",{sourceInterval:[681,684]},"|"]]]],Seq:["define",{sourceInterval:[689,704]},null,[],["star",{sourceInterval:[699,704]},["app",{sourceInterval:[699,703]},"Iter",[]]]],Iter_star:["define",{sourceInterval:[719,736]},null,[],["seq",{sourceInterval:[719,727]},["app",{sourceInterval:[719,723]},"Pred",[]],["terminal",{sourceInterval:[724,727]},"*"]]],Iter_plus:["define",{sourceInterval:[743,760]},null,[],["seq",{sourceInterval:[743,751]},["app",{sourceInterval:[743,747]},"Pred",[]],["terminal",{sourceInterval:[748,751]},"+"]]],Iter_opt:["define",{sourceInterval:[767,783]},null,[],["seq",{sourceInterval:[767,775]},["app",{sourceInterval:[767,771]},"Pred",[]],["terminal",{sourceInterval:[772,775]},"?"]]],Iter:["define",{sourceInterval:[708,794]},null,[],["alt",{sourceInterval:[719,794]},["app",{sourceInterval:[719,727]},"Iter_star",[]],["app",{sourceInterval:[743,751]},"Iter_plus",[]],["app",{sourceInterval:[767,775]},"Iter_opt",[]],["app",{sourceInterval:[790,794]},"Pred",[]]]],Pred_not:["define",{sourceInterval:[809,824]},null,[],["seq",{sourceInterval:[809,816]},["terminal",{sourceInterval:[809,812]},"~"],["app",{sourceInterval:[813,816]},"Lex",[]]]],Pred_lookahead:["define",{sourceInterval:[831,852]},null,[],["seq",{sourceInterval:[831,838]},["terminal",{sourceInterval:[831,834]},"&"],["app",{sourceInterval:[835,838]},"Lex",[]]]],Pred:["define",{sourceInterval:[798,862]},null,[],["alt",{sourceInterval:[809,862]},["app",{sourceInterval:[809,816]},"Pred_not",[]],["app",{sourceInterval:[831,838]},"Pred_lookahead",[]],["app",{sourceInterval:[859,862]},"Lex",[]]]],Lex_lex:["define",{sourceInterval:[876,892]},null,[],["seq",{sourceInterval:[876,884]},["terminal",{sourceInterval:[876,879]},"#"],["app",{sourceInterval:[880,884]},"Base",[]]]],Lex:["define",{sourceInterval:[866,903]},null,[],["alt",{sourceInterval:[876,903]},["app",{sourceInterval:[876,884]},"Lex_lex",[]],["app",{sourceInterval:[899,903]},"Base",[]]]],Base_application:["define",{sourceInterval:[918,979]},null,[],["seq",{sourceInterval:[918,963]},["app",{sourceInterval:[918,923]},"ident",[]],["opt",{sourceInterval:[924,931]},["app",{sourceInterval:[924,930]},"Params",[]]],["not",{sourceInterval:[932,963]},["alt",{sourceInterval:[934,962]},["seq",{sourceInterval:[934,948]},["opt",{sourceInterval:[934,944]},["app",{sourceInterval:[934,943]},"ruleDescr",[]]],["terminal",{sourceInterval:[945,948]},"="]],["terminal",{sourceInterval:[951,955]},":="],["terminal",{sourceInterval:[958,962]},"+="]]]]],Base_range:["define",{sourceInterval:[986,1041]},null,[],["seq",{sourceInterval:[986,1022]},["app",{sourceInterval:[986,1001]},"oneCharTerminal",[]],["terminal",{sourceInterval:[1002,1006]},".."],["app",{sourceInterval:[1007,1022]},"oneCharTerminal",[]]]],Base_terminal:["define",{sourceInterval:[1048,1106]},null,[],["app",{sourceInterval:[1048,1056]},"terminal",[]]],Base_paren:["define",{sourceInterval:[1113,1168]},null,[],["seq",{sourceInterval:[1113,1124]},["terminal",{sourceInterval:[1113,1116]},"("],["app",{sourceInterval:[1117,1120]},"Alt",[]],["terminal",{sourceInterval:[1121,1124]},")"]]],Base:["define",{sourceInterval:[907,1168]},null,[],["alt",{sourceInterval:[918,1168]},["app",{sourceInterval:[918,963]},"Base_application",[]],["app",{sourceInterval:[986,1022]},"Base_range",[]],["app",{sourceInterval:[1048,1056]},"Base_terminal",[]],["app",{sourceInterval:[1113,1124]},"Base_paren",[]]]],ruleDescr:["define",{sourceInterval:[1172,1231]},"a rule description",[],["seq",{sourceInterval:[1210,1231]},["terminal",{sourceInterval:[1210,1213]},"("],["app",{sourceInterval:[1214,1227]},"ruleDescrText",[]],["terminal",{sourceInterval:[1228,1231]},")"]]],ruleDescrText:["define",{sourceInterval:[1235,1266]},null,[],["star",{sourceInterval:[1255,1266]},["seq",{sourceInterval:[1256,1264]},["not",{sourceInterval:[1256,1260]},["terminal",{sourceInterval:[1257,1260]},")"]],["app",{sourceInterval:[1261,1264]},"any",[]]]]],caseName:["define",{sourceInterval:[1270,1338]},null,[],["seq",{sourceInterval:[1285,1338]},["terminal",{sourceInterval:[1285,1289]},"--"],["star",{sourceInterval:[1290,1304]},["seq",{sourceInterval:[1291,1302]},["not",{sourceInterval:[1291,1296]},["terminal",{sourceInterval:[1292,1296]},"\n"]],["app",{sourceInterval:[1297,1302]},"space",[]]]],["app",{sourceInterval:[1305,1309]},"name",[]],["star",{sourceInterval:[1310,1324]},["seq",{sourceInterval:[1311,1322]},["not",{sourceInterval:[1311,1316]},["terminal",{sourceInterval:[1312,1316]},"\n"]],["app",{sourceInterval:[1317,1322]},"space",[]]]],["alt",{sourceInterval:[1326,1337]},["terminal",{sourceInterval:[1326,1330]},"\n"],["lookahead",{sourceInterval:[1333,1337]},["terminal",{sourceInterval:[1334,1337]},"}"]]]]],name:["define",{sourceInterval:[1342,1382]},"a name",[],["seq",{sourceInterval:[1363,1382]},["app",{sourceInterval:[1363,1372]},"nameFirst",[]],["star",{sourceInterval:[1373,1382]},["app",{sourceInterval:[1373,1381]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[1386,1418]},null,[],["alt",{sourceInterval:[1402,1418]},["terminal",{sourceInterval:[1402,1405]},"_"],["app",{sourceInterval:[1412,1418]},"letter",[]]]],nameRest:["define",{sourceInterval:[1422,1452]},null,[],["alt",{sourceInterval:[1437,1452]},["terminal",{sourceInterval:[1437,1440]},"_"],["app",{sourceInterval:[1447,1452]},"alnum",[]]]],ident:["define",{sourceInterval:[1456,1489]},"an identifier",[],["app",{sourceInterval:[1485,1489]},"name",[]]],terminal:["define",{sourceInterval:[1493,1531]},null,[],["seq",{sourceInterval:[1508,1531]},["terminal",{sourceInterval:[1508,1512]},'"'],["star",{sourceInterval:[1513,1526]},["app",{sourceInterval:[1513,1525]},"terminalChar",[]]],["terminal",{sourceInterval:[1527,1531]},'"']]],oneCharTerminal:["define",{sourceInterval:[1535,1579]},null,[],["seq",{sourceInterval:[1557,1579]},["terminal",{sourceInterval:[1557,1561]},'"'],["app",{sourceInterval:[1562,1574]},"terminalChar",[]],["terminal",{sourceInterval:[1575,1579]},'"']]],terminalChar:["define",{sourceInterval:[1583,1660]},null,[],["alt",{sourceInterval:[1602,1660]},["app",{sourceInterval:[1602,1612]},"escapeChar",[]],["seq",{sourceInterval:[1621,1660]},["not",{sourceInterval:[1621,1626]},["terminal",{sourceInterval:[1622,1626]},"\\"]],["not",{sourceInterval:[1627,1632]},["terminal",{sourceInterval:[1628,1632]},'"']],["not",{sourceInterval:[1633,1638]},["terminal",{sourceInterval:[1634,1638]},"\n"]],["range",{sourceInterval:[1639,1660]},"\0","\udbff\udfff"]]]],escapeChar_backslash:["define",{sourceInterval:[1703,1758]},null,[],["terminal",{sourceInterval:[1703,1709]},"\\\\"]],escapeChar_doubleQuote:["define",{sourceInterval:[1765,1822]},null,[],["terminal",{sourceInterval:[1765,1771]},'\\"']],escapeChar_singleQuote:["define",{sourceInterval:[1829,1886]},null,[],["terminal",{sourceInterval:[1829,1835]},"\\'"]],escapeChar_backspace:["define",{sourceInterval:[1893,1948]},null,[],["terminal",{sourceInterval:[1893,1898]},"\\b"]],escapeChar_lineFeed:["define",{sourceInterval:[1955,2009]},null,[],["terminal",{sourceInterval:[1955,1960]},"\\n"]],escapeChar_carriageReturn:["define",{sourceInterval:[2016,2076]},null,[],["terminal",{sourceInterval:[2016,2021]},"\\r"]],escapeChar_tab:["define",{sourceInterval:[2083,2132]},null,[],["terminal",{sourceInterval:[2083,2088]},"\\t"]],escapeChar_unicodeCodePoint:["define",{sourceInterval:[2139,2243]},null,[],["seq",{sourceInterval:[2139,2221]},["terminal",{sourceInterval:[2139,2145]},"\\u{"],["app",{sourceInterval:[2146,2154]},"hexDigit",[]],["opt",{sourceInterval:[2155,2164]},["app",{sourceInterval:[2155,2163]},"hexDigit",[]]],["opt",{sourceInterval:[2165,2174]},["app",{sourceInterval:[2165,2173]},"hexDigit",[]]],["opt",{sourceInterval:[2188,2197]},["app",{sourceInterval:[2188,2196]},"hexDigit",[]]],["opt",{sourceInterval:[2198,2207]},["app",{sourceInterval:[2198,2206]},"hexDigit",[]]],["opt",{sourceInterval:[2208,2217]},["app",{sourceInterval:[2208,2216]},"hexDigit",[]]],["terminal",{sourceInterval:[2218,2221]},"}"]]],escapeChar_unicodeEscape:["define",{sourceInterval:[2250,2309]},null,[],["seq",{sourceInterval:[2250,2291]},["terminal",{sourceInterval:[2250,2255]},"\\u"],["app",{sourceInterval:[2256,2264]},"hexDigit",[]],["app",{sourceInterval:[2265,2273]},"hexDigit",[]],["app",{sourceInterval:[2274,2282]},"hexDigit",[]],["app",{sourceInterval:[2283,2291]},"hexDigit",[]]]],escapeChar_hexEscape:["define",{sourceInterval:[2316,2371]},null,[],["seq",{sourceInterval:[2316,2339]},["terminal",{sourceInterval:[2316,2321]},"\\x"],["app",{sourceInterval:[2322,2330]},"hexDigit",[]],["app",{sourceInterval:[2331,2339]},"hexDigit",[]]]],escapeChar:["define",{sourceInterval:[1664,2371]},"an escape sequence",[],["alt",{sourceInterval:[1703,2371]},["app",{sourceInterval:[1703,1709]},"escapeChar_backslash",[]],["app",{sourceInterval:[1765,1771]},"escapeChar_doubleQuote",[]],["app",{sourceInterval:[1829,1835]},"escapeChar_singleQuote",[]],["app",{sourceInterval:[1893,1898]},"escapeChar_backspace",[]],["app",{sourceInterval:[1955,1960]},"escapeChar_lineFeed",[]],["app",{sourceInterval:[2016,2021]},"escapeChar_carriageReturn",[]],["app",{sourceInterval:[2083,2088]},"escapeChar_tab",[]],["app",{sourceInterval:[2139,2221]},"escapeChar_unicodeCodePoint",[]],["app",{sourceInterval:[2250,2291]},"escapeChar_unicodeEscape",[]],["app",{sourceInterval:[2316,2339]},"escapeChar_hexEscape",[]]]],space:["extend",{sourceInterval:[2375,2394]},null,[],["app",{sourceInterval:[2387,2394]},"comment",[]]],comment_singleLine:["define",{sourceInterval:[2412,2458]},null,[],["seq",{sourceInterval:[2412,2443]},["terminal",{sourceInterval:[2412,2416]},"//"],["star",{sourceInterval:[2417,2429]},["seq",{sourceInterval:[2418,2427]},["not",{sourceInterval:[2418,2423]},["terminal",{sourceInterval:[2419,2423]},"\n"]],["app",{sourceInterval:[2424,2427]},"any",[]]]],["lookahead",{sourceInterval:[2430,2443]},["alt",{sourceInterval:[2432,2442]},["terminal",{sourceInterval:[2432,2436]},"\n"],["app",{sourceInterval:[2439,2442]},"end",[]]]]]],comment_multiLine:["define",{sourceInterval:[2465,2501]},null,[],["seq",{sourceInterval:[2465,2487]},["terminal",{sourceInterval:[2465,2469]},"/*"],["star",{sourceInterval:[2470,2482]},["seq",{sourceInterval:[2471,2480]},["not",{sourceInterval:[2471,2476]},["terminal",{sourceInterval:[2472,2476]},"*/"]],["app",{sourceInterval:[2477,2480]},"any",[]]]],["terminal",{sourceInterval:[2483,2487]},"*/"]]],comment:["define",{sourceInterval:[2398,2501]},null,[],["alt",{sourceInterval:[2412,2501]},["app",{sourceInterval:[2412,2443]},"comment_singleLine",[]],["app",{sourceInterval:[2465,2487]},"comment_multiLine",[]]]],tokens:["define",{sourceInterval:[2505,2520]},null,[],["star",{sourceInterval:[2514,2520]},["app",{sourceInterval:[2514,2519]},"token",[]]]],token:["define",{sourceInterval:[2524,2600]},null,[],["alt",{sourceInterval:[2532,2600]},["app",{sourceInterval:[2532,2540]},"caseName",[]],["app",{sourceInterval:[2543,2550]},"comment",[]],["app",{sourceInterval:[2553,2558]},"ident",[]],["app",{sourceInterval:[2561,2569]},"operator",[]],["app",{sourceInterval:[2572,2583]},"punctuation",[]],["app",{sourceInterval:[2586,2594]},"terminal",[]],["app",{sourceInterval:[2597,2600]},"any",[]]]],operator:["define",{sourceInterval:[2604,2669]},null,[],["alt",{sourceInterval:[2615,2669]},["terminal",{sourceInterval:[2615,2619]},"<:"],["terminal",{sourceInterval:[2622,2625]},"="],["terminal",{sourceInterval:[2628,2632]},":="],["terminal",{sourceInterval:[2635,2639]},"+="],["terminal",{sourceInterval:[2642,2645]},"*"],["terminal",{sourceInterval:[2648,2651]},"+"],["terminal",{sourceInterval:[2654,2657]},"?"],["terminal",{sourceInterval:[2660,2663]},"~"],["terminal",{sourceInterval:[2666,2669]},"&"]]],punctuation:["define",{sourceInterval:[2673,2709]},null,[],["alt",{sourceInterval:[2687,2709]},["terminal",{sourceInterval:[2687,2690]},"<"],["terminal",{sourceInterval:[2693,2696]},">"],["terminal",{sourceInterval:[2699,2702]},","],["terminal",{sourceInterval:[2705,2709]},"--"]]]}]),$t=Object.create(x.prototype);function Ht(t,e){for(const r in t)if(r===e)return!0;return!1}function Vt(t,e,r){const n=new qt;let i,s,a,c=!1;const u=(r||Kt).createSemantics().addOperation("visit",{Grammars:t=>t.children.map((t=>t.visit())),Grammar(t,r,s,o,a){const c=t.visit();i=n.newGrammar(c),r.child(0)&&r.child(0).visit(),o.children.map((t=>t.visit()));const u=i.build();if(u.source=this.source.trimmed(),Ht(e,c))throw function(t,e){return G("Grammar "+t.name+" is already declared in this namespace")}(u);return e[c]=u,u},SuperGrammar(t,r){const n=r.visit();if("null"===n)i.withSuperGrammar(null);else{if(!e||!Ht(e,n))throw function(t,e,r){return G(e?`Grammar ${t} is not declared in namespace '${e}'`:"Undeclared grammar "+t,r)}(n,e,r.source);i.withSuperGrammar(e[n])}},Rule_define(t,e,r,n,o){s=t.visit(),a=e.children.map((t=>t.visit()))[0]||[],i.defaultStartRule||i.ensureSuperGrammar()===Gt.ProtoBuiltInRules||i.withDefaultStartRule(s);const c=o.visit(),u=r.children.map((t=>t.visit()))[0],l=this.source.trimmed();return i.define(s,a,c,u,l)},Rule_override(t,e,r,n){s=t.visit(),a=e.children.map((t=>t.visit()))[0]||[];const o=this.source.trimmed();i.ensureSuperGrammarRuleForOverriding(s,o),c=!0;const u=n.visit();return c=!1,i.override(s,a,u,null,o)},Rule_extend(t,e,r,n){s=t.visit(),a=e.children.map((t=>t.visit()))[0]||[];const o=n.visit(),c=this.source.trimmed();return i.extend(s,a,o,null,c)},RuleBody(t,e){return n.alt(...e.visit()).withSource(this.source)},OverrideRuleBody(t,e){const r=e.visit(),o=r.indexOf($t);if(o>=0){const t=r.slice(0,o),e=r.slice(o+1);return e.forEach((t=>{if(t===$t)throw G("'...' can appear at most once in a rule body",t.source)})),new L(i.superGrammar,s,t,e).withSource(this.source)}return n.alt(...r).withSource(this.source)},Formals:(t,e,r)=>e.visit(),Params:(t,e,r)=>e.visit(),Alt(t){return n.alt(...t.visit()).withSource(this.source)},TopLevelTerm_inline(t,e){const r=s+"_"+e.visit(),o=t.visit(),u=this.source.trimmed(),l=!(i.superGrammar&&i.superGrammar.rules[r]);c&&!l?i.override(r,a,o,null,u):i.define(r,a,o,null,u);const p=a.map((t=>n.app(t)));return n.app(r,p).withSource(o.source)},OverrideTopLevelTerm_superSplice:t=>$t,Seq(t){return n.seq(...t.children.map((t=>t.visit()))).withSource(this.source)},Iter_star(t,e){return n.star(t.visit()).withSource(this.source)},Iter_plus(t,e){return n.plus(t.visit()).withSource(this.source)},Iter_opt(t,e){return n.opt(t.visit()).withSource(this.source)},Pred_not(t,e){return n.not(e.visit()).withSource(this.source)},Pred_lookahead(t,e){return n.lookahead(e.visit()).withSource(this.source)},Lex_lex(t,e){return n.lex(e.visit()).withSource(this.source)},Base_application(t,e){const r=e.children.map((t=>t.visit()))[0]||[];return n.app(t.visit(),r).withSource(this.source)},Base_range(t,e,r){return n.range(t.visit(),r.visit()).withSource(this.source)},Base_terminal(t){return n.terminal(t.visit()).withSource(this.source)},Base_paren:(t,e,r)=>e.visit(),ruleDescr:(t,e,r)=>e.visit(),ruleDescrText(t){return this.sourceString.trim()},caseName:(t,e,r,n,i)=>r.visit(),name(t,e){return this.sourceString},nameFirst(t){},nameRest(t){},terminal:(t,e,r)=>e.children.map((t=>t.visit())).join(""),oneCharTerminal:(t,e,r)=>e.visit(),escapeChar(t){try{return v(this.sourceString)}catch(e){if(e instanceof RangeError&&e.message.startsWith("Invalid code point "))throw function(t){const e=t._node;o(e&&e.isNonterminal()&&"escapeChar_unicodeCodePoint"===e.ctorName);const r=t.children.slice(1,-1).map((t=>t.source)),n=r[0].coverageWith(...r.slice(1));return G(`U+${n.contents} is not a valid Unicode code point`,n)}(t);throw e}},NonemptyListOf:(t,e,r)=>[t.visit()].concat(r.children.map((t=>t.visit()))),EmptyListOf:()=>[],_terminal(){return this.sourceString}});return u(t).visit()}const Wt=zt(["grammar",{source:'OperationsAndAttributes {\n\n  AttributeSignature =\n    name\n\n  OperationSignature =\n    name Formals?\n\n  Formals\n    = "(" ListOf<name, ","> ")"\n\n  name  (a name)\n    = nameFirst nameRest*\n\n  nameFirst\n    = "_"\n    | letter\n\n  nameRest\n    = "_"\n    | alnum\n\n}'},"OperationsAndAttributes",null,"AttributeSignature",{AttributeSignature:["define",{sourceInterval:[29,58]},null,[],["app",{sourceInterval:[54,58]},"name",[]]],OperationSignature:["define",{sourceInterval:[62,100]},null,[],["seq",{sourceInterval:[87,100]},["app",{sourceInterval:[87,91]},"name",[]],["opt",{sourceInterval:[92,100]},["app",{sourceInterval:[92,99]},"Formals",[]]]]],Formals:["define",{sourceInterval:[104,143]},null,[],["seq",{sourceInterval:[118,143]},["terminal",{sourceInterval:[118,121]},"("],["app",{sourceInterval:[122,139]},"ListOf",[["app",{sourceInterval:[129,133]},"name",[]],["terminal",{sourceInterval:[135,138]},","]]],["terminal",{sourceInterval:[140,143]},")"]]],name:["define",{sourceInterval:[147,187]},"a name",[],["seq",{sourceInterval:[168,187]},["app",{sourceInterval:[168,177]},"nameFirst",[]],["star",{sourceInterval:[178,187]},["app",{sourceInterval:[178,186]},"nameRest",[]]]]],nameFirst:["define",{sourceInterval:[191,223]},null,[],["alt",{sourceInterval:[207,223]},["terminal",{sourceInterval:[207,210]},"_"],["app",{sourceInterval:[217,223]},"letter",[]]]],nameRest:["define",{sourceInterval:[227,257]},null,[],["alt",{sourceInterval:[242,257]},["terminal",{sourceInterval:[242,245]},"_"],["app",{sourceInterval:[252,257]},"alnum",[]]]]}]);!function(t){const e={empty(){return this.iteration()},nonEmpty(t,e,r){return this.iteration([t].concat(r.children))}};Ft.BuiltInSemantics=Ft.createSemantics(t,null).addOperation("asIteration",{emptyListOf:e.empty,nonemptyListOf:e.nonEmpty,EmptyListOf:e.empty,NonemptyListOf:e.nonEmpty})}(Gt.BuiltInRules),function(t){Ft.prototypeGrammarSemantics=t.createSemantics().addOperation("parse",{AttributeSignature:t=>({name:t.parse(),formals:[]}),OperationSignature:(t,e)=>({name:t.parse(),formals:e.children.map((t=>t.parse()))[0]||[]}),Formals:(t,e,r)=>e.asIteration().children.map((t=>t.parse())),name(t,e){return this.sourceString}}),Ft.prototypeGrammar=t}(Wt);const Jt="an indented block",Qt="a dedent",Zt=1114112;class Xt extends nt{constructor(t){super(t.input),this.state=t}_indentationAt(t){return this.state.userData[t]||0}atEnd(){return super.atEnd()&&0===this._indentationAt(this.pos)}next(){if(0===this._indentationAt(this.pos))return super.next();this.examinedLength=Math.max(this.examinedLength,this.pos)}nextCharCode(){return 0!==this._indentationAt(this.pos)?(this.examinedLength=Math.max(this.examinedLength,this.pos),Zt):super.nextCharCode()}nextCodePoint(){return 0!==this._indentationAt(this.pos)?(this.examinedLength=Math.max(this.examinedLength,this.pos),Zt):super.nextCodePoint()}}class Yt extends x{constructor(t=!0){super(),this.isIndent=t}allowsSkippingPrecedingSpace(){return!0}eval(t){const{inputStream:e}=t,r=t.userData;t.doNotMemoize=!0;const n=e.pos,i=this.isIndent?1:-1;return(r[n]||0)*i>0?(t.userData=Object.create(r),t.userData[n]-=i,t.pushBinding(new vt(0),n),!0):(t.processFailure(n,this),!1)}getArity(){return 1}_assertAllApplicationsAreValid(t,e){}_isNullable(t,e){return!1}assertChoicesHaveUniformArity(t){}assertIteratedExprsAreNotNullable(t){}introduceParams(t){return this}substituteParams(t){return this}toString(){return this.isIndent?"indent":"dedent"}toDisplayString(){return this.toString()}toFailure(t){const e=this.isIndent?Jt:Qt;return new bt(this,e,"description")}}const te=new j("indent"),ee=new j("dedent"),re=new L(Ut,"any",[te,ee],[]),ne=(new qt).newGrammar("IndentationSensitive").withSuperGrammar(Ut).define("indent",[],new Yt(!0),Jt,void 0,!0).define("dedent",[],new Yt(!1),Qt,void 0,!0).extend("any",[],re,"any character",void 0).build();Object.assign(ne,{_matchStateInitializer(t){t.userData=function(t){let e=0;const r=[0],n=()=>r[r.length-1],i={},s=/( *).*(?:$|\r?\n|\r)/g;let o;for(;null!=(o=s.exec(t));){const[t,s]=o;if(0===t.length)break;const a=s.length,c=n(),u=e+a;if(a>c)r.push(a),i[u]=1;else if(a<c){const t=r.length;for(;n()!==a;)r.pop();i[u]=-1*(t-r.length)}e+=t.length}return r.length>1&&(i[e]=1-r.length),i}(t.input),t.inputStream=new Xt(t)},supportsIncrementalParsing:!1}),Gt.initApplicationParser(Kt,Vt);const ie=t=>!!t.constructor&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t);function se(t,e){const r=Kt.match(t,"Grammars");if(r.failed())throw function(t){const e=new Error;return Object.defineProperty(e,"message",{enumerable:!0,get:()=>t.message}),Object.defineProperty(e,"shortMessage",{enumerable:!0,get:()=>"Expected "+t.getExpectedText()}),e.interval=t.getInterval(),e}(r);return Vt(r,e)}function oe(t,e){const r=function(t,e){const r=Object.create(e||{});if("string"!==typeof t){if(!ie(t))throw new TypeError("Expected string as first argument, got "+y(t));t=t.toString()}return se(t,r),r}(t,e),n=Object.keys(r);if(0===n.length)throw new Error("Missing grammar definition");if(n.length>1){const t=r[n[1]].source;throw new Error(tt(t.sourceString,t.startIdx)+"Found more than one grammar definition -- use ohm.grammars() instead.")}return r[n[0]]}}}]);