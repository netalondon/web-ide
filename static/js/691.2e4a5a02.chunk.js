"use strict";(self.webpackChunk_nand2tetris_web=self.webpackChunk_nand2tetris_web||[]).push([[691],{691:function(t,e,n){n.d(e,{J_:function(){return build}});var i=n(726),r=n(1092),u=n(7791),a=n(4625),s=n(8090),o=n(3118),l=n(6329);function pinWidth(t,e){if(void 0!==e){if(e>=t)return e-t+1;if(t>0&&0===e)return 1;throw new Error("Bus specification has start > end (".concat(t," > ").concat(e,")"))}}function loadChip(t,e){return _loadChip.apply(this,arguments)}function _loadChip(){return(_loadChip=(0,u.Z)((0,r.Z)().mark((function _callee2(t,e){var n,i,u;return(0,r.Z)().wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:if(!(0,o._c)(t)&&void 0!==e){r.next=2;break}return r.abrupt("return",(0,o.cT)(t));case 2:return r.prev=2,r.next=5,e.readFile("".concat(t,".hdl"));case 5:return n=r.sent,i=s.Gq.parse(n),u=(0,a.IY)(i)?build((0,a.Ok)(i),e):(0,a.UG)(new Error("HDL Was not parsed")),r.abrupt("return",u);case 11:return r.prev=11,r.t0=r.catch(2),r.abrupt("return",(0,a.UG)(new Error("Could not load chip ".concat(t,".hdl"))));case 14:case"end":return r.stop()}}),_callee2,null,[[2,11]])})))).apply(this,arguments)}function build(t,e){return _build.apply(this,arguments)}function _build(){return(_build=(0,u.Z)((0,r.Z)().mark((function _callee3(t,e){var n,u,s,c,h,d,v;return(0,r.Z)().wrap((function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:if("BUILTIN"!==t.parts){r.next=2;break}return r.abrupt("return",(0,o.cT)(t.name.toString()));case 2:n=new l.Af(t.ins.map((function(t){var e=t.pin,n=t.width;return{pin:e.toString(),width:n}})),t.outs.map((function(t){var e=t.pin,n=t.width;return{pin:e.toString(),width:n}})),t.name.toString(),[],t.clocked),u=(0,i.Z)(t.parts),r.prev=4,u.s();case 6:if((s=u.n()).done){r.next=24;break}return c=s.value,r.next=10,loadChip(c.name.toString(),e);case 10:if(h=r.sent,!(0,a.dZ)(h)){r.next=13;break}return r.abrupt("return",h);case 13:d=(0,a.Ok)(h),v=c.wires.map((function(t){var e,n,i,r,u=t.lhs,a=t.rhs;return{to:{name:u.pin.toString(),start:null!==(e=u.start)&&void 0!==e?e:0,width:pinWidth(null!==(n=u.start)&&void 0!==n?n:0,u.end)},from:{name:a.pin.toString(),start:null!==(i=a.start)&&void 0!==i?i:0,width:pinWidth(null!==(r=a.start)&&void 0!==r?r:0,a.end)}}})),r.prev=15,n.wire(d,v),r.next=22;break;case 19:return r.prev=19,r.t0=r.catch(15),r.abrupt("return",(0,a.UG)(r.t0));case 22:r.next=6;break;case 24:r.next=29;break;case 26:r.prev=26,r.t1=r.catch(4),u.e(r.t1);case 29:return r.prev=29,u.f(),r.finish(29);case 32:return r.abrupt("return",(0,a.Ok)(n));case 33:case"end":return r.stop()}}),_callee3,null,[[4,26,29,32],[15,19]])})))).apply(this,arguments)}},3300:function(t,e,n){n.d(e,{N1:function(){return V},Z9:function(){return _},ar:function(){return W},lL:function(){return x},m1:function(){return k},zp:function(){return R}});var i=n(7538),r=n(3943),u=n(1026),a=n(9422),s=n(7169),o=n(3243),l=n(7597),c=n(4649),h=n(1092),d=n(7791),v=n(2951),f=n(1976),Z=n(7591),y=n(4337),b=n(6329),g=n(3116),p=n(134),m=n(326),A=n(7930),M=n(5838),k=function(t){(0,Z.Z)(ROM32K,t);var e=(0,y.Z)(ROM32K);function ROM32K(){return(0,v.Z)(this,ROM32K),e.call(this,16,"ROM")}return(0,f.Z)(ROM32K,[{key:"load",value:function(){var t=(0,d.Z)((0,h.Z)().mark((function _callee(t,e){var n=this;return(0,h.Z)().wrap((function _callee$(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,(0,A.zD)(t,e);case 3:i.sent.map((function(t,e){return n.at(e).busVoltage=t})),i.next=9;break;case 6:throw i.prev=6,i.t0=i.catch(0),new Error("ROM32K Failed to load file ".concat(e));case 9:case"end":return i.stop()}}),_callee,null,[[0,6]])})));return function load(e,n){return t.apply(this,arguments)}}()}]),ROM32K}(g.FH),x=function(t){(0,Z.Z)(Screen,t);var e=(0,y.Z)(Screen);function Screen(){return(0,v.Z)(this,Screen),e.call(this,13,"Screen")}return(0,f.Z)(Screen)}(g.FH);(0,c.Z)(x,"SIZE",M.yJ),(0,c.Z)(x,"OFFSET",M.GD);var V=function(t){(0,Z.Z)(Keyboard,t);var e=(0,y.Z)(Keyboard);function Keyboard(){return(0,v.Z)(this,Keyboard),e.call(this,[],["out[16]"],"Keyboard")}return(0,f.Z)(Keyboard,[{key:"getKey",value:function getKey(){return this.out().busVoltage}},{key:"setKey",value:function setKey(t){this.out().busVoltage=65535&t}},{key:"clearKey",value:function clearKey(){this.out().busVoltage=0}}]),Keyboard}(b.Af);(0,c.Z)(V,"OFFSET",M.eu);var R=function(t){(0,Z.Z)(Memory,t);var e=(0,y.Z)(Memory);function Memory(){var t;return(0,v.Z)(this,Memory),t=e.call(this,["in[16]","load","address[15])"],["out[16]"],"Memory"),(0,c.Z)((0,s.Z)(t),"ram",new g.xs),(0,c.Z)((0,s.Z)(t),"screen",new x),(0,c.Z)((0,s.Z)(t),"keyboard",new V),(0,c.Z)((0,s.Z)(t),"address",0),t.parts.add(t.keyboard),t.parts.add(t.screen),t.parts.add(t.ram),t}return(0,f.Z)(Memory,[{key:"tick",value:function tick(){var t=this.in("load").voltage();if(this.address=this.in("address").busVoltage,t){var e=this.in().busVoltage;this.address>=V.OFFSET||(this.address>=x.OFFSET?this.screen.at(this.address-x.OFFSET).busVoltage=e:this.ram.at(this.address).busVoltage=e)}}},{key:"tock",value:function tock(){this.eval()}},{key:"eval",value:function _eval(){if(this.ram){this.address=this.in("address").busVoltage;var t,e,n=0;if(this.address>=V.OFFSET)n=null!==(t=null===(e=this.keyboard)||void 0===e?void 0:e.out().busVoltage)&&void 0!==t?t:0;else if(this.address>=x.OFFSET){var i,r;n=null!==(i=null===(r=this.screen)||void 0===r?void 0:r.at(this.address-x.OFFSET).busVoltage)&&void 0!==i?i:0}else{var u,a;n=null!==(u=null===(a=this.ram)||void 0===a?void 0:a.at(this.address).busVoltage)&&void 0!==u?u:0}this.out().busVoltage=n}}},{key:"in",value:function _in(t){if(null!==t&&void 0!==t&&t.startsWith("RAM16K")){var e,n,i,r=(0,m.o5)(null!==(e=null===(n=t.match((0,a.Z)(/\[(\d+)\]/,{idx:1})))||void 0===n||null===(i=n.groups)||void 0===i?void 0:i.idx)&&void 0!==e?e:"0");return this.ram.at(r)}if(null!==t&&void 0!==t&&t.startsWith("Screen")){var u,s,c,h=(0,m.o5)(null!==(u=null===(s=t.match((0,a.Z)(/\[(\d+)\]/,{idx:1})))||void 0===s||null===(c=s.groups)||void 0===c?void 0:c.idx)&&void 0!==u?u:"0");return this.screen.at(h)}return(0,o.Z)((0,l.Z)(Memory.prototype),"in",this).call(this,t)}},{key:"get",value:function get(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.startsWith("RAM16K")?this.at(16383&e):t.startsWith("Screen")?this.at(e&8191+x.OFFSET):t.startsWith("Keyboard")?this.at(V.OFFSET):t.startsWith("Memory")?this.at(e):(0,o.Z)((0,l.Z)(Memory.prototype),"get",this).call(this,t,e)}},{key:"at",value:function at(t){return t>=V.OFFSET?this.keyboard.out():t>=x.OFFSET?this.screen.at(t-x.OFFSET):this.ram.at(t)}},{key:"reset",value:function reset(){this.address=0,this.ram.reset(),this.screen.reset(),(0,o.Z)((0,l.Z)(Memory.prototype),"reset",this).call(this)}}]),Memory}(b.tI),_=function(t){(0,Z.Z)(CPU,t);var e=(0,y.Z)(CPU);function CPU(){var t;return(0,v.Z)(this,CPU),t=e.call(this,["inM[16]","instruction[16]","reset"],["outM[16]","writeM","addressM[15]","pc[15]"]),(0,c.Z)((0,s.Z)(t),"_state",(0,p.Zu)()),t}return(0,f.Z)(CPU,[{key:"state",get:function get(){return this._state}},{key:"tick",value:function tick(){var t,e=(0,p.aL)(this.cpuInput(),this._state),n=(0,u.Z)(e,2),i=n[0],r=n[1];this._state=i,this.out("writeM").pull(r?b.lj:b.yE),this.out("outM").busVoltage=null!==(t=this._state.ALU)&&void 0!==t?t:0}},{key:"tock",value:function tock(){var t,e,n,i;if(this._state){var r=(0,p.Ff)(this.cpuInput(),this._state),a=(0,u.Z)(r,2),s=a[0],o=a[1];this._state=o,this.out("addressM").busVoltage=null!==(t=s.addressM)&&void 0!==t?t:0,this.out("outM").busVoltage=null!==(e=s.outM)&&void 0!==e?e:0,this.out("writeM").pull(s.writeM?b.lj:b.yE),this.out("pc").busVoltage=null!==(n=null===(i=this._state)||void 0===i?void 0:i.PC)&&void 0!==n?n:0}}},{key:"cpuInput",value:function cpuInput(){return{inM:this.in("inM").busVoltage,instruction:this.in("instruction").busVoltage,reset:1===this.in("reset").busVoltage}}},{key:"get",value:function get(t,e){return null!==t&&void 0!==t&&t.startsWith("ARegister")?new b.qP("ARegister",this._state.A):null!==t&&void 0!==t&&t.startsWith("DRegister")?new b.qP("DRegister",this._state.D):null!==t&&void 0!==t&&t.startsWith("PC")?new b.qP("PC",this._state.PC):(0,o.Z)((0,l.Z)(CPU.prototype),"get",this).call(this,t,e)}},{key:"reset",value:function reset(){this._state=(0,p.Zu)(),this._state.PC=-1,(0,o.Z)((0,l.Z)(CPU.prototype),"reset",this).call(this)}}]),CPU}(b.tI),C=new WeakMap,P=new WeakMap,w=new WeakMap,W=function(t){(0,Z.Z)(Computer,t);var e=(0,y.Z)(Computer);function Computer(){var t;return(0,v.Z)(this,Computer),t=e.call(this,["reset"],[]),(0,i.Z)((0,s.Z)(t),C,{writable:!0,value:new R}),(0,i.Z)((0,s.Z)(t),P,{writable:!0,value:new k}),(0,i.Z)((0,s.Z)(t),w,{writable:!0,value:new _}),t.wire((0,r.Z)((0,s.Z)(t),w),[{from:{name:"reset",start:0},to:{name:"reset",start:0}},{from:{name:"instruction",start:0},to:{name:"instruction",start:0}},{from:{name:"outM",start:0},to:{name:"inM",start:0}},{from:{name:"writeM",start:0},to:{name:"writeM",start:0}},{from:{name:"addressM",start:0},to:{name:"addressM",start:0}}]),t.wire((0,r.Z)((0,s.Z)(t),P),[{from:{name:"pc",start:0},to:{name:"address",start:0}},{from:{name:"instruction",start:0},to:{name:"out",start:0}}]),t.wire((0,r.Z)((0,s.Z)(t),C),[{from:{name:"inM",start:0},to:{name:"in",start:0}},{from:{name:"writeM",start:0},to:{name:"load",start:0}},{from:{name:"addressM",start:0},to:{name:"address",start:0}},{from:{name:"outM",start:0},to:{name:"out",start:0}}]),t}return(0,f.Z)(Computer,[{key:"eval",value:function _eval(){(0,o.Z)((0,l.Z)(Computer.prototype),"eval",this).call(this)}},{key:"get",value:function get(t,e){return t.startsWith("PC")||t.startsWith("ARegister")||t.startsWith("DRegister")?(0,r.Z)(this,w).get(t):t.startsWith("RAM16K")?(0,r.Z)(this,C).get(t,e):(0,o.Z)((0,l.Z)(Computer.prototype),"get",this).call(this,t,e)}},{key:"load",value:function load(t,e){return(0,r.Z)(this,P).load(t,e)}}]),Computer}(b.Af)},3118:function(t,e,n){n.d(e,{JU:function(){return S},zZ:function(){return B},cT:function(){return getBuiltinChip},_c:function(){return hasBuiltinChip}});var i=n(1026),r=n(4625),u=n(2951),a=n(1976),s=n(7591),o=n(4337),l=n(6329);var c=function(t){(0,s.Z)(And,t);var e=(0,o.Z)(And);function And(){return(0,u.Z)(this,And),e.call(this,["a","b"],["out"])}return(0,a.Z)(And,[{key:"eval",value:function _eval(){var t=function and(t,e){return[1===t&&1===e?l.lj:l.yE]}(this.in("a").voltage(),this.in("b").voltage()),e=(0,i.Z)(t,1)[0];this.out().pull(e)}}]),And}(l.Af),h=function(t){(0,s.Z)(And16,t);var e=(0,o.Z)(And16);function And16(){return(0,u.Z)(this,And16),e.call(this,["a[16]","b[16]"],["out[16]"])}return(0,a.Z)(And16,[{key:"eval",value:function _eval(){var t=function and16(t,e){return[t&e&65535]}(this.in("a").busVoltage,this.in("b").busVoltage),e=(0,i.Z)(t,1)[0];this.out().busVoltage=e}}]),And16}(l.Af);var d=function(t){(0,s.Z)(DMux,t);var e=(0,o.Z)(DMux);function DMux(){return(0,u.Z)(this,DMux),e.call(this,["in","sel"],["a","b"])}return(0,a.Z)(DMux,[{key:"eval",value:function _eval(){var t=function dmux(t,e){return[e===l.yE&&t===l.lj?l.lj:l.yE,e===l.lj&&t===l.lj?l.lj:l.yE]}(this.in("in").voltage(),this.in("sel").voltage()),e=(0,i.Z)(t,2),n=e[0],r=e[1];this.out("a").pull(n),this.out("b").pull(r)}}]),DMux}(l.Af),v=function(t){(0,s.Z)(DMux4Way,t);var e=(0,o.Z)(DMux4Way);function DMux4Way(){return(0,u.Z)(this,DMux4Way),e.call(this,["in","sel[2]"],["a","b","c","d"])}return(0,a.Z)(DMux4Way,[{key:"eval",value:function _eval(){var t=function dmux4way(t,e){return[0===e&&t===l.lj?l.lj:l.yE,1===e&&t===l.lj?l.lj:l.yE,2===e&&t===l.lj?l.lj:l.yE,3===e&&t===l.lj?l.lj:l.yE]}(this.in("in").voltage(),this.in("sel").busVoltage),e=(0,i.Z)(t,4),n=e[0],r=e[1],u=e[2],a=e[3];this.out("a").pull(n),this.out("b").pull(r),this.out("c").pull(u),this.out("d").pull(a)}}]),DMux4Way}(l.Af),f=function(t){(0,s.Z)(DMux8Way,t);var e=(0,o.Z)(DMux8Way);function DMux8Way(){return(0,u.Z)(this,DMux8Way),e.call(this,["in","sel[3]"],["a","b","c","d","e","f","g","h"])}return(0,a.Z)(DMux8Way,[{key:"eval",value:function _eval(){var t=function dmux8way(t,e){return[0===e&&t===l.lj?l.lj:l.yE,1===e&&t===l.lj?l.lj:l.yE,2===e&&t===l.lj?l.lj:l.yE,3===e&&t===l.lj?l.lj:l.yE,4===e&&t===l.lj?l.lj:l.yE,5===e&&t===l.lj?l.lj:l.yE,6===e&&t===l.lj?l.lj:l.yE,7===e&&t===l.lj?l.lj:l.yE]}(this.in("in").voltage(),this.in("sel").busVoltage),e=(0,i.Z)(t,8),n=e[0],r=e[1],u=e[2],a=e[3],s=e[4],o=e[5],c=e[6],h=e[7];this.out("a").pull(n),this.out("b").pull(r),this.out("c").pull(u),this.out("d").pull(a),this.out("e").pull(s),this.out("f").pull(o),this.out("g").pull(c),this.out("h").pull(h)}}]),DMux8Way}(l.Af);function mux16(t,e,n){return[n===l.yE?t:e]}function mux16_4(t,e,n,i,r){var u=1&r;return 0===(2&r)?mux16(t,e,u):mux16(n,i,u)}var Z=function(t){(0,s.Z)(Mux,t);var e=(0,o.Z)(Mux);function Mux(){return(0,u.Z)(this,Mux),e.call(this,["a","b","sel"],["out"])}return(0,a.Z)(Mux,[{key:"eval",value:function _eval(){var t=function mux(t,e,n){return[n===l.yE?t:e]}(this.in("a").voltage(),this.in("b").voltage(),this.in("sel").voltage()),e=(0,i.Z)(t,1)[0];this.out().pull(e)}}]),Mux}(l.Af),y=function(t){(0,s.Z)(Mux16,t);var e=(0,o.Z)(Mux16);function Mux16(){return(0,u.Z)(this,Mux16),e.call(this,["a[16]","b[16]","sel"],["out[16]"])}return(0,a.Z)(Mux16,[{key:"eval",value:function _eval(){var t=mux16(this.in("a").busVoltage,this.in("b").busVoltage,this.in("sel").voltage()),e=(0,i.Z)(t,1)[0];this.out().busVoltage=e}}]),Mux16}(l.Af),b=function(t){(0,s.Z)(Mux4Way16,t);var e=(0,o.Z)(Mux4Way16);function Mux4Way16(){return(0,u.Z)(this,Mux4Way16),e.call(this,["a[16]","b[16]","c[16]","d[16]","sel[2]"],["out[16]"])}return(0,a.Z)(Mux4Way16,[{key:"eval",value:function _eval(){var t=mux16_4(this.in("a").busVoltage,this.in("b").busVoltage,this.in("c").busVoltage,this.in("d").busVoltage,this.in("sel").busVoltage),e=(0,i.Z)(t,1)[0];this.out().busVoltage=e}}]),Mux4Way16}(l.Af),g=function(t){(0,s.Z)(Mux8Way16,t);var e=(0,o.Z)(Mux8Way16);function Mux8Way16(){return(0,u.Z)(this,Mux8Way16),e.call(this,["a[16]","b[16]","c[16]","d[16]","e[16]","f[16]","g[16]","h[16]","sel[3]"],["out[16]"])}return(0,a.Z)(Mux8Way16,[{key:"eval",value:function _eval(){var t=function mux16_8(t,e,n,i,r,u,a,s,o){var l=3&o;return 0===(4&o)?mux16_4(t,e,n,i,l):mux16_4(r,u,a,s,l)}(this.in("a").busVoltage,this.in("b").busVoltage,this.in("c").busVoltage,this.in("d").busVoltage,this.in("e").busVoltage,this.in("f").busVoltage,this.in("g").busVoltage,this.in("h").busVoltage,this.in("sel").busVoltage),e=(0,i.Z)(t,1)[0];this.out().busVoltage=e}}]),Mux8Way16}(l.Af),p=n(326);var m=function(t){(0,s.Z)(Nand,t);var e=(0,o.Z)(Nand);function Nand(){return(0,u.Z)(this,Nand),e.call(this,["a","b"],["out"])}return(0,a.Z)(Nand,[{key:"eval",value:function _eval(){var t=function nand(t,e){return[1===t&&1===e?l.yE:l.lj]}(this.in("a").voltage(),this.in("b").voltage()),e=(0,i.Z)(t,1)[0];this.out().pull(e)}}]),Nand}(l.Af),A=function(t){(0,s.Z)(Nand16,t);var e=(0,o.Z)(Nand16);function Nand16(){return(0,u.Z)(this,Nand16),e.call(this,["a[16]","b[16]"],["out[16]"])}return(0,a.Z)(Nand16,[{key:"eval",value:function _eval(){var t=this.in("a").busVoltage,e=this.in("b").busVoltage;this.out().busVoltage=(0,p.C2)(t,e)}}]),Nand16}(l.Af);var M=function(t){(0,s.Z)(Not,t);var e=(0,o.Z)(Not);function Not(){return(0,u.Z)(this,Not),e.call(this,["in"],["out"])}return(0,a.Z)(Not,[{key:"eval",value:function _eval(){var t=function not(t){return[t===l.yE?l.lj:l.yE]}(this.in("in").voltage()),e=(0,i.Z)(t,1)[0];this.out().pull(e)}}]),Not}(l.Af),k=function(t){(0,s.Z)(Not16,t);var e=(0,o.Z)(Not16);function Not16(){return(0,u.Z)(this,Not16),e.call(this,["in[16]"],["out[16]"])}return(0,a.Z)(Not16,[{key:"eval",value:function _eval(){var t=function not16(t){return[65535&~t]}(this.in().busVoltage),e=(0,i.Z)(t,1)[0];this.out().busVoltage=e}}]),Not16}(l.Af);function or(t,e){return[1===t||1===e?l.lj:l.yE]}var x=function(t){(0,s.Z)(Or,t);var e=(0,o.Z)(Or);function Or(){return(0,u.Z)(this,Or),e.call(this,["a","b"],["out"])}return(0,a.Z)(Or,[{key:"eval",value:function _eval(){var t=or(this.in("a").voltage(),this.in("b").voltage()),e=(0,i.Z)(t,1)[0];this.out().pull(e)}}]),Or}(l.Af),V=function(t){(0,s.Z)(Or16,t);var e=(0,o.Z)(Or16);function Or16(){return(0,u.Z)(this,Or16),e.call(this,["a[16]","b[16]"],["out[16]"])}return(0,a.Z)(Or16,[{key:"eval",value:function _eval(){var t=function or16(t,e){return[65535&(t|e)]}(this.in("a").busVoltage,this.in("b").busVoltage),e=(0,i.Z)(t,1)[0];this.out().busVoltage=e}}]),Or16}(l.Af),R=function(t){(0,s.Z)(Or8way,t);var e=(0,o.Z)(Or8way);function Or8way(){return(0,u.Z)(this,Or8way),e.call(this,["in[8]"],["out"],"Or8way")}return(0,a.Z)(Or8way,[{key:"eval",value:function _eval(){var t=function or8way(t){return[0===(255&t)?l.yE:l.lj]}(this.in().busVoltage),e=(0,i.Z)(t,1)[0];this.out().pull(e)}}]),Or8way}(l.Af);var _=function(t){(0,s.Z)(Xor,t);var e=(0,o.Z)(Xor);function Xor(){return(0,u.Z)(this,Xor),e.call(this,["a","b"],["out"])}return(0,a.Z)(Xor,[{key:"eval",value:function _eval(){var t=function xor(t,e){return[t===l.lj&&e===l.yE||t===l.yE&&e===l.lj?l.lj:l.yE]}(this.in("a").voltage(),this.in("b").voltage()),e=(0,i.Z)(t,1)[0];this.out().pull(e)}}]),Xor}(l.Af),C=function(t){(0,s.Z)(Xor16,t);var e=(0,o.Z)(Xor16);function Xor16(){return(0,u.Z)(this,Xor16),e.call(this,["a[16]","b[16]"],["out[16]"])}return(0,a.Z)(Xor16,[{key:"eval",value:function _eval(){var t=function xor16(t,e){return[65535&(t^e)]}(this.in("a").busVoltage,this.in("b").busVoltage),e=(0,i.Z)(t,1)[0];this.out().busVoltage=e}}]),Xor16}(l.Af);function add16(t,e){return[t+e&65535]}var P=function(t){(0,s.Z)(Add16,t);var e=(0,o.Z)(Add16);function Add16(){return(0,u.Z)(this,Add16),e.call(this,["a[16]","b[16]"],["out[16]"],"Add16")}return(0,a.Z)(Add16,[{key:"eval",value:function _eval(){var t=add16(this.in("a").busVoltage,this.in("b").busVoltage),e=(0,i.Z)(t,1)[0];this.out().busVoltage=e}}]),Add16}(l.Af),w=n(6693),W=function(t){(0,s.Z)(ALUNoStat,t);var e=(0,o.Z)(ALUNoStat);function ALUNoStat(){return(0,u.Z)(this,ALUNoStat),e.call(this,["x[16]","y[16]","zx","nx","zy","ny","f","no"],["out[16]"],"ALU")}return(0,a.Z)(ALUNoStat,[{key:"eval",value:function _eval(){var t=this.in("x").busVoltage,e=this.in("y").busVoltage,n=(this.in("zx").busVoltage<<5)+(this.in("nx").busVoltage<<4)+(this.in("zy").busVoltage<<3)+(this.in("ny").busVoltage<<2)+(this.in("f").busVoltage<<1)+(this.in("no").busVoltage<<0),r=(0,w.Bb)(n,t,e),u=(0,i.Z)(r,1)[0];this.out().busVoltage=u}}]),ALUNoStat}(l.Af),S=function(t){(0,s.Z)(ALU,t);var e=(0,o.Z)(ALU);function ALU(){return(0,u.Z)(this,ALU),e.call(this,["x[16]","y[16]","zx","nx","zy","ny","f","no"],["out[16]","zr","ng"],"ALU")}return(0,a.Z)(ALU,[{key:"eval",value:function _eval(){var t=this.in("x").busVoltage,e=this.in("y").busVoltage,n=(this.in("zx").busVoltage<<5)+(this.in("nx").busVoltage<<4)+(this.in("zy").busVoltage<<3)+(this.in("ny").busVoltage<<2)+(this.in("f").busVoltage<<1)+(this.in("no").busVoltage<<0),r=(0,w.Bb)(n,t,e),u=(0,i.Z)(r,2),a=u[0],s=u[1],o=s===w.vU.Negative?l.lj:l.yE,c=s===w.vU.Zero?l.lj:l.yE;this.out("out").busVoltage=a,this.out("ng").pull(o),this.out("zr").pull(c)}},{key:"op",value:function op(){var op=(this.in("zx").busVoltage<<5)+(this.in("nx").busVoltage<<4)+(this.in("zy").busVoltage<<3)+(this.in("ny").busVoltage<<2)+(this.in("f").busVoltage<<1)+(this.in("no").busVoltage<<0);return op}}]),ALU}(l.Af);function halfAdder(t,e){return[1===t&&0===e||0===t&&1===e?l.lj:l.yE,1===t&&1===e?l.lj:l.yE]}var O=function(t){(0,s.Z)(HalfAdder,t);var e=(0,o.Z)(HalfAdder);function HalfAdder(){return(0,u.Z)(this,HalfAdder),e.call(this,["a","b"],["sum","carry"])}return(0,a.Z)(HalfAdder,[{key:"eval",value:function _eval(){var t=halfAdder(this.in("a").voltage(),this.in("b").voltage()),e=(0,i.Z)(t,2),n=e[0],r=e[1];this.out("sum").pull(n),this.out("carry").pull(r)}}]),HalfAdder}(l.Af);var E=function(t){(0,s.Z)(FullAdder,t);var e=(0,o.Z)(FullAdder);function FullAdder(){return(0,u.Z)(this,FullAdder),e.call(this,["a","b","c"],["sum","carry"])}return(0,a.Z)(FullAdder,[{key:"eval",value:function _eval(){var t=function fullAdder(t,e,n){var r=halfAdder(t,e),u=(0,i.Z)(r,2),a=u[0],s=u[1],o=halfAdder(a,n),l=(0,i.Z)(o,2),c=l[0],h=or(s,l[1]);return[c,(0,i.Z)(h,1)[0]]}(this.in("a").voltage(),this.in("b").voltage(),this.in("c").voltage()),e=(0,i.Z)(t,2),n=e[0],r=e[1];this.out("sum").pull(n),this.out("carry").pull(r)}}]),FullAdder}(l.Af);var F=function(t){(0,s.Z)(Inc16,t);var e=(0,o.Z)(Inc16);function Inc16(){return(0,u.Z)(this,Inc16),e.call(this,["in[16]"],["out[16]"],"Inc16")}return(0,a.Z)(Inc16,[{key:"eval",value:function _eval(){var t=function inc16(t){return add16(t,1)}(this.in().busVoltage),e=(0,i.Z)(t,1)[0];this.out().busVoltage=e}}]),Inc16}(l.Af),L=n(3300),N=n(7039),j=function(t){(0,s.Z)(DFF,t);var e=(0,o.Z)(DFF);function DFF(t){return(0,u.Z)(this,DFF),e.call(this,["in"],["out"],t,["t"])}return(0,a.Z)(DFF,[{key:"tick",value:function tick(){var t=this.in().voltage();this.pin("t").pull(t)}},{key:"tock",value:function tock(){var t=this.pin("t").voltage();this.out().pull(t)}}]),DFF}(l.tI),D=n(3116),B=new Map([["Nand",m],["Nand16",A],["Not",M],["Not16",k],["And",c],["And16",h],["Or",x],["Or16",V],["Or8Way",R],["XOr",_],["XOr16",C],["Xor",_],["Xor16",C],["Mux",Z],["Mux16",y],["Mux4Way16",b],["Mux8Way16",g],["DMux",d],["DMux4Way",v],["DMux8Way",f],["HalfAdder",O],["FullAdder",E],["Add16",P],["Inc16",F],["ALU",S],["ALUNoStat",W],["DFF",j],["Bit",N.sU],["Register",N.aX],["ARegister",N.aX],["DRegister",N.aX],["PC",N.PC],["RAM8",D.HX],["RAM64",D.IH],["RAM512",D.OB],["RAM4K",D.rS],["RAM16K",D.xs],["ROM32K",L.m1],["Screen",L.lL],["Keyboard",L.N1],["CPU",L.Z9],["Computer",L.ar],["Memory",L.zp],["ARegister",N.l0],["DRegister",N.l0]].map((function(t){var e=(0,i.Z)(t,2),n=e[0],r=e[1];return[n,function(){var t=new r;return t.name=n,t}]})));function hasBuiltinChip(t){return B.has(t)}function getBuiltinChip(t){var e=B.get(t);return e?(0,r.Ok)(e()):(0,r.UG)(new Error("Chip ".concat(t," not in builtin registry")))}},7039:function(t,e,n){n.d(e,{PC:function(){return Z},aX:function(){return v},l0:function(){return f},sU:function(){return d}});var i=n(2951),r=n(1976),u=n(7169),a=n(3243),s=n(7597),o=n(7591),l=n(4337),c=n(4649),h=n(6329),d=function(t){(0,o.Z)(Bit,t);var e=(0,l.Z)(Bit);function Bit(t){var n;return(0,i.Z)(this,Bit),n=e.call(this,["in","load"],["out"],t),(0,c.Z)((0,u.Z)(n),"bit",h.yE),n}return(0,r.Z)(Bit,[{key:"tick",value:function tick(){this.in("load").voltage()===h.lj&&(this.bit=this.in().voltage())}},{key:"tock",value:function tock(){var t;this.out().pull(null!==(t=this.bit)&&void 0!==t?t:0)}},{key:"reset",value:function reset(){this.bit=h.yE,(0,a.Z)((0,s.Z)(Bit.prototype),"reset",this).call(this)}}]),Bit}(h.tI),v=function(t){(0,o.Z)(Register,t);var e=(0,l.Z)(Register);function Register(t){var n;return(0,i.Z)(this,Register),n=e.call(this,["in[16]","load"],["out[16]"],t),(0,c.Z)((0,u.Z)(n),"bits",0),n}return(0,r.Z)(Register,[{key:"tick",value:function tick(){this.in("load").voltage()===h.lj&&(this.bits=65535&this.in().busVoltage)}},{key:"tock",value:function tock(){this.out().busVoltage=65535&this.bits}},{key:"get",value:function get(t,e){return t===this.name?this.out():(0,a.Z)((0,s.Z)(Register.prototype),"get",this).call(this,t,e)}},{key:"reset",value:function reset(){this.bits=0,(0,a.Z)((0,s.Z)(Register.prototype),"reset",this).call(this)}}]),Register}(h.tI),f=function(t){(0,o.Z)(VRegister,t);var e=(0,l.Z)(VRegister);function VRegister(){return(0,i.Z)(this,VRegister),e.apply(this,arguments)}return(0,r.Z)(VRegister)}(v),Z=function(t){(0,o.Z)(PC,t);var e=(0,l.Z)(PC);function PC(t){var n;return(0,i.Z)(this,PC),n=e.call(this,["in[16]","load","inc","reset"],["out[16]"],t),(0,c.Z)((0,u.Z)(n),"bits",0),n}return(0,r.Z)(PC,[{key:"tick",value:function tick(){this.in("reset").voltage()===h.lj?this.bits=0:this.in("load").voltage()===h.lj?this.bits=65535&this.in().busVoltage:this.in("inc").voltage()===h.lj&&(this.bits+=1)}},{key:"tock",value:function tock(){this.out().busVoltage=65535&this.bits}},{key:"get",value:function get(t,e){return t===this.name?this.out():(0,a.Z)((0,s.Z)(PC.prototype),"get",this).call(this,t,e)}},{key:"reset",value:function reset(){this.bits=0,(0,a.Z)((0,s.Z)(PC.prototype),"reset",this).call(this)}}]),PC}(h.tI)},3116:function(t,e,n){n.d(e,{FH:function(){return f},HX:function(){return y},IH:function(){return b},OB:function(){return g},rS:function(){return p},xs:function(){return m}});var i=n(2951),r=n(1976),u=n(7169),a=n(3243),s=n(7597),o=n(7591),l=n(4337),c=n(4649),h=n(6329),d=n(5541),v=n(5838),f=function(t){(0,o.Z)(RAM,t);var e=(0,l.Z)(RAM);function RAM(t,n){var r;return(0,i.Z)(this,RAM),r=e.call(this,["in[16]","load","address[".concat(t,"]")],["out[16]"],n),(0,c.Z)((0,u.Z)(r),"width",void 0),(0,c.Z)((0,u.Z)(r),"_memory",void 0),(0,c.Z)((0,u.Z)(r),"_nextData",0),(0,c.Z)((0,u.Z)(r),"_address",0),r.width=t,r._memory=new v.zp(Math.pow(2,r.width)),r}return(0,r.Z)(RAM,[{key:"memory",get:function get(){return this._memory}},{key:"address",get:function get(){return this._address}},{key:"tick",value:function tick(){var t=this.in("load").voltage();this._address=this.in("address").busVoltage,t&&(this._nextData=this.in().busVoltage,this._memory.set(this._address,this._nextData))}},{key:"tock",value:function tock(){var t,e;this.out().busVoltage=null!==(t=null===(e=this._memory)||void 0===e?void 0:e.get(this._address))&&void 0!==t?t:0}},{key:"eval",value:function _eval(){var t,e,n=this.in("address").busVoltage;this.out().busVoltage=null!==(t=null===(e=this._memory)||void 0===e?void 0:e.get(n))&&void 0!==t?t:0}},{key:"at",value:function at(t){var e=this;return(0,d.hu)(t<this._memory.size,(function(){return"Request out of bounds (".concat(t," >= ").concat(e._memory.size,")")})),new Z("".concat(this.name,"[").concat(t,"]"),t,this._memory)}},{key:"reset",value:function reset(){console.log("ram reset"),this._memory.reset(),(0,a.Z)((0,s.Z)(RAM.prototype),"reset",this).call(this)}}]),RAM}(h.tI),Z=function(t){(0,o.Z)(RamBus,t);var e=(0,l.Z)(RamBus);function RamBus(t,n,r){var a;return(0,i.Z)(this,RamBus),a=e.call(this,t),(0,c.Z)((0,u.Z)(a),"index",void 0),(0,c.Z)((0,u.Z)(a),"ram",void 0),a.index=n,a.ram=r,a}return(0,r.Z)(RamBus,[{key:"busVoltage",get:function get(){return this.ram.get(this.index)},set:function set(t){this.ram.set(this.index,t)}}]),RamBus}(h.Gc),y=function(t){(0,o.Z)(RAM8,t);var e=(0,l.Z)(RAM8);function RAM8(t){return(0,i.Z)(this,RAM8),e.call(this,3,t)}return(0,r.Z)(RAM8)}(f),b=function(t){(0,o.Z)(RAM64,t);var e=(0,l.Z)(RAM64);function RAM64(t){return(0,i.Z)(this,RAM64),e.call(this,6,t)}return(0,r.Z)(RAM64)}(f),g=function(t){(0,o.Z)(RAM512,t);var e=(0,l.Z)(RAM512);function RAM512(t){return(0,i.Z)(this,RAM512),e.call(this,9,t)}return(0,r.Z)(RAM512)}(f),p=function(t){(0,o.Z)(RAM4K,t);var e=(0,l.Z)(RAM4K);function RAM4K(t){return(0,i.Z)(this,RAM4K),e.call(this,12,t)}return(0,r.Z)(RAM4K)}(f),m=function(t){(0,o.Z)(RAM16K,t);var e=(0,l.Z)(RAM16K);function RAM16K(t){return(0,i.Z)(this,RAM16K),e.call(this,14,t)}return(0,r.Z)(RAM16K)}(f)},8090:function(t,e,n){n.d(e,{Gq:function(){return o}});var i=n(5640),r=n(1510),u='\nHdl <: Base{\n  Root := Chip\n  Chip = "CHIP" Name OpenBrace ChipBody CloseBrace\n  ChipBody = InList? OutList? PartList ClockedList?\n  InList = "IN" PinList Semi\n  OutList = "OUT" PinList Semi\n  PartList = BuiltinPart | Parts\n  PinList = List<PinDecl, Comma>\n  PinDecl = Name PinWidth?\n  PinWidth = OpenSquare decNumber CloseSquare\n  BuiltinPart = "BUILTIN" Semi\n  Parts = "PARTS:" Part*\n  Part = Name "(" Wires ")" Semi\n  Wires = List<Wire, Comma>\n  Wire = WireSide Equal (WireSide | True | False) \n  WireSide = Name SubBus? \n  SubBus = OpenSquare decNumber subBusRest? CloseSquare\n  subBusRest = ".." decNumber\n  ClockedList = "CLOCKED" SimplePinList Semi\n  SimplePinList = List<Name, Comma>\n}',a=i.Z.grammar(u,r.y1),s=a.extendSemantics(r.rJ);s.addAttribute("SubBus",{SubBus:function SubBus(t,e,n,i){var r,u,a,s=e.value;return{start:s,end:null!==(r=null===(u=n.child(0))||void 0===u||null===(a=u.child(1))||void 0===a?void 0:a.value)&&void 0!==r?r:s}}}),s.addAttribute("WireSide",{WireSide:function WireSide(t,e){var n,i,r=t.name,u=null!==(n=null===(i=e.child(0))||void 0===i?void 0:i.SubBus)&&void 0!==n?n:{start:void 0,end:void 0};return{pin:r,start:u.start,end:u.end}}}),s.addAttribute("Wire",{Wire:function Wire(t,e,n){var i=n.isTerminal()?{pin:n.sourceString}:n.WireSide;return{lhs:t.WireSide,rhs:i}}}),s.addAttribute("Wires",{Wires:function Wires(t){return t.asIteration().children.map((function(t){return t.Wire}))}}),s.addAttribute("Part",{Part:function Part(t,e,n,i,r){return{name:t.name,wires:n.Wires}}}),s.addAttribute("Parts",{Parts:function Parts(t,e){return e.children.map((function(t){return t.Part}))},BuiltinPart:function BuiltinPart(t,e){return"BUILTIN"}}),s.addAttribute("PartList",{PartList:function PartList(t){return t.Parts}}),s.addAttribute("Clocked",{ClockedList:function ClockedList(t,e,n){var i;return null!==(i=e.asIteration().children.map((function(t){return t.sourceString})))&&void 0!==i?i:[]}}),s.addAttribute("PinDecl",{PinDecl:function PinDecl(t,e){var n,i,r;return{pin:t.name,width:null!==(n=null===(i=e.child(0))||void 0===i||null===(r=i.child(1))||void 0===r?void 0:r.value)&&void 0!==n?n:1}}}),s.addAttribute("PinList",{PinList:function PinList(t){return t.asIteration().children.map((function(t){return t.PinDecl}))}}),s.addAttribute("Chip",{Chip:function Chip(t,e,n,i,r){var u,a,s,o,l,c,h,d;return{name:e.name,ins:null!==(u=null===(a=i.child(0).child(0))||void 0===a||null===(s=a.child(1))||void 0===s?void 0:s.PinList)&&void 0!==u?u:[],outs:null!==(o=null===(l=i.child(1).child(0))||void 0===l||null===(c=l.child(1))||void 0===c?void 0:c.PinList)&&void 0!==o?o:[],parts:null!==(h=i.child(2).PartList)&&void 0!==h?h:[],clocked:null===(d=i.child(3).child(0))||void 0===d?void 0:d.Clocked}}}),s.addAttribute("Root",{Root:function Root(t){var e;return null===(e=t.child(0))||void 0===e?void 0:e.Chip}});var o={parser:a,grammar:u,semantics:s,parse:(0,r.Pz)(a,s,(function(t){return t.Chip}))}}}]);
//# sourceMappingURL=691.2e4a5a02.chunk.js.map